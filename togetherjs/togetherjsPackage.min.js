!function(){var e,t,n,o;!function(n){var o,r,i,s,a={},l={},c={},u={},h=Object.prototype.hasOwnProperty,d=[].slice;function f(e,t){return h.call(e,t)}function p(e,t){var n,o,r,i,s,a,l,u,h,d,f=t&&t.split("/"),p=c.map,g=p&&p["*"]||{};if(e&&"."===e.charAt(0))if(t){for(e=(f=f.slice(0,f.length-1)).concat(e.split("/")),u=0;u<e.length;u+=1)if("."===(d=e[u]))e.splice(u,1),u-=1;else if(".."===d){if(1===u&&(".."===e[2]||".."===e[0]))break;u>0&&(e.splice(u-1,2),u-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((f||g)&&p){for(u=(n=e.split("/")).length;u>0;u-=1){if(o=n.slice(0,u).join("/"),f)for(h=f.length;h>0;h-=1)if((r=p[f.slice(0,h).join("/")])&&(r=r[o])){i=r,s=u;break}if(i)break;!a&&g&&g[o]&&(a=g[o],l=u)}!i&&a&&(i=a,s=l),i&&(n.splice(0,s,i),e=n.join("/"))}return e}function g(e,t){return function(){return r.apply(n,d.call(arguments,0).concat([e,t]))}}function m(e){return function(t){a[e]=t}}function v(e){if(f(l,e)){var t=l[e];delete l[e],u[e]=!0,o.apply(n,t)}if(!f(a,e)&&!f(u,e))throw new Error("No "+e);return a[e]}function y(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function b(e){return function(){return c&&c.config&&c.config[e]||{}}}i=function(e,t){var n,o=y(e),r=o[0];return e=o[1],r&&(n=v(r=p(r,t))),r?e=n&&n.normalize?n.normalize(e,function(e){return function(t){return p(t,e)}}(t)):p(e,t):(r=(o=y(e=p(e,t)))[0],e=o[1],r&&(n=v(r))),{f:r?r+"!"+e:e,n:e,pr:r,p:n}},s={require:function(e){return g(e)},exports:function(e){var t=a[e];return void 0!==t?t:a[e]={}},module:function(e){return{id:e,uri:"",exports:a[e],config:b(e)}}},o=function(e,t,o,r){var c,h,d,p,y,b,w=[];if(r=r||e,"function"==typeof o){for(t=!t.length&&o.length?["require","exports","module"]:t,y=0;y<t.length;y+=1)if("require"===(h=(p=i(t[y],r)).f))w[y]=s.require(e);else if("exports"===h)w[y]=s.exports(e),b=!0;else if("module"===h)c=w[y]=s.module(e);else if(f(a,h)||f(l,h)||f(u,h))w[y]=v(h);else{if(!p.p)throw new Error(e+" missing "+h);p.p.load(p.n,g(r,!0),m(h),{}),w[y]=a[h]}d=o.apply(a[e],w),e&&(c&&c.exports!==n&&c.exports!==a[e]?a[e]=c.exports:d===n&&b||(a[e]=d))}else e&&(a[e]=o)},e=r=function(e,t,a,l,u){return"string"==typeof e?s[e]?s[e](t):v(i(e,t).f):(e.splice||(c=e,t.splice?(e=t,t=a,a=null):e=n),t=t||function(){},"function"==typeof a&&(a=l,l=u),l?o(n,e,t,a):setTimeout(function(){o(n,e,t,a)},4),r)},r.config=function(e){return(c=e).deps&&r(c.deps,c.callback),r},(t=function(e,t,n){t.splice||(n=t,t=[]),f(a,e)||f(l,e)||(l[e]=[e,t,n])}).amd={jQuery:!0}}(),t("libs/almond",function(){}),n="undefined"!=typeof window?window:this,o=function(e,n){var o=[],r=e.document,i=o.slice,s=o.concat,a=o.push,l=o.indexOf,c={},u=c.toString,h=c.hasOwnProperty,d={},f="1.12.4",p=function(e,t){return new p.fn.init(e,t)},g=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,m=/^-ms-/,v=/-([\da-z])/gi,y=function(e,t){return t.toUpperCase()};function b(e){var t=!!e&&"length"in e&&e.length,n=p.type(e);return"function"!==n&&!p.isWindow(e)&&("array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e)}p.fn=p.prototype={jquery:f,constructor:p,selector:"",length:0,toArray:function(){return i.call(this)},get:function(e){return null!=e?0>e?this[e+this.length]:this[e]:i.call(this)},pushStack:function(e){var t=p.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e){return p.each(this,e)},map:function(e){return this.pushStack(p.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(i.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:a,sort:o.sort,splice:o.splice},p.extend=p.fn.extend=function(){var e,t,n,o,r,i,s=arguments[0]||{},a=1,l=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[a]||{},a++),"object"==typeof s||p.isFunction(s)||(s={}),a===l&&(s=this,a--);l>a;a++)if(null!=(r=arguments[a]))for(o in r)e=s[o],s!==(n=r[o])&&(c&&n&&(p.isPlainObject(n)||(t=p.isArray(n)))?(t?(t=!1,i=e&&p.isArray(e)?e:[]):i=e&&p.isPlainObject(e)?e:{},s[o]=p.extend(c,i,n)):void 0!==n&&(s[o]=n));return s},p.extend({expando:"jQuery"+(f+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===p.type(e)},isArray:Array.isArray||function(e){return"array"===p.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){var t=e&&e.toString();return!p.isArray(e)&&t-parseFloat(t)+1>=0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},isPlainObject:function(e){var t;if(!e||"object"!==p.type(e)||e.nodeType||p.isWindow(e))return!1;try{if(e.constructor&&!h.call(e,"constructor")&&!h.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}if(!d.ownFirst)for(t in e)return h.call(e,t);for(t in e);return void 0===t||h.call(e,t)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?c[u.call(e)]||"object":typeof e},globalEval:function(t){t&&p.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(m,"ms-").replace(v,y)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t){var n,o=0;if(b(e))for(n=e.length;n>o&&!1!==t.call(e[o],o,e[o]);o++);else for(o in e)if(!1===t.call(e[o],o,e[o]))break;return e},trim:function(e){return null==e?"":(e+"").replace(g,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(b(Object(e))?p.merge(n,"string"==typeof e?[e]:e):a.call(n,e)),n},inArray:function(e,t,n){var o;if(t){if(l)return l.call(t,e,n);for(o=t.length,n=n?0>n?Math.max(0,o+n):n:0;o>n;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,t){for(var n=+t.length,o=0,r=e.length;n>o;)e[r++]=t[o++];if(n!=n)for(;void 0!==t[o];)e[r++]=t[o++];return e.length=r,e},grep:function(e,t,n){for(var o=[],r=0,i=e.length,s=!n;i>r;r++)!t(e[r],r)!==s&&o.push(e[r]);return o},map:function(e,t,n){var o,r,i=0,a=[];if(b(e))for(o=e.length;o>i;i++)null!=(r=t(e[i],i,n))&&a.push(r);else for(i in e)null!=(r=t(e[i],i,n))&&a.push(r);return s.apply([],a)},guid:1,proxy:function(e,t){var n,o,r;return"string"==typeof t&&(r=e[t],t=e,e=r),p.isFunction(e)?(n=i.call(arguments,2),(o=function(){return e.apply(t||this,n.concat(i.call(arguments)))}).guid=e.guid=e.guid||p.guid++,o):void 0},now:function(){return+new Date},support:d}),"function"==typeof Symbol&&(p.fn[Symbol.iterator]=o[Symbol.iterator]),p.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){c["[object "+t+"]"]=t.toLowerCase()});var w=function(e){var t,n,o,r,i,s,a,l,c,u,h,d,f,p,g,m,v,y,b,w="sizzle"+1*new Date,j=e.document,x=0,k=0,T=ie(),C=ie(),S=ie(),E=function(e,t){return e===t&&(h=!0),0},A=1<<31,I={}.hasOwnProperty,N=[],_=N.pop,D=N.push,L=N.push,M=N.slice,R=function(e,t){for(var n=0,o=e.length;o>n;n++)if(e[n]===t)return n;return-1},O="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",H="[\\x20\\t\\r\\n\\f]",P="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",q="\\["+H+"*("+P+")(?:"+H+"*([*^$|!~]?=)"+H+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+P+"))|)"+H+"*\\]",F=":("+P+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+q+")*)|.*)\\)|)",J=new RegExp(H+"+","g"),U=new RegExp("^"+H+"+|((?:^|[^\\\\])(?:\\\\.)*)"+H+"+$","g"),z=new RegExp("^"+H+"*,"+H+"*"),B=new RegExp("^"+H+"*([>+~]|"+H+")"+H+"*"),W=new RegExp("="+H+"*([^\\]'\"]*?)"+H+"*\\]","g"),V=new RegExp(F),$=new RegExp("^"+P+"$"),X={ID:new RegExp("^#("+P+")"),CLASS:new RegExp("^\\.("+P+")"),TAG:new RegExp("^("+P+"|[*])"),ATTR:new RegExp("^"+q),PSEUDO:new RegExp("^"+F),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+H+"*(even|odd|(([+-]|)(\\d*)n|)"+H+"*(?:([+-]|)"+H+"*(\\d+)|))"+H+"*\\)|)","i"),bool:new RegExp("^(?:"+O+")$","i"),needsContext:new RegExp("^"+H+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+H+"*((?:-\\d)?\\d*)"+H+"*\\)|)(?=[^-]|$)","i")},Y=/^(?:input|select|textarea|button)$/i,K=/^h\d$/i,G=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Q=/[+~]/,ee=/'|\\/g,te=new RegExp("\\\\([\\da-f]{1,6}"+H+"?|("+H+")|.)","ig"),ne=function(e,t,n){var o="0x"+t-65536;return o!=o||n?t:0>o?String.fromCharCode(o+65536):String.fromCharCode(o>>10|55296,1023&o|56320)},oe=function(){d()};try{L.apply(N=M.call(j.childNodes),j.childNodes),N[j.childNodes.length].nodeType}catch(e){L={apply:N.length?function(e,t){D.apply(e,M.call(t))}:function(e,t){for(var n=e.length,o=0;e[n++]=t[o++];);e.length=n-1}}}function re(e,t,o,r){var i,a,c,u,h,p,v,y,x=t&&t.ownerDocument,k=t?t.nodeType:9;if(o=o||[],"string"!=typeof e||!e||1!==k&&9!==k&&11!==k)return o;if(!r&&((t?t.ownerDocument||t:j)!==f&&d(t),t=t||f,g)){if(11!==k&&(p=Z.exec(e)))if(i=p[1]){if(9===k){if(!(c=t.getElementById(i)))return o;if(c.id===i)return o.push(c),o}else if(x&&(c=x.getElementById(i))&&b(t,c)&&c.id===i)return o.push(c),o}else{if(p[2])return L.apply(o,t.getElementsByTagName(e)),o;if((i=p[3])&&n.getElementsByClassName&&t.getElementsByClassName)return L.apply(o,t.getElementsByClassName(i)),o}if(n.qsa&&!S[e+" "]&&(!m||!m.test(e))){if(1!==k)x=t,y=e;else if("object"!==t.nodeName.toLowerCase()){for((u=t.getAttribute("id"))?u=u.replace(ee,"\\$&"):t.setAttribute("id",u=w),a=(v=s(e)).length,h=$.test(u)?"#"+u:"[id='"+u+"']";a--;)v[a]=h+" "+ge(v[a]);y=v.join(","),x=Q.test(e)&&fe(t.parentNode)||t}if(y)try{return L.apply(o,x.querySelectorAll(y)),o}catch(e){}finally{u===w&&t.removeAttribute("id")}}}return l(e.replace(U,"$1"),t,o,r)}function ie(){var e=[];return function t(n,r){return e.push(n+" ")>o.cacheLength&&delete t[e.shift()],t[n+" "]=r}}function se(e){return e[w]=!0,e}function ae(e){var t=f.createElement("div");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function le(e,t){for(var n=e.split("|"),r=n.length;r--;)o.attrHandle[n[r]]=t}function ce(e,t){var n=t&&e,o=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||A)-(~e.sourceIndex||A);if(o)return o;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function ue(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function he(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function de(e){return se(function(t){return t=+t,se(function(n,o){for(var r,i=e([],n.length,t),s=i.length;s--;)n[r=i[s]]&&(n[r]=!(o[r]=n[r]))})})}function fe(e){return e&&void 0!==e.getElementsByTagName&&e}for(t in n=re.support={},i=re.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},d=re.setDocument=function(e){var t,r,s=e?e.ownerDocument||e:j;return s!==f&&9===s.nodeType&&s.documentElement?(p=(f=s).documentElement,g=!i(f),(r=f.defaultView)&&r.top!==r&&(r.addEventListener?r.addEventListener("unload",oe,!1):r.attachEvent&&r.attachEvent("onunload",oe)),n.attributes=ae(function(e){return e.className="i",!e.getAttribute("className")}),n.getElementsByTagName=ae(function(e){return e.appendChild(f.createComment("")),!e.getElementsByTagName("*").length}),n.getElementsByClassName=G.test(f.getElementsByClassName),n.getById=ae(function(e){return p.appendChild(e).id=w,!f.getElementsByName||!f.getElementsByName(w).length}),n.getById?(o.find.ID=function(e,t){if(void 0!==t.getElementById&&g){var n=t.getElementById(e);return n?[n]:[]}},o.filter.ID=function(e){var t=e.replace(te,ne);return function(e){return e.getAttribute("id")===t}}):(delete o.find.ID,o.filter.ID=function(e){var t=e.replace(te,ne);return function(e){var n=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}}),o.find.TAG=n.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):n.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,o=[],r=0,i=t.getElementsByTagName(e);if("*"===e){for(;n=i[r++];)1===n.nodeType&&o.push(n);return o}return i},o.find.CLASS=n.getElementsByClassName&&function(e,t){return void 0!==t.getElementsByClassName&&g?t.getElementsByClassName(e):void 0},v=[],m=[],(n.qsa=G.test(f.querySelectorAll))&&(ae(function(e){p.appendChild(e).innerHTML="<a id='"+w+"'></a><select id='"+w+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&m.push("[*^$]="+H+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||m.push("\\["+H+"*(?:value|"+O+")"),e.querySelectorAll("[id~="+w+"-]").length||m.push("~="),e.querySelectorAll(":checked").length||m.push(":checked"),e.querySelectorAll("a#"+w+"+*").length||m.push(".#.+[+~]")}),ae(function(e){var t=f.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&m.push("name"+H+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||m.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),m.push(",.*:")})),(n.matchesSelector=G.test(y=p.matches||p.webkitMatchesSelector||p.mozMatchesSelector||p.oMatchesSelector||p.msMatchesSelector))&&ae(function(e){n.disconnectedMatch=y.call(e,"div"),y.call(e,"[s!='']:x"),v.push("!=",F)}),m=m.length&&new RegExp(m.join("|")),v=v.length&&new RegExp(v.join("|")),t=G.test(p.compareDocumentPosition),b=t||G.test(p.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,o=t&&t.parentNode;return e===o||!(!o||1!==o.nodeType||!(n.contains?n.contains(o):e.compareDocumentPosition&&16&e.compareDocumentPosition(o)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},E=t?function(e,t){if(e===t)return h=!0,0;var o=!e.compareDocumentPosition-!t.compareDocumentPosition;return o||(1&(o=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!n.sortDetached&&t.compareDocumentPosition(e)===o?e===f||e.ownerDocument===j&&b(j,e)?-1:t===f||t.ownerDocument===j&&b(j,t)?1:u?R(u,e)-R(u,t):0:4&o?-1:1)}:function(e,t){if(e===t)return h=!0,0;var n,o=0,r=e.parentNode,i=t.parentNode,s=[e],a=[t];if(!r||!i)return e===f?-1:t===f?1:r?-1:i?1:u?R(u,e)-R(u,t):0;if(r===i)return ce(e,t);for(n=e;n=n.parentNode;)s.unshift(n);for(n=t;n=n.parentNode;)a.unshift(n);for(;s[o]===a[o];)o++;return o?ce(s[o],a[o]):s[o]===j?-1:a[o]===j?1:0},f):f},re.matches=function(e,t){return re(e,null,null,t)},re.matchesSelector=function(e,t){if((e.ownerDocument||e)!==f&&d(e),t=t.replace(W,"='$1']"),n.matchesSelector&&g&&!S[t+" "]&&(!v||!v.test(t))&&(!m||!m.test(t)))try{var o=y.call(e,t);if(o||n.disconnectedMatch||e.document&&11!==e.document.nodeType)return o}catch(e){}return re(t,f,null,[e]).length>0},re.contains=function(e,t){return(e.ownerDocument||e)!==f&&d(e),b(e,t)},re.attr=function(e,t){(e.ownerDocument||e)!==f&&d(e);var r=o.attrHandle[t.toLowerCase()],i=r&&I.call(o.attrHandle,t.toLowerCase())?r(e,t,!g):void 0;return void 0!==i?i:n.attributes||!g?e.getAttribute(t):(i=e.getAttributeNode(t))&&i.specified?i.value:null},re.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},re.uniqueSort=function(e){var t,o=[],r=0,i=0;if(h=!n.detectDuplicates,u=!n.sortStable&&e.slice(0),e.sort(E),h){for(;t=e[i++];)t===e[i]&&(r=o.push(i));for(;r--;)e.splice(o[r],1)}return u=null,e},r=re.getText=function(e){var t,n="",o=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=r(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[o++];)n+=r(t);return n},(o=re.selectors={cacheLength:50,createPseudo:se,match:X,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(te,ne),e[3]=(e[3]||e[4]||e[5]||"").replace(te,ne),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||re.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&re.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return X.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&V.test(n)&&(t=s(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(te,ne).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=T[e+" "];return t||(t=new RegExp("(^|"+H+")"+e+"("+H+"|$)"))&&T(e,function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(o){var r=re.attr(o,e);return null==r?"!="===t:!t||(r+="","="===t?r===n:"!="===t?r!==n:"^="===t?n&&0===r.indexOf(n):"*="===t?n&&r.indexOf(n)>-1:"$="===t?n&&r.slice(-n.length)===n:"~="===t?(" "+r.replace(J," ")+" ").indexOf(n)>-1:"|="===t&&(r===n||r.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,n,o,r){var i="nth"!==e.slice(0,3),s="last"!==e.slice(-4),a="of-type"===t;return 1===o&&0===r?function(e){return!!e.parentNode}:function(t,n,l){var c,u,h,d,f,p,g=i!==s?"nextSibling":"previousSibling",m=t.parentNode,v=a&&t.nodeName.toLowerCase(),y=!l&&!a,b=!1;if(m){if(i){for(;g;){for(d=t;d=d[g];)if(a?d.nodeName.toLowerCase()===v:1===d.nodeType)return!1;p=g="only"===e&&!p&&"nextSibling"}return!0}if(p=[s?m.firstChild:m.lastChild],s&&y){for(b=(f=(c=(u=(h=(d=m)[w]||(d[w]={}))[d.uniqueID]||(h[d.uniqueID]={}))[e]||[])[0]===x&&c[1])&&c[2],d=f&&m.childNodes[f];d=++f&&d&&d[g]||(b=f=0)||p.pop();)if(1===d.nodeType&&++b&&d===t){u[e]=[x,f,b];break}}else if(y&&(b=f=(c=(u=(h=(d=t)[w]||(d[w]={}))[d.uniqueID]||(h[d.uniqueID]={}))[e]||[])[0]===x&&c[1]),!1===b)for(;(d=++f&&d&&d[g]||(b=f=0)||p.pop())&&((a?d.nodeName.toLowerCase()!==v:1!==d.nodeType)||!++b||(y&&((u=(h=d[w]||(d[w]={}))[d.uniqueID]||(h[d.uniqueID]={}))[e]=[x,b]),d!==t)););return(b-=r)===o||b%o==0&&b/o>=0}}},PSEUDO:function(e,t){var n,r=o.pseudos[e]||o.setFilters[e.toLowerCase()]||re.error("unsupported pseudo: "+e);return r[w]?r(t):r.length>1?(n=[e,e,"",t],o.setFilters.hasOwnProperty(e.toLowerCase())?se(function(e,n){for(var o,i=r(e,t),s=i.length;s--;)e[o=R(e,i[s])]=!(n[o]=i[s])}):function(e){return r(e,0,n)}):r}},pseudos:{not:se(function(e){var t=[],n=[],o=a(e.replace(U,"$1"));return o[w]?se(function(e,t,n,r){for(var i,s=o(e,null,r,[]),a=e.length;a--;)(i=s[a])&&(e[a]=!(t[a]=i))}):function(e,r,i){return t[0]=e,o(t,null,i,n),t[0]=null,!n.pop()}}),has:se(function(e){return function(t){return re(e,t).length>0}}),contains:se(function(e){return e=e.replace(te,ne),function(t){return(t.textContent||t.innerText||r(t)).indexOf(e)>-1}}),lang:se(function(e){return $.test(e||"")||re.error("unsupported lang: "+e),e=e.replace(te,ne).toLowerCase(),function(t){var n;do{if(n=g?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===p},focus:function(e){return e===f.activeElement&&(!f.hasFocus||f.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return!1===e.disabled},disabled:function(e){return!0===e.disabled},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!o.pseudos.empty(e)},header:function(e){return K.test(e.nodeName)},input:function(e){return Y.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:de(function(){return[0]}),last:de(function(e,t){return[t-1]}),eq:de(function(e,t,n){return[0>n?n+t:n]}),even:de(function(e,t){for(var n=0;t>n;n+=2)e.push(n);return e}),odd:de(function(e,t){for(var n=1;t>n;n+=2)e.push(n);return e}),lt:de(function(e,t,n){for(var o=0>n?n+t:n;--o>=0;)e.push(o);return e}),gt:de(function(e,t,n){for(var o=0>n?n+t:n;++o<t;)e.push(o);return e})}}).pseudos.nth=o.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})o.pseudos[t]=ue(t);for(t in{submit:!0,reset:!0})o.pseudos[t]=he(t);function pe(){}function ge(e){for(var t=0,n=e.length,o="";n>t;t++)o+=e[t].value;return o}function me(e,t,n){var o=t.dir,r=n&&"parentNode"===o,i=k++;return t.first?function(t,n,i){for(;t=t[o];)if(1===t.nodeType||r)return e(t,n,i)}:function(t,n,s){var a,l,c,u=[x,i];if(s){for(;t=t[o];)if((1===t.nodeType||r)&&e(t,n,s))return!0}else for(;t=t[o];)if(1===t.nodeType||r){if((a=(l=(c=t[w]||(t[w]={}))[t.uniqueID]||(c[t.uniqueID]={}))[o])&&a[0]===x&&a[1]===i)return u[2]=a[2];if(l[o]=u,u[2]=e(t,n,s))return!0}}}function ve(e){return e.length>1?function(t,n,o){for(var r=e.length;r--;)if(!e[r](t,n,o))return!1;return!0}:e[0]}function ye(e,t,n,o,r){for(var i,s=[],a=0,l=e.length,c=null!=t;l>a;a++)(i=e[a])&&(n&&!n(i,o,r)||(s.push(i),c&&t.push(a)));return s}function be(e,t,n,o,r,i){return o&&!o[w]&&(o=be(o)),r&&!r[w]&&(r=be(r,i)),se(function(i,s,a,l){var c,u,h,d=[],f=[],p=s.length,g=i||function(e,t,n){for(var o=0,r=t.length;r>o;o++)re(e,t[o],n);return n}(t||"*",a.nodeType?[a]:a,[]),m=!e||!i&&t?g:ye(g,d,e,a,l),v=n?r||(i?e:p||o)?[]:s:m;if(n&&n(m,v,a,l),o)for(c=ye(v,f),o(c,[],a,l),u=c.length;u--;)(h=c[u])&&(v[f[u]]=!(m[f[u]]=h));if(i){if(r||e){if(r){for(c=[],u=v.length;u--;)(h=v[u])&&c.push(m[u]=h);r(null,v=[],c,l)}for(u=v.length;u--;)(h=v[u])&&(c=r?R(i,h):d[u])>-1&&(i[c]=!(s[c]=h))}}else v=ye(v===s?v.splice(p,v.length):v),r?r(null,s,v,l):L.apply(s,v)})}function we(e){for(var t,n,r,i=e.length,s=o.relative[e[0].type],a=s||o.relative[" "],l=s?1:0,u=me(function(e){return e===t},a,!0),h=me(function(e){return R(t,e)>-1},a,!0),d=[function(e,n,o){var r=!s&&(o||n!==c)||((t=n).nodeType?u(e,n,o):h(e,n,o));return t=null,r}];i>l;l++)if(n=o.relative[e[l].type])d=[me(ve(d),n)];else{if((n=o.filter[e[l].type].apply(null,e[l].matches))[w]){for(r=++l;i>r&&!o.relative[e[r].type];r++);return be(l>1&&ve(d),l>1&&ge(e.slice(0,l-1).concat({value:" "===e[l-2].type?"*":""})).replace(U,"$1"),n,r>l&&we(e.slice(l,r)),i>r&&we(e=e.slice(r)),i>r&&ge(e))}d.push(n)}return ve(d)}function je(e,t){var n=t.length>0,r=e.length>0,i=function(i,s,a,l,u){var h,p,m,v=0,y="0",b=i&&[],w=[],j=c,k=i||r&&o.find.TAG("*",u),T=x+=null==j?1:Math.random()||.1,C=k.length;for(u&&(c=s===f||s||u);y!==C&&null!=(h=k[y]);y++){if(r&&h){for(p=0,s||h.ownerDocument===f||(d(h),a=!g);m=e[p++];)if(m(h,s||f,a)){l.push(h);break}u&&(x=T)}n&&((h=!m&&h)&&v--,i&&b.push(h))}if(v+=y,n&&y!==v){for(p=0;m=t[p++];)m(b,w,s,a);if(i){if(v>0)for(;y--;)b[y]||w[y]||(w[y]=_.call(l));w=ye(w)}L.apply(l,w),u&&!i&&w.length>0&&v+t.length>1&&re.uniqueSort(l)}return u&&(x=T,c=j),b};return n?se(i):i}return pe.prototype=o.filters=o.pseudos,o.setFilters=new pe,s=re.tokenize=function(e,t){var n,r,i,s,a,l,c,u=C[e+" "];if(u)return t?0:u.slice(0);for(a=e,l=[],c=o.preFilter;a;){for(s in n&&!(r=z.exec(a))||(r&&(a=a.slice(r[0].length)||a),l.push(i=[])),n=!1,(r=B.exec(a))&&(n=r.shift(),i.push({value:n,type:r[0].replace(U," ")}),a=a.slice(n.length)),o.filter)!(r=X[s].exec(a))||c[s]&&!(r=c[s](r))||(n=r.shift(),i.push({value:n,type:s,matches:r}),a=a.slice(n.length));if(!n)break}return t?a.length:a?re.error(e):C(e,l).slice(0)},a=re.compile=function(e,t){var n,o=[],r=[],i=S[e+" "];if(!i){for(t||(t=s(e)),n=t.length;n--;)(i=we(t[n]))[w]?o.push(i):r.push(i);(i=S(e,je(r,o))).selector=e}return i},l=re.select=function(e,t,r,i){var l,c,u,h,d,f="function"==typeof e&&e,p=!i&&s(e=f.selector||e);if(r=r||[],1===p.length){if((c=p[0]=p[0].slice(0)).length>2&&"ID"===(u=c[0]).type&&n.getById&&9===t.nodeType&&g&&o.relative[c[1].type]){if(!(t=(o.find.ID(u.matches[0].replace(te,ne),t)||[])[0]))return r;f&&(t=t.parentNode),e=e.slice(c.shift().value.length)}for(l=X.needsContext.test(e)?0:c.length;l--&&(u=c[l],!o.relative[h=u.type]);)if((d=o.find[h])&&(i=d(u.matches[0].replace(te,ne),Q.test(c[0].type)&&fe(t.parentNode)||t))){if(c.splice(l,1),!(e=i.length&&ge(c)))return L.apply(r,i),r;break}}return(f||a(e,p))(i,t,!g,r,!t||Q.test(e)&&fe(t.parentNode)||t),r},n.sortStable=w.split("").sort(E).join("")===w,n.detectDuplicates=!!h,d(),n.sortDetached=ae(function(e){return 1&e.compareDocumentPosition(f.createElement("div"))}),ae(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||le("type|href|height|width",function(e,t,n){return n?void 0:e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),n.attributes&&ae(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||le("value",function(e,t,n){return n||"input"!==e.nodeName.toLowerCase()?void 0:e.defaultValue}),ae(function(e){return null==e.getAttribute("disabled")})||le(O,function(e,t,n){var o;return n?void 0:!0===e[t]?t.toLowerCase():(o=e.getAttributeNode(t))&&o.specified?o.value:null}),re}(e);p.find=w,p.expr=w.selectors,p.expr[":"]=p.expr.pseudos,p.uniqueSort=p.unique=w.uniqueSort,p.text=w.getText,p.isXMLDoc=w.isXML,p.contains=w.contains;var j=function(e,t,n){for(var o=[],r=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(r&&p(e).is(n))break;o.push(e)}return o},x=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},k=p.expr.match.needsContext,T=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,C=/^.[^:#\[\.,]*$/;function S(e,t,n){if(p.isFunction(t))return p.grep(e,function(e,o){return!!t.call(e,o,e)!==n});if(t.nodeType)return p.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(C.test(t))return p.filter(t,e,n);t=p.filter(t,e)}return p.grep(e,function(e){return p.inArray(e,t)>-1!==n})}p.filter=function(e,t,n){var o=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===o.nodeType?p.find.matchesSelector(o,e)?[o]:[]:p.find.matches(e,p.grep(t,function(e){return 1===e.nodeType}))},p.fn.extend({find:function(e){var t,n=[],o=this,r=o.length;if("string"!=typeof e)return this.pushStack(p(e).filter(function(){for(t=0;r>t;t++)if(p.contains(o[t],this))return!0}));for(t=0;r>t;t++)p.find(e,o[t],n);return(n=this.pushStack(r>1?p.unique(n):n)).selector=this.selector?this.selector+" "+e:e,n},filter:function(e){return this.pushStack(S(this,e||[],!1))},not:function(e){return this.pushStack(S(this,e||[],!0))},is:function(e){return!!S(this,"string"==typeof e&&k.test(e)?p(e):e||[],!1).length}});var E,A=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(p.fn.init=function(e,t,n){var o,i;if(!e)return this;if(n=n||E,"string"==typeof e){if(!(o="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:A.exec(e))||!o[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(o[1]){if(t=t instanceof p?t[0]:t,p.merge(this,p.parseHTML(o[1],t&&t.nodeType?t.ownerDocument||t:r,!0)),T.test(o[1])&&p.isPlainObject(t))for(o in t)p.isFunction(this[o])?this[o](t[o]):this.attr(o,t[o]);return this}if((i=r.getElementById(o[2]))&&i.parentNode){if(i.id!==o[2])return E.find(e);this.length=1,this[0]=i}return this.context=r,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):p.isFunction(e)?void 0!==n.ready?n.ready(e):e(p):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),p.makeArray(e,this))}).prototype=p.fn,E=p(r);var I=/^(?:parents|prev(?:Until|All))/,N={children:!0,contents:!0,next:!0,prev:!0};function _(e,t){do{e=e[t]}while(e&&1!==e.nodeType);return e}p.fn.extend({has:function(e){var t,n=p(e,this),o=n.length;return this.filter(function(){for(t=0;o>t;t++)if(p.contains(this,n[t]))return!0})},closest:function(e,t){for(var n,o=0,r=this.length,i=[],s=k.test(e)||"string"!=typeof e?p(e,t||this.context):0;r>o;o++)for(n=this[o];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(s?s.index(n)>-1:1===n.nodeType&&p.find.matchesSelector(n,e))){i.push(n);break}return this.pushStack(i.length>1?p.uniqueSort(i):i)},index:function(e){return e?"string"==typeof e?p.inArray(this[0],p(e)):p.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(p.uniqueSort(p.merge(this.get(),p(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),p.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return j(e,"parentNode")},parentsUntil:function(e,t,n){return j(e,"parentNode",n)},next:function(e){return _(e,"nextSibling")},prev:function(e){return _(e,"previousSibling")},nextAll:function(e){return j(e,"nextSibling")},prevAll:function(e){return j(e,"previousSibling")},nextUntil:function(e,t,n){return j(e,"nextSibling",n)},prevUntil:function(e,t,n){return j(e,"previousSibling",n)},siblings:function(e){return x((e.parentNode||{}).firstChild,e)},children:function(e){return x(e.firstChild)},contents:function(e){return p.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:p.merge([],e.childNodes)}},function(e,t){p.fn[e]=function(n,o){var r=p.map(this,t,n);return"Until"!==e.slice(-5)&&(o=n),o&&"string"==typeof o&&(r=p.filter(o,r)),this.length>1&&(N[e]||(r=p.uniqueSort(r)),I.test(e)&&(r=r.reverse())),this.pushStack(r)}});var D,L,M=/\S+/g;function R(){r.addEventListener?(r.removeEventListener("DOMContentLoaded",O),e.removeEventListener("load",O)):(r.detachEvent("onreadystatechange",O),e.detachEvent("onload",O))}function O(){(r.addEventListener||"load"===e.event.type||"complete"===r.readyState)&&(R(),p.ready())}for(L in p.Callbacks=function(e){e="string"==typeof e?function(e){var t={};return p.each(e.match(M)||[],function(e,n){t[n]=!0}),t}(e):p.extend({},e);var t,n,o,r,i=[],s=[],a=-1,l=function(){for(r=e.once,o=t=!0;s.length;a=-1)for(n=s.shift();++a<i.length;)!1===i[a].apply(n[0],n[1])&&e.stopOnFalse&&(a=i.length,n=!1);e.memory||(n=!1),t=!1,r&&(i=n?[]:"")},c={add:function(){return i&&(n&&!t&&(a=i.length-1,s.push(n)),function t(n){p.each(n,function(n,o){p.isFunction(o)?e.unique&&c.has(o)||i.push(o):o&&o.length&&"string"!==p.type(o)&&t(o)})}(arguments),n&&!t&&l()),this},remove:function(){return p.each(arguments,function(e,t){for(var n;(n=p.inArray(t,i,n))>-1;)i.splice(n,1),a>=n&&a--}),this},has:function(e){return e?p.inArray(e,i)>-1:i.length>0},empty:function(){return i&&(i=[]),this},disable:function(){return r=s=[],i=n="",this},disabled:function(){return!i},lock:function(){return r=!0,n||c.disable(),this},locked:function(){return!!r},fireWith:function(e,n){return r||(n=[e,(n=n||[]).slice?n.slice():n],s.push(n),t||l()),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!o}};return c},p.extend({Deferred:function(e){var t=[["resolve","done",p.Callbacks("once memory"),"resolved"],["reject","fail",p.Callbacks("once memory"),"rejected"],["notify","progress",p.Callbacks("memory")]],n="pending",o={state:function(){return n},always:function(){return r.done(arguments).fail(arguments),this},then:function(){var e=arguments;return p.Deferred(function(n){p.each(t,function(t,i){var s=p.isFunction(e[t])&&e[t];r[i[1]](function(){var e=s&&s.apply(this,arguments);e&&p.isFunction(e.promise)?e.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[i[0]+"With"](this===o?n.promise():this,s?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?p.extend(e,o):o}},r={};return o.pipe=o.then,p.each(t,function(e,i){var s=i[2],a=i[3];o[i[1]]=s.add,a&&s.add(function(){n=a},t[1^e][2].disable,t[2][2].lock),r[i[0]]=function(){return r[i[0]+"With"](this===r?o:this,arguments),this},r[i[0]+"With"]=s.fireWith}),o.promise(r),e&&e.call(r,r),r},when:function(e){var t,n,o,r=0,s=i.call(arguments),a=s.length,l=1!==a||e&&p.isFunction(e.promise)?a:0,c=1===l?e:p.Deferred(),u=function(e,n,o){return function(r){n[e]=this,o[e]=arguments.length>1?i.call(arguments):r,o===t?c.notifyWith(n,o):--l||c.resolveWith(n,o)}};if(a>1)for(t=new Array(a),n=new Array(a),o=new Array(a);a>r;r++)s[r]&&p.isFunction(s[r].promise)?s[r].promise().progress(u(r,n,t)).done(u(r,o,s)).fail(c.reject):--l;return l||c.resolveWith(o,s),c.promise()}}),p.fn.ready=function(e){return p.ready.promise().done(e),this},p.extend({isReady:!1,readyWait:1,holdReady:function(e){e?p.readyWait++:p.ready(!0)},ready:function(e){(!0===e?--p.readyWait:p.isReady)||(p.isReady=!0,!0!==e&&--p.readyWait>0||(D.resolveWith(r,[p]),p.fn.triggerHandler&&(p(r).triggerHandler("ready"),p(r).off("ready"))))}}),p.ready.promise=function(t){if(!D)if(D=p.Deferred(),"complete"===r.readyState||"loading"!==r.readyState&&!r.documentElement.doScroll)e.setTimeout(p.ready);else if(r.addEventListener)r.addEventListener("DOMContentLoaded",O),e.addEventListener("load",O);else{r.attachEvent("onreadystatechange",O),e.attachEvent("onload",O);var n=!1;try{n=null==e.frameElement&&r.documentElement}catch(e){}n&&n.doScroll&&function t(){if(!p.isReady){try{n.doScroll("left")}catch(n){return e.setTimeout(t,50)}R(),p.ready()}}()}return D.promise(t)},p.ready.promise(),p(d))break;d.ownFirst="0"===L,d.inlineBlockNeedsLayout=!1,p(function(){var e,t,n,o;(n=r.getElementsByTagName("body")[0])&&n.style&&(t=r.createElement("div"),(o=r.createElement("div")).style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",n.appendChild(o).appendChild(t),void 0!==t.style.zoom&&(t.style.cssText="display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1",d.inlineBlockNeedsLayout=e=3===t.offsetWidth,e&&(n.style.zoom=1)),n.removeChild(o))}),function(){var e=r.createElement("div");d.deleteExpando=!0;try{delete e.test}catch(e){d.deleteExpando=!1}e=null}();var H=function(e){var t=p.noData[(e.nodeName+" ").toLowerCase()],n=+e.nodeType||1;return(1===n||9===n)&&(!t||!0!==t&&e.getAttribute("classid")===t)},P=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,q=/([A-Z])/g;function F(e,t,n){if(void 0===n&&1===e.nodeType){var o="data-"+t.replace(q,"-$1").toLowerCase();if("string"==typeof(n=e.getAttribute(o))){try{n="true"===n||"false"!==n&&("null"===n?null:+n+""===n?+n:P.test(n)?p.parseJSON(n):n)}catch(e){}p.data(e,t,n)}else n=void 0}return n}function J(e){var t;for(t in e)if(("data"!==t||!p.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function U(e,t,n,r){if(H(e)){var i,s,a=p.expando,l=e.nodeType,c=l?p.cache:e,u=l?e[a]:e[a]&&a;if(u&&c[u]&&(r||c[u].data)||void 0!==n||"string"!=typeof t)return u||(u=l?e[a]=o.pop()||p.guid++:a),c[u]||(c[u]=l?{}:{toJSON:p.noop}),"object"!=typeof t&&"function"!=typeof t||(r?c[u]=p.extend(c[u],t):c[u].data=p.extend(c[u].data,t)),s=c[u],r||(s.data||(s.data={}),s=s.data),void 0!==n&&(s[p.camelCase(t)]=n),"string"==typeof t?null==(i=s[t])&&(i=s[p.camelCase(t)]):i=s,i}}function z(e,t,n){if(H(e)){var o,r,i=e.nodeType,s=i?p.cache:e,a=i?e[p.expando]:p.expando;if(s[a]){if(t&&(o=n?s[a]:s[a].data)){p.isArray(t)?t=t.concat(p.map(t,p.camelCase)):t in o?t=[t]:t=(t=p.camelCase(t))in o?[t]:t.split(" "),r=t.length;for(;r--;)delete o[t[r]];if(n?!J(o):!p.isEmptyObject(o))return}(n||(delete s[a].data,J(s[a])))&&(i?p.cleanData([e],!0):d.deleteExpando||s!=s.window?delete s[a]:s[a]=void 0)}}}p.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(e){return!!(e=e.nodeType?p.cache[e[p.expando]]:e[p.expando])&&!J(e)},data:function(e,t,n){return U(e,t,n)},removeData:function(e,t){return z(e,t)},_data:function(e,t,n){return U(e,t,n,!0)},_removeData:function(e,t){return z(e,t,!0)}}),p.fn.extend({data:function(e,t){var n,o,r,i=this[0],s=i&&i.attributes;if(void 0===e){if(this.length&&(r=p.data(i),1===i.nodeType&&!p._data(i,"parsedAttrs"))){for(n=s.length;n--;)s[n]&&(0===(o=s[n].name).indexOf("data-")&&F(i,o=p.camelCase(o.slice(5)),r[o]));p._data(i,"parsedAttrs",!0)}return r}return"object"==typeof e?this.each(function(){p.data(this,e)}):arguments.length>1?this.each(function(){p.data(this,e,t)}):i?F(i,e,p.data(i,e)):void 0},removeData:function(e){return this.each(function(){p.removeData(this,e)})}}),p.extend({queue:function(e,t,n){var o;return e?(t=(t||"fx")+"queue",o=p._data(e,t),n&&(!o||p.isArray(n)?o=p._data(e,t,p.makeArray(n)):o.push(n)),o||[]):void 0},dequeue:function(e,t){t=t||"fx";var n=p.queue(e,t),o=n.length,r=n.shift(),i=p._queueHooks(e,t);"inprogress"===r&&(r=n.shift(),o--),r&&("fx"===t&&n.unshift("inprogress"),delete i.stop,r.call(e,function(){p.dequeue(e,t)},i)),!o&&i&&i.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return p._data(e,n)||p._data(e,n,{empty:p.Callbacks("once memory").add(function(){p._removeData(e,t+"queue"),p._removeData(e,n)})})}}),p.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?p.queue(this[0],e):void 0===t?this:this.each(function(){var n=p.queue(this,e,t);p._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&p.dequeue(this,e)})},dequeue:function(e){return this.each(function(){p.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,o=1,r=p.Deferred(),i=this,s=this.length,a=function(){--o||r.resolveWith(i,[i])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";s--;)(n=p._data(i[s],e+"queueHooks"))&&n.empty&&(o++,n.empty.add(a));return a(),r.promise(t)}}),function(){var e;d.shrinkWrapBlocks=function(){return null!=e?e:(e=!1,(n=r.getElementsByTagName("body")[0])&&n.style?(t=r.createElement("div"),(o=r.createElement("div")).style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",n.appendChild(o).appendChild(t),void 0!==t.style.zoom&&(t.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:1px;width:1px;zoom:1",t.appendChild(r.createElement("div")).style.width="5px",e=3!==t.offsetWidth),n.removeChild(o),e):void 0);var t,n,o}}();var B=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,W=new RegExp("^(?:([+-])=|)("+B+")([a-z%]*)$","i"),V=["Top","Right","Bottom","Left"],$=function(e,t){return e=t||e,"none"===p.css(e,"display")||!p.contains(e.ownerDocument,e)};function X(e,t,n,o){var r,i=1,s=20,a=o?function(){return o.cur()}:function(){return p.css(e,t,"")},l=a(),c=n&&n[3]||(p.cssNumber[t]?"":"px"),u=(p.cssNumber[t]||"px"!==c&&+l)&&W.exec(p.css(e,t));if(u&&u[3]!==c){c=c||u[3],n=n||[],u=+l||1;do{u/=i=i||".5",p.style(e,t,u+c)}while(i!==(i=a()/l)&&1!==i&&--s)}return n&&(u=+u||+l||0,r=n[1]?u+(n[1]+1)*n[2]:+n[2],o&&(o.unit=c,o.start=u,o.end=r)),r}var Y=function(e,t,n,o,r,i,s){var a=0,l=e.length,c=null==n;if("object"===p.type(n))for(a in r=!0,n)Y(e,t,a,n[a],!0,i,s);else if(void 0!==o&&(r=!0,p.isFunction(o)||(s=!0),c&&(s?(t.call(e,o),t=null):(c=t,t=function(e,t,n){return c.call(p(e),n)})),t))for(;l>a;a++)t(e[a],n,s?o:o.call(e[a],a,t(e[a],n)));return r?e:c?t.call(e):l?t(e[0],n):i},K=/^(?:checkbox|radio)$/i,G=/<([\w:-]+)/,Z=/^$|\/(?:java|ecma)script/i,Q=/^\s+/,ee="abbr|article|aside|audio|bdi|canvas|data|datalist|details|dialog|figcaption|figure|footer|header|hgroup|main|mark|meter|nav|output|picture|progress|section|summary|template|time|video";function te(e){var t=ee.split("|"),n=e.createDocumentFragment();if(n.createElement)for(;t.length;)n.createElement(t.pop());return n}!function(){var e=r.createElement("div"),t=r.createDocumentFragment(),n=r.createElement("input");e.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",d.leadingWhitespace=3===e.firstChild.nodeType,d.tbody=!e.getElementsByTagName("tbody").length,d.htmlSerialize=!!e.getElementsByTagName("link").length,d.html5Clone="<:nav></:nav>"!==r.createElement("nav").cloneNode(!0).outerHTML,n.type="checkbox",n.checked=!0,t.appendChild(n),d.appendChecked=n.checked,e.innerHTML="<textarea>x</textarea>",d.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue,t.appendChild(e),(n=r.createElement("input")).setAttribute("type","radio"),n.setAttribute("checked","checked"),n.setAttribute("name","t"),e.appendChild(n),d.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,d.noCloneEvent=!!e.addEventListener,e[p.expando]=1,d.attributes=!e.getAttribute(p.expando)}();var ne={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:d.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]};function oe(e,t){var n,o,r=0,i=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):void 0;if(!i)for(i=[],n=e.childNodes||e;null!=(o=n[r]);r++)!t||p.nodeName(o,t)?i.push(o):p.merge(i,oe(o,t));return void 0===t||t&&p.nodeName(e,t)?p.merge([e],i):i}function re(e,t){for(var n,o=0;null!=(n=e[o]);o++)p._data(n,"globalEval",!t||p._data(t[o],"globalEval"))}ne.optgroup=ne.option,ne.tbody=ne.tfoot=ne.colgroup=ne.caption=ne.thead,ne.th=ne.td;var ie=/<|&#?\w+;/,se=/<tbody/i;function ae(e){K.test(e.type)&&(e.defaultChecked=e.checked)}function le(e,t,n,o,r){for(var i,s,a,l,c,u,h,f=e.length,g=te(t),m=[],v=0;f>v;v++)if((s=e[v])||0===s)if("object"===p.type(s))p.merge(m,s.nodeType?[s]:s);else if(ie.test(s)){for(l=l||g.appendChild(t.createElement("div")),c=(G.exec(s)||["",""])[1].toLowerCase(),h=ne[c]||ne._default,l.innerHTML=h[1]+p.htmlPrefilter(s)+h[2],i=h[0];i--;)l=l.lastChild;if(!d.leadingWhitespace&&Q.test(s)&&m.push(t.createTextNode(Q.exec(s)[0])),!d.tbody)for(i=(s="table"!==c||se.test(s)?"<table>"!==h[1]||se.test(s)?0:l:l.firstChild)&&s.childNodes.length;i--;)p.nodeName(u=s.childNodes[i],"tbody")&&!u.childNodes.length&&s.removeChild(u);for(p.merge(m,l.childNodes),l.textContent="";l.firstChild;)l.removeChild(l.firstChild);l=g.lastChild}else m.push(t.createTextNode(s));for(l&&g.removeChild(l),d.appendChecked||p.grep(oe(m,"input"),ae),v=0;s=m[v++];)if(o&&p.inArray(s,o)>-1)r&&r.push(s);else if(a=p.contains(s.ownerDocument,s),l=oe(g.appendChild(s),"script"),a&&re(l),n)for(i=0;s=l[i++];)Z.test(s.type||"")&&n.push(s);return l=null,g}!function(){var t,n,o=r.createElement("div");for(t in{submit:!0,change:!0,focusin:!0})n="on"+t,(d[t]=n in e)||(o.setAttribute(n,"t"),d[t]=!1===o.attributes[n].expando);o=null}();var ce=/^(?:input|select|textarea)$/i,ue=/^key/,he=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,de=/^(?:focusinfocus|focusoutblur)$/,fe=/^([^.]*)(?:\.(.+)|)/;function pe(){return!0}function ge(){return!1}function me(){try{return r.activeElement}catch(e){}}function ve(e,t,n,o,r,i){var s,a;if("object"==typeof t){for(a in"string"!=typeof n&&(o=o||n,n=void 0),t)ve(e,a,n,o,t[a],i);return e}if(null==o&&null==r?(r=n,o=n=void 0):null==r&&("string"==typeof n?(r=o,o=void 0):(r=o,o=n,n=void 0)),!1===r)r=ge;else if(!r)return e;return 1===i&&(s=r,(r=function(e){return p().off(e),s.apply(this,arguments)}).guid=s.guid||(s.guid=p.guid++)),e.each(function(){p.event.add(this,t,r,o,n)})}p.event={global:{},add:function(e,t,n,o,r){var i,s,a,l,c,u,h,d,f,g,m,v=p._data(e);if(v){for(n.handler&&(n=(l=n).handler,r=l.selector),n.guid||(n.guid=p.guid++),(s=v.events)||(s=v.events={}),(u=v.handle)||((u=v.handle=function(e){return void 0===p||e&&p.event.triggered===e.type?void 0:p.event.dispatch.apply(u.elem,arguments)}).elem=e),a=(t=(t||"").match(M)||[""]).length;a--;)f=m=(i=fe.exec(t[a])||[])[1],g=(i[2]||"").split(".").sort(),f&&(c=p.event.special[f]||{},f=(r?c.delegateType:c.bindType)||f,c=p.event.special[f]||{},h=p.extend({type:f,origType:m,data:o,handler:n,guid:n.guid,selector:r,needsContext:r&&p.expr.match.needsContext.test(r),namespace:g.join(".")},l),(d=s[f])||((d=s[f]=[]).delegateCount=0,c.setup&&!1!==c.setup.call(e,o,g,u)||(e.addEventListener?e.addEventListener(f,u,!1):e.attachEvent&&e.attachEvent("on"+f,u))),c.add&&(c.add.call(e,h),h.handler.guid||(h.handler.guid=n.guid)),r?d.splice(d.delegateCount++,0,h):d.push(h),p.event.global[f]=!0);e=null}},remove:function(e,t,n,o,r){var i,s,a,l,c,u,h,d,f,g,m,v=p.hasData(e)&&p._data(e);if(v&&(u=v.events)){for(c=(t=(t||"").match(M)||[""]).length;c--;)if(f=m=(a=fe.exec(t[c])||[])[1],g=(a[2]||"").split(".").sort(),f){for(h=p.event.special[f]||{},d=u[f=(o?h.delegateType:h.bindType)||f]||[],a=a[2]&&new RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=i=d.length;i--;)s=d[i],!r&&m!==s.origType||n&&n.guid!==s.guid||a&&!a.test(s.namespace)||o&&o!==s.selector&&("**"!==o||!s.selector)||(d.splice(i,1),s.selector&&d.delegateCount--,h.remove&&h.remove.call(e,s));l&&!d.length&&(h.teardown&&!1!==h.teardown.call(e,g,v.handle)||p.removeEvent(e,f,v.handle),delete u[f])}else for(f in u)p.event.remove(e,f+t[c],n,o,!0);p.isEmptyObject(u)&&(delete v.handle,p._removeData(e,"events"))}},trigger:function(t,n,o,i){var s,a,l,c,u,d,f,g=[o||r],m=h.call(t,"type")?t.type:t,v=h.call(t,"namespace")?t.namespace.split("."):[];if(l=d=o=o||r,3!==o.nodeType&&8!==o.nodeType&&!de.test(m+p.event.triggered)&&(m.indexOf(".")>-1&&(v=m.split("."),m=v.shift(),v.sort()),a=m.indexOf(":")<0&&"on"+m,(t=t[p.expando]?t:new p.Event(m,"object"==typeof t&&t)).isTrigger=i?2:3,t.namespace=v.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+v.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=o),n=null==n?[t]:p.makeArray(n,[t]),u=p.event.special[m]||{},i||!u.trigger||!1!==u.trigger.apply(o,n))){if(!i&&!u.noBubble&&!p.isWindow(o)){for(c=u.delegateType||m,de.test(c+m)||(l=l.parentNode);l;l=l.parentNode)g.push(l),d=l;d===(o.ownerDocument||r)&&g.push(d.defaultView||d.parentWindow||e)}for(f=0;(l=g[f++])&&!t.isPropagationStopped();)t.type=f>1?c:u.bindType||m,(s=(p._data(l,"events")||{})[t.type]&&p._data(l,"handle"))&&s.apply(l,n),(s=a&&l[a])&&s.apply&&H(l)&&(t.result=s.apply(l,n),!1===t.result&&t.preventDefault());if(t.type=m,!i&&!t.isDefaultPrevented()&&(!u._default||!1===u._default.apply(g.pop(),n))&&H(o)&&a&&o[m]&&!p.isWindow(o)){(d=o[a])&&(o[a]=null),p.event.triggered=m;try{o[m]()}catch(e){}p.event.triggered=void 0,d&&(o[a]=d)}return t.result}},dispatch:function(e){e=p.event.fix(e);var t,n,o,r,s,a=[],l=i.call(arguments),c=(p._data(this,"events")||{})[e.type]||[],u=p.event.special[e.type]||{};if(l[0]=e,e.delegateTarget=this,!u.preDispatch||!1!==u.preDispatch.call(this,e)){for(a=p.event.handlers.call(this,e,c),t=0;(r=a[t++])&&!e.isPropagationStopped();)for(e.currentTarget=r.elem,n=0;(s=r.handlers[n++])&&!e.isImmediatePropagationStopped();)e.rnamespace&&!e.rnamespace.test(s.namespace)||(e.handleObj=s,e.data=s.data,void 0!==(o=((p.event.special[s.origType]||{}).handle||s.handler).apply(r.elem,l))&&!1===(e.result=o)&&(e.preventDefault(),e.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,e),e.result}},handlers:function(e,t){var n,o,r,i,s=[],a=t.delegateCount,l=e.target;if(a&&l.nodeType&&("click"!==e.type||isNaN(e.button)||e.button<1))for(;l!=this;l=l.parentNode||this)if(1===l.nodeType&&(!0!==l.disabled||"click"!==e.type)){for(o=[],n=0;a>n;n++)void 0===o[r=(i=t[n]).selector+" "]&&(o[r]=i.needsContext?p(r,this).index(l)>-1:p.find(r,this,null,[l]).length),o[r]&&o.push(i);o.length&&s.push({elem:l,handlers:o})}return a<t.length&&s.push({elem:this,handlers:t.slice(a)}),s},fix:function(e){if(e[p.expando])return e;var t,n,o,i=e.type,s=e,a=this.fixHooks[i];for(a||(this.fixHooks[i]=a=he.test(i)?this.mouseHooks:ue.test(i)?this.keyHooks:{}),o=a.props?this.props.concat(a.props):this.props,e=new p.Event(s),t=o.length;t--;)e[n=o[t]]=s[n];return e.target||(e.target=s.srcElement||r),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,a.filter?a.filter(e,s):e},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,o,i,s=t.button,a=t.fromElement;return null==e.pageX&&null!=t.clientX&&(i=(o=e.target.ownerDocument||r).documentElement,n=o.body,e.pageX=t.clientX+(i&&i.scrollLeft||n&&n.scrollLeft||0)-(i&&i.clientLeft||n&&n.clientLeft||0),e.pageY=t.clientY+(i&&i.scrollTop||n&&n.scrollTop||0)-(i&&i.clientTop||n&&n.clientTop||0)),!e.relatedTarget&&a&&(e.relatedTarget=a===e.target?t.toElement:a),e.which||void 0===s||(e.which=1&s?1:2&s?3:4&s?2:0),e}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==me()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){return this===me()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return p.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(e){return p.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n){var o=p.extend(new p.Event,n,{type:e,isSimulated:!0});p.event.trigger(o,null,t),o.isDefaultPrevented()&&n.preventDefault()}},p.removeEvent=r.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)}:function(e,t,n){var o="on"+t;e.detachEvent&&(void 0===e[o]&&(e[o]=null),e.detachEvent(o,n))},p.Event=function(e,t){return this instanceof p.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?pe:ge):this.type=e,t&&p.extend(this,t),this.timeStamp=e&&e.timeStamp||p.now(),void(this[p.expando]=!0)):new p.Event(e,t)},p.Event.prototype={constructor:p.Event,isDefaultPrevented:ge,isPropagationStopped:ge,isImmediatePropagationStopped:ge,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=pe,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=pe,e&&!this.isSimulated&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=pe,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},p.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){p.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,o=e.relatedTarget,r=e.handleObj;return o&&(o===this||p.contains(this,o))||(e.type=r.origType,n=r.handler.apply(this,arguments),e.type=t),n}}}),d.submit||(p.event.special.submit={setup:function(){return!p.nodeName(this,"form")&&void p.event.add(this,"click._submit keypress._submit",function(e){var t=e.target,n=p.nodeName(t,"input")||p.nodeName(t,"button")?p.prop(t,"form"):void 0;n&&!p._data(n,"submit")&&(p.event.add(n,"submit._submit",function(e){e._submitBubble=!0}),p._data(n,"submit",!0))})},postDispatch:function(e){e._submitBubble&&(delete e._submitBubble,this.parentNode&&!e.isTrigger&&p.event.simulate("submit",this.parentNode,e))},teardown:function(){return!p.nodeName(this,"form")&&void p.event.remove(this,"._submit")}}),d.change||(p.event.special.change={setup:function(){return ce.test(this.nodeName)?("checkbox"!==this.type&&"radio"!==this.type||(p.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._justChanged=!0)}),p.event.add(this,"click._change",function(e){this._justChanged&&!e.isTrigger&&(this._justChanged=!1),p.event.simulate("change",this,e)})),!1):void p.event.add(this,"beforeactivate._change",function(e){var t=e.target;ce.test(t.nodeName)&&!p._data(t,"change")&&(p.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||p.event.simulate("change",this.parentNode,e)}),p._data(t,"change",!0))})},handle:function(e){var t=e.target;return this!==t||e.isSimulated||e.isTrigger||"radio"!==t.type&&"checkbox"!==t.type?e.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return p.event.remove(this,"._change"),!ce.test(this.nodeName)}}),d.focusin||p.each({focus:"focusin",blur:"focusout"},function(e,t){var n=function(e){p.event.simulate(t,e.target,p.event.fix(e))};p.event.special[t]={setup:function(){var o=this.ownerDocument||this,r=p._data(o,t);r||o.addEventListener(e,n,!0),p._data(o,t,(r||0)+1)},teardown:function(){var o=this.ownerDocument||this,r=p._data(o,t)-1;r?p._data(o,t,r):(o.removeEventListener(e,n,!0),p._removeData(o,t))}}}),p.fn.extend({on:function(e,t,n,o){return ve(this,e,t,n,o)},one:function(e,t,n,o){return ve(this,e,t,n,o,1)},off:function(e,t,n){var o,r;if(e&&e.preventDefault&&e.handleObj)return o=e.handleObj,p(e.delegateTarget).off(o.namespace?o.origType+"."+o.namespace:o.origType,o.selector,o.handler),this;if("object"==typeof e){for(r in e)this.off(r,t,e[r]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=ge),this.each(function(){p.event.remove(this,e,n,t)})},trigger:function(e,t){return this.each(function(){p.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];return n?p.event.trigger(e,t,n,!0):void 0}});var ye=/ jQuery\d+="(?:null|\d+)"/g,be=new RegExp("<(?:"+ee+")[\\s/>]","i"),we=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,je=/<script|<style|<link/i,xe=/checked\s*(?:[^=]|=\s*.checked.)/i,ke=/^true\/(.*)/,Te=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Ce=te(r).appendChild(r.createElement("div"));function Se(e,t){return p.nodeName(e,"table")&&p.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function Ee(e){return e.type=(null!==p.find.attr(e,"type"))+"/"+e.type,e}function Ae(e){var t=ke.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function Ie(e,t){if(1===t.nodeType&&p.hasData(e)){var n,o,r,i=p._data(e),s=p._data(t,i),a=i.events;if(a)for(n in delete s.handle,s.events={},a)for(o=0,r=a[n].length;r>o;o++)p.event.add(t,n,a[n][o]);s.data&&(s.data=p.extend({},s.data))}}function Ne(e,t){var n,o,r;if(1===t.nodeType){if(n=t.nodeName.toLowerCase(),!d.noCloneEvent&&t[p.expando]){for(o in(r=p._data(t)).events)p.removeEvent(t,o,r.handle);t.removeAttribute(p.expando)}"script"===n&&t.text!==e.text?(Ee(t).text=e.text,Ae(t)):"object"===n?(t.parentNode&&(t.outerHTML=e.outerHTML),d.html5Clone&&e.innerHTML&&!p.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===n&&K.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===n?t.defaultSelected=t.selected=e.defaultSelected:"input"!==n&&"textarea"!==n||(t.defaultValue=e.defaultValue)}}function _e(e,t,n,o){t=s.apply([],t);var r,i,a,l,c,u,h=0,f=e.length,g=f-1,m=t[0],v=p.isFunction(m);if(v||f>1&&"string"==typeof m&&!d.checkClone&&xe.test(m))return e.each(function(r){var i=e.eq(r);v&&(t[0]=m.call(this,r,i.html())),_e(i,t,n,o)});if(f&&(r=(u=le(t,e[0].ownerDocument,!1,e,o)).firstChild,1===u.childNodes.length&&(u=r),r||o)){for(a=(l=p.map(oe(u,"script"),Ee)).length;f>h;h++)i=u,h!==g&&(i=p.clone(i,!0,!0),a&&p.merge(l,oe(i,"script"))),n.call(e[h],i,h);if(a)for(c=l[l.length-1].ownerDocument,p.map(l,Ae),h=0;a>h;h++)i=l[h],Z.test(i.type||"")&&!p._data(i,"globalEval")&&p.contains(c,i)&&(i.src?p._evalUrl&&p._evalUrl(i.src):p.globalEval((i.text||i.textContent||i.innerHTML||"").replace(Te,"")));u=r=null}return e}function De(e,t,n){for(var o,r=t?p.filter(t,e):e,i=0;null!=(o=r[i]);i++)n||1!==o.nodeType||p.cleanData(oe(o)),o.parentNode&&(n&&p.contains(o.ownerDocument,o)&&re(oe(o,"script")),o.parentNode.removeChild(o));return e}p.extend({htmlPrefilter:function(e){return e.replace(we,"<$1></$2>")},clone:function(e,t,n){var o,r,i,s,a,l=p.contains(e.ownerDocument,e);if(d.html5Clone||p.isXMLDoc(e)||!be.test("<"+e.nodeName+">")?i=e.cloneNode(!0):(Ce.innerHTML=e.outerHTML,Ce.removeChild(i=Ce.firstChild)),!(d.noCloneEvent&&d.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||p.isXMLDoc(e)))for(o=oe(i),a=oe(e),s=0;null!=(r=a[s]);++s)o[s]&&Ne(r,o[s]);if(t)if(n)for(a=a||oe(e),o=o||oe(i),s=0;null!=(r=a[s]);s++)Ie(r,o[s]);else Ie(e,i);return(o=oe(i,"script")).length>0&&re(o,!l&&oe(e,"script")),o=a=r=null,i},cleanData:function(e,t){for(var n,r,i,s,a=0,l=p.expando,c=p.cache,u=d.attributes,h=p.event.special;null!=(n=e[a]);a++)if((t||H(n))&&(s=(i=n[l])&&c[i])){if(s.events)for(r in s.events)h[r]?p.event.remove(n,r):p.removeEvent(n,r,s.handle);c[i]&&(delete c[i],u||void 0===n.removeAttribute?n[l]=void 0:n.removeAttribute(l),o.push(i))}}}),p.fn.extend({domManip:_e,detach:function(e){return De(this,e,!0)},remove:function(e){return De(this,e)},text:function(e){return Y(this,function(e){return void 0===e?p.text(this):this.empty().append((this[0]&&this[0].ownerDocument||r).createTextNode(e))},null,e,arguments.length)},append:function(){return _e(this,arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Se(this,e).appendChild(e)})},prepend:function(){return _e(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Se(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return _e(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return _e(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++){for(1===e.nodeType&&p.cleanData(oe(e,!1));e.firstChild;)e.removeChild(e.firstChild);e.options&&p.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return p.clone(this,e,t)})},html:function(e){return Y(this,function(e){var t=this[0]||{},n=0,o=this.length;if(void 0===e)return 1===t.nodeType?t.innerHTML.replace(ye,""):void 0;if("string"==typeof e&&!je.test(e)&&(d.htmlSerialize||!be.test(e))&&(d.leadingWhitespace||!Q.test(e))&&!ne[(G.exec(e)||["",""])[1].toLowerCase()]){e=p.htmlPrefilter(e);try{for(;o>n;n++)1===(t=this[n]||{}).nodeType&&(p.cleanData(oe(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=[];return _e(this,arguments,function(t){var n=this.parentNode;p.inArray(this,e)<0&&(p.cleanData(oe(this)),n&&n.replaceChild(t,this))},e)}}),p.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){p.fn[e]=function(e){for(var n,o=0,r=[],i=p(e),s=i.length-1;s>=o;o++)n=o===s?this:this.clone(!0),p(i[o])[t](n),a.apply(r,n.get());return this.pushStack(r)}});var Le,Me={HTML:"block",BODY:"block"};function Re(e,t){var n=p(t.createElement(e)).appendTo(t.body),o=p.css(n[0],"display");return n.detach(),o}function Oe(e){var t=r,n=Me[e];return n||("none"!==(n=Re(e,t))&&n||((t=((Le=(Le||p("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement))[0].contentWindow||Le[0].contentDocument).document).write(),t.close(),n=Re(e,t),Le.detach()),Me[e]=n),n}var He=/^margin/,Pe=new RegExp("^("+B+")(?!px)[a-z%]+$","i"),qe=function(e,t,n,o){var r,i,s={};for(i in t)s[i]=e.style[i],e.style[i]=t[i];for(i in r=n.apply(e,o||[]),t)e.style[i]=s[i];return r},Fe=r.documentElement;!function(){var t,n,o,i,s,a,l=r.createElement("div"),c=r.createElement("div");if(c.style){function u(){var u,h,d=r.documentElement;d.appendChild(l),c.style.cssText="-webkit-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",t=o=a=!1,n=s=!0,e.getComputedStyle&&(h=e.getComputedStyle(c),t="1%"!==(h||{}).top,a="2px"===(h||{}).marginLeft,o="4px"===(h||{width:"4px"}).width,c.style.marginRight="50%",n="4px"===(h||{marginRight:"4px"}).marginRight,(u=c.appendChild(r.createElement("div"))).style.cssText=c.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",u.style.marginRight=u.style.width="0",c.style.width="1px",s=!parseFloat((e.getComputedStyle(u)||{}).marginRight),c.removeChild(u)),c.style.display="none",(i=0===c.getClientRects().length)&&(c.style.display="",c.innerHTML="<table><tr><td></td><td>t</td></tr></table>",c.childNodes[0].style.borderCollapse="separate",(u=c.getElementsByTagName("td"))[0].style.cssText="margin:0;border:0;padding:0;display:none",(i=0===u[0].offsetHeight)&&(u[0].style.display="",u[1].style.display="none",i=0===u[0].offsetHeight)),d.removeChild(l)}c.style.cssText="float:left;opacity:.5",d.opacity="0.5"===c.style.opacity,d.cssFloat=!!c.style.cssFloat,c.style.backgroundClip="content-box",c.cloneNode(!0).style.backgroundClip="",d.clearCloneStyle="content-box"===c.style.backgroundClip,(l=r.createElement("div")).style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",c.innerHTML="",l.appendChild(c),d.boxSizing=""===c.style.boxSizing||""===c.style.MozBoxSizing||""===c.style.WebkitBoxSizing,p.extend(d,{reliableHiddenOffsets:function(){return null==t&&u(),i},boxSizingReliable:function(){return null==t&&u(),o},pixelMarginRight:function(){return null==t&&u(),n},pixelPosition:function(){return null==t&&u(),t},reliableMarginRight:function(){return null==t&&u(),s},reliableMarginLeft:function(){return null==t&&u(),a}})}}();var Je,Ue,ze=/^(top|right|bottom|left)$/;function Be(e,t){return{get:function(){return e()?void delete this.get:(this.get=t).apply(this,arguments)}}}e.getComputedStyle?(Je=function(t){var n=t.ownerDocument.defaultView;return n&&n.opener||(n=e),n.getComputedStyle(t)},Ue=function(e,t,n){var o,r,i,s,a=e.style;return""!==(s=(n=n||Je(e))?n.getPropertyValue(t)||n[t]:void 0)&&void 0!==s||p.contains(e.ownerDocument,e)||(s=p.style(e,t)),n&&!d.pixelMarginRight()&&Pe.test(s)&&He.test(t)&&(o=a.width,r=a.minWidth,i=a.maxWidth,a.minWidth=a.maxWidth=a.width=s,s=n.width,a.width=o,a.minWidth=r,a.maxWidth=i),void 0===s?s:s+""}):Fe.currentStyle&&(Je=function(e){return e.currentStyle},Ue=function(e,t,n){var o,r,i,s,a=e.style;return null==(s=(n=n||Je(e))?n[t]:void 0)&&a&&a[t]&&(s=a[t]),Pe.test(s)&&!ze.test(t)&&(o=a.left,(i=(r=e.runtimeStyle)&&r.left)&&(r.left=e.currentStyle.left),a.left="fontSize"===t?"1em":s,s=a.pixelLeft+"px",a.left=o,i&&(r.left=i)),void 0===s?s:s+""||"auto"});var We=/alpha\([^)]*\)/i,Ve=/opacity\s*=\s*([^)]*)/i,$e=/^(none|table(?!-c[ea]).+)/,Xe=new RegExp("^("+B+")(.*)$","i"),Ye={position:"absolute",visibility:"hidden",display:"block"},Ke={letterSpacing:"0",fontWeight:"400"},Ge=["Webkit","O","Moz","ms"],Ze=r.createElement("div").style;function Qe(e){if(e in Ze)return e;for(var t=e.charAt(0).toUpperCase()+e.slice(1),n=Ge.length;n--;)if((e=Ge[n]+t)in Ze)return e}function et(e,t){for(var n,o,r,i=[],s=0,a=e.length;a>s;s++)(o=e[s]).style&&(i[s]=p._data(o,"olddisplay"),n=o.style.display,t?(i[s]||"none"!==n||(o.style.display=""),""===o.style.display&&$(o)&&(i[s]=p._data(o,"olddisplay",Oe(o.nodeName)))):(r=$(o),(n&&"none"!==n||!r)&&p._data(o,"olddisplay",r?n:p.css(o,"display"))));for(s=0;a>s;s++)(o=e[s]).style&&(t&&"none"!==o.style.display&&""!==o.style.display||(o.style.display=t?i[s]||"":"none"));return e}function tt(e,t,n){var o=Xe.exec(t);return o?Math.max(0,o[1]-(n||0))+(o[2]||"px"):t}function nt(e,t,n,o,r){for(var i=n===(o?"border":"content")?4:"width"===t?1:0,s=0;4>i;i+=2)"margin"===n&&(s+=p.css(e,n+V[i],!0,r)),o?("content"===n&&(s-=p.css(e,"padding"+V[i],!0,r)),"margin"!==n&&(s-=p.css(e,"border"+V[i]+"Width",!0,r))):(s+=p.css(e,"padding"+V[i],!0,r),"padding"!==n&&(s+=p.css(e,"border"+V[i]+"Width",!0,r)));return s}function ot(e,t,n){var o=!0,r="width"===t?e.offsetWidth:e.offsetHeight,i=Je(e),s=d.boxSizing&&"border-box"===p.css(e,"boxSizing",!1,i);if(0>=r||null==r){if((0>(r=Ue(e,t,i))||null==r)&&(r=e.style[t]),Pe.test(r))return r;o=s&&(d.boxSizingReliable()||r===e.style[t]),r=parseFloat(r)||0}return r+nt(e,t,n||(s?"border":"content"),o,i)+"px"}function rt(e,t,n,o,r){return new rt.prototype.init(e,t,n,o,r)}p.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Ue(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:d.cssFloat?"cssFloat":"styleFloat"},style:function(e,t,n,o){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var r,i,s,a=p.camelCase(t),l=e.style;if(t=p.cssProps[a]||(p.cssProps[a]=Qe(a)||a),s=p.cssHooks[t]||p.cssHooks[a],void 0===n)return s&&"get"in s&&void 0!==(r=s.get(e,!1,o))?r:l[t];if("string"===(i=typeof n)&&(r=W.exec(n))&&r[1]&&(n=X(e,t,r),i="number"),null!=n&&n==n&&("number"===i&&(n+=r&&r[3]||(p.cssNumber[a]?"":"px")),d.clearCloneStyle||""!==n||0!==t.indexOf("background")||(l[t]="inherit"),!(s&&"set"in s&&void 0===(n=s.set(e,n,o)))))try{l[t]=n}catch(e){}}},css:function(e,t,n,o){var r,i,s,a=p.camelCase(t);return t=p.cssProps[a]||(p.cssProps[a]=Qe(a)||a),(s=p.cssHooks[t]||p.cssHooks[a])&&"get"in s&&(i=s.get(e,!0,n)),void 0===i&&(i=Ue(e,t,o)),"normal"===i&&t in Ke&&(i=Ke[t]),""===n||n?(r=parseFloat(i),!0===n||isFinite(r)?r||0:i):i}}),p.each(["height","width"],function(e,t){p.cssHooks[t]={get:function(e,n,o){return n?$e.test(p.css(e,"display"))&&0===e.offsetWidth?qe(e,Ye,function(){return ot(e,t,o)}):ot(e,t,o):void 0},set:function(e,n,o){var r=o&&Je(e);return tt(0,n,o?nt(e,t,o,d.boxSizing&&"border-box"===p.css(e,"boxSizing",!1,r),r):0)}}}),d.opacity||(p.cssHooks.opacity={get:function(e,t){return Ve.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,o=e.currentStyle,r=p.isNumeric(t)?"alpha(opacity="+100*t+")":"",i=o&&o.filter||n.filter||"";n.zoom=1,(t>=1||""===t)&&""===p.trim(i.replace(We,""))&&n.removeAttribute&&(n.removeAttribute("filter"),""===t||o&&!o.filter)||(n.filter=We.test(i)?i.replace(We,r):i+" "+r)}}),p.cssHooks.marginRight=Be(d.reliableMarginRight,function(e,t){return t?qe(e,{display:"inline-block"},Ue,[e,"marginRight"]):void 0}),p.cssHooks.marginLeft=Be(d.reliableMarginLeft,function(e,t){return t?(parseFloat(Ue(e,"marginLeft"))||(p.contains(e.ownerDocument,e)?e.getBoundingClientRect().left-qe(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}):0))+"px":void 0}),p.each({margin:"",padding:"",border:"Width"},function(e,t){p.cssHooks[e+t]={expand:function(n){for(var o=0,r={},i="string"==typeof n?n.split(" "):[n];4>o;o++)r[e+V[o]+t]=i[o]||i[o-2]||i[0];return r}},He.test(e)||(p.cssHooks[e+t].set=tt)}),p.fn.extend({css:function(e,t){return Y(this,function(e,t,n){var o,r,i={},s=0;if(p.isArray(t)){for(o=Je(e),r=t.length;r>s;s++)i[t[s]]=p.css(e,t[s],!1,o);return i}return void 0!==n?p.style(e,t,n):p.css(e,t)},e,t,arguments.length>1)},show:function(){return et(this,!0)},hide:function(){return et(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){$(this)?p(this).show():p(this).hide()})}}),p.Tween=rt,rt.prototype={constructor:rt,init:function(e,t,n,o,r,i){this.elem=e,this.prop=n,this.easing=r||p.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=o,this.unit=i||(p.cssNumber[n]?"":"px")},cur:function(){var e=rt.propHooks[this.prop];return e&&e.get?e.get(this):rt.propHooks._default.get(this)},run:function(e){var t,n=rt.propHooks[this.prop];return this.options.duration?this.pos=t=p.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):rt.propHooks._default.set(this),this}},rt.prototype.init.prototype=rt.prototype,rt.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=p.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){p.fx.step[e.prop]?p.fx.step[e.prop](e):1!==e.elem.nodeType||null==e.elem.style[p.cssProps[e.prop]]&&!p.cssHooks[e.prop]?e.elem[e.prop]=e.now:p.style(e.elem,e.prop,e.now+e.unit)}}},rt.propHooks.scrollTop=rt.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},p.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},p.fx=rt.prototype.init,p.fx.step={};var it,st,at=/^(?:toggle|show|hide)$/,lt=/queueHooks$/;function ct(){return e.setTimeout(function(){it=void 0}),it=p.now()}function ut(e,t){var n,o={height:e},r=0;for(t=t?1:0;4>r;r+=2-t)o["margin"+(n=V[r])]=o["padding"+n]=e;return t&&(o.opacity=o.width=e),o}function ht(e,t,n){for(var o,r=(dt.tweeners[t]||[]).concat(dt.tweeners["*"]),i=0,s=r.length;s>i;i++)if(o=r[i].call(n,t,e))return o}function dt(e,t,n){var o,r,i=0,s=dt.prefilters.length,a=p.Deferred().always(function(){delete l.elem}),l=function(){if(r)return!1;for(var t=it||ct(),n=Math.max(0,c.startTime+c.duration-t),o=1-(n/c.duration||0),i=0,s=c.tweens.length;s>i;i++)c.tweens[i].run(o);return a.notifyWith(e,[c,o,n]),1>o&&s?n:(a.resolveWith(e,[c]),!1)},c=a.promise({elem:e,props:p.extend({},t),opts:p.extend(!0,{specialEasing:{},easing:p.easing._default},n),originalProperties:t,originalOptions:n,startTime:it||ct(),duration:n.duration,tweens:[],createTween:function(t,n){var o=p.Tween(e,c.opts,t,n,c.opts.specialEasing[t]||c.opts.easing);return c.tweens.push(o),o},stop:function(t){var n=0,o=t?c.tweens.length:0;if(r)return this;for(r=!0;o>n;n++)c.tweens[n].run(1);return t?(a.notifyWith(e,[c,1,0]),a.resolveWith(e,[c,t])):a.rejectWith(e,[c,t]),this}}),u=c.props;for(function(e,t){var n,o,r,i,s;for(n in e)if(r=t[o=p.camelCase(n)],i=e[n],p.isArray(i)&&(r=i[1],i=e[n]=i[0]),n!==o&&(e[o]=i,delete e[n]),(s=p.cssHooks[o])&&"expand"in s)for(n in i=s.expand(i),delete e[o],i)n in e||(e[n]=i[n],t[n]=r);else t[o]=r}(u,c.opts.specialEasing);s>i;i++)if(o=dt.prefilters[i].call(c,e,u,c.opts))return p.isFunction(o.stop)&&(p._queueHooks(c.elem,c.opts.queue).stop=p.proxy(o.stop,o)),o;return p.map(u,ht,c),p.isFunction(c.opts.start)&&c.opts.start.call(e,c),p.fx.timer(p.extend(l,{elem:e,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}p.Animation=p.extend(dt,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return X(n.elem,e,W.exec(t),n),n}]},tweener:function(e,t){p.isFunction(e)?(t=e,e=["*"]):e=e.match(M);for(var n,o=0,r=e.length;r>o;o++)n=e[o],dt.tweeners[n]=dt.tweeners[n]||[],dt.tweeners[n].unshift(t)},prefilters:[function(e,t,n){var o,r,i,s,a,l,c,u=this,h={},f=e.style,g=e.nodeType&&$(e),m=p._data(e,"fxshow");for(o in n.queue||(null==(a=p._queueHooks(e,"fx")).unqueued&&(a.unqueued=0,l=a.empty.fire,a.empty.fire=function(){a.unqueued||l()}),a.unqueued++,u.always(function(){u.always(function(){a.unqueued--,p.queue(e,"fx").length||a.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[f.overflow,f.overflowX,f.overflowY],"inline"===("none"===(c=p.css(e,"display"))?p._data(e,"olddisplay")||Oe(e.nodeName):c)&&"none"===p.css(e,"float")&&(d.inlineBlockNeedsLayout&&"inline"!==Oe(e.nodeName)?f.zoom=1:f.display="inline-block")),n.overflow&&(f.overflow="hidden",d.shrinkWrapBlocks()||u.always(function(){f.overflow=n.overflow[0],f.overflowX=n.overflow[1],f.overflowY=n.overflow[2]})),t)if(r=t[o],at.exec(r)){if(delete t[o],i=i||"toggle"===r,r===(g?"hide":"show")){if("show"!==r||!m||void 0===m[o])continue;g=!0}h[o]=m&&m[o]||p.style(e,o)}else c=void 0;if(p.isEmptyObject(h))"inline"===("none"===c?Oe(e.nodeName):c)&&(f.display=c);else for(o in m?"hidden"in m&&(g=m.hidden):m=p._data(e,"fxshow",{}),i&&(m.hidden=!g),g?p(e).show():u.done(function(){p(e).hide()}),u.done(function(){var t;for(t in p._removeData(e,"fxshow"),h)p.style(e,t,h[t])}),h)s=ht(g?m[o]:0,o,u),o in m||(m[o]=s.start,g&&(s.end=s.start,s.start="width"===o||"height"===o?1:0))}],prefilter:function(e,t){t?dt.prefilters.unshift(e):dt.prefilters.push(e)}}),p.speed=function(e,t,n){var o=e&&"object"==typeof e?p.extend({},e):{complete:n||!n&&t||p.isFunction(e)&&e,duration:e,easing:n&&t||t&&!p.isFunction(t)&&t};return o.duration=p.fx.off?0:"number"==typeof o.duration?o.duration:o.duration in p.fx.speeds?p.fx.speeds[o.duration]:p.fx.speeds._default,null!=o.queue&&!0!==o.queue||(o.queue="fx"),o.old=o.complete,o.complete=function(){p.isFunction(o.old)&&o.old.call(this),o.queue&&p.dequeue(this,o.queue)},o},p.fn.extend({fadeTo:function(e,t,n,o){return this.filter($).css("opacity",0).show().end().animate({opacity:t},e,n,o)},animate:function(e,t,n,o){var r=p.isEmptyObject(e),i=p.speed(t,n,o),s=function(){var t=dt(this,p.extend({},e),i);(r||p._data(this,"finish"))&&t.stop(!0)};return s.finish=s,r||!1===i.queue?this.each(s):this.queue(i.queue,s)},stop:function(e,t,n){var o=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&!1!==e&&this.queue(e||"fx",[]),this.each(function(){var t=!0,r=null!=e&&e+"queueHooks",i=p.timers,s=p._data(this);if(r)s[r]&&s[r].stop&&o(s[r]);else for(r in s)s[r]&&s[r].stop&&lt.test(r)&&o(s[r]);for(r=i.length;r--;)i[r].elem!==this||null!=e&&i[r].queue!==e||(i[r].anim.stop(n),t=!1,i.splice(r,1));!t&&n||p.dequeue(this,e)})},finish:function(e){return!1!==e&&(e=e||"fx"),this.each(function(){var t,n=p._data(this),o=n[e+"queue"],r=n[e+"queueHooks"],i=p.timers,s=o?o.length:0;for(n.finish=!0,p.queue(this,e,[]),r&&r.stop&&r.stop.call(this,!0),t=i.length;t--;)i[t].elem===this&&i[t].queue===e&&(i[t].anim.stop(!0),i.splice(t,1));for(t=0;s>t;t++)o[t]&&o[t].finish&&o[t].finish.call(this);delete n.finish})}}),p.each(["toggle","show","hide"],function(e,t){var n=p.fn[t];p.fn[t]=function(e,o,r){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(ut(t,!0),e,o,r)}}),p.each({slideDown:ut("show"),slideUp:ut("hide"),slideToggle:ut("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){p.fn[e]=function(e,n,o){return this.animate(t,e,n,o)}}),p.timers=[],p.fx.tick=function(){var e,t=p.timers,n=0;for(it=p.now();n<t.length;n++)(e=t[n])()||t[n]!==e||t.splice(n--,1);t.length||p.fx.stop(),it=void 0},p.fx.timer=function(e){p.timers.push(e),e()?p.fx.start():p.timers.pop()},p.fx.interval=13,p.fx.start=function(){st||(st=e.setInterval(p.fx.tick,p.fx.interval))},p.fx.stop=function(){e.clearInterval(st),st=null},p.fx.speeds={slow:600,fast:200,_default:400},p.fn.delay=function(t,n){return t=p.fx&&p.fx.speeds[t]||t,n=n||"fx",this.queue(n,function(n,o){var r=e.setTimeout(n,t);o.stop=function(){e.clearTimeout(r)}})},function(){var e,t=r.createElement("input"),n=r.createElement("div"),o=r.createElement("select"),i=o.appendChild(r.createElement("option"));(n=r.createElement("div")).setAttribute("className","t"),n.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",e=n.getElementsByTagName("a")[0],t.setAttribute("type","checkbox"),n.appendChild(t),(e=n.getElementsByTagName("a")[0]).style.cssText="top:1px",d.getSetAttribute="t"!==n.className,d.style=/top/.test(e.getAttribute("style")),d.hrefNormalized="/a"===e.getAttribute("href"),d.checkOn=!!t.value,d.optSelected=i.selected,d.enctype=!!r.createElement("form").enctype,o.disabled=!0,d.optDisabled=!i.disabled,(t=r.createElement("input")).setAttribute("value",""),d.input=""===t.getAttribute("value"),t.value="t",t.setAttribute("type","radio"),d.radioValue="t"===t.value}();var ft=/\r/g,pt=/[\x20\t\r\n\f]+/g;p.fn.extend({val:function(e){var t,n,o,r=this[0];return arguments.length?(o=p.isFunction(e),this.each(function(n){var r;1===this.nodeType&&(null==(r=o?e.call(this,n,p(this).val()):e)?r="":"number"==typeof r?r+="":p.isArray(r)&&(r=p.map(r,function(e){return null==e?"":e+""})),(t=p.valHooks[this.type]||p.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,r,"value")||(this.value=r))})):r?(t=p.valHooks[r.type]||p.valHooks[r.nodeName.toLowerCase()])&&"get"in t&&void 0!==(n=t.get(r,"value"))?n:"string"==typeof(n=r.value)?n.replace(ft,""):null==n?"":n:void 0}}),p.extend({valHooks:{option:{get:function(e){var t=p.find.attr(e,"value");return null!=t?t:p.trim(p.text(e)).replace(pt," ")}},select:{get:function(e){for(var t,n,o=e.options,r=e.selectedIndex,i="select-one"===e.type||0>r,s=i?null:[],a=i?r+1:o.length,l=0>r?a:i?r:0;a>l;l++)if(((n=o[l]).selected||l===r)&&(d.optDisabled?!n.disabled:null===n.getAttribute("disabled"))&&(!n.parentNode.disabled||!p.nodeName(n.parentNode,"optgroup"))){if(t=p(n).val(),i)return t;s.push(t)}return s},set:function(e,t){for(var n,o,r=e.options,i=p.makeArray(t),s=r.length;s--;)if(o=r[s],p.inArray(p.valHooks.option.get(o),i)>-1)try{o.selected=n=!0}catch(e){o.scrollHeight}else o.selected=!1;return n||(e.selectedIndex=-1),r}}}}),p.each(["radio","checkbox"],function(){p.valHooks[this]={set:function(e,t){return p.isArray(t)?e.checked=p.inArray(p(e).val(),t)>-1:void 0}},d.checkOn||(p.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var gt,mt,vt=p.expr.attrHandle,yt=/^(?:checked|selected)$/i,bt=d.getSetAttribute,wt=d.input;p.fn.extend({attr:function(e,t){return Y(this,p.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){p.removeAttr(this,e)})}}),p.extend({attr:function(e,t,n){var o,r,i=e.nodeType;if(3!==i&&8!==i&&2!==i)return void 0===e.getAttribute?p.prop(e,t,n):(1===i&&p.isXMLDoc(e)||(t=t.toLowerCase(),r=p.attrHooks[t]||(p.expr.match.bool.test(t)?mt:gt)),void 0!==n?null===n?void p.removeAttr(e,t):r&&"set"in r&&void 0!==(o=r.set(e,n,t))?o:(e.setAttribute(t,n+""),n):r&&"get"in r&&null!==(o=r.get(e,t))?o:null==(o=p.find.attr(e,t))?void 0:o)},attrHooks:{type:{set:function(e,t){if(!d.radioValue&&"radio"===t&&p.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,o,r=0,i=t&&t.match(M);if(i&&1===e.nodeType)for(;n=i[r++];)o=p.propFix[n]||n,p.expr.match.bool.test(n)?wt&&bt||!yt.test(n)?e[o]=!1:e[p.camelCase("default-"+n)]=e[o]=!1:p.attr(e,n,""),e.removeAttribute(bt?n:o)}}),mt={set:function(e,t,n){return!1===t?p.removeAttr(e,n):wt&&bt||!yt.test(n)?e.setAttribute(!bt&&p.propFix[n]||n,n):e[p.camelCase("default-"+n)]=e[n]=!0,n}},p.each(p.expr.match.bool.source.match(/\w+/g),function(e,t){var n=vt[t]||p.find.attr;wt&&bt||!yt.test(t)?vt[t]=function(e,t,o){var r,i;return o||(i=vt[t],vt[t]=r,r=null!=n(e,t,o)?t.toLowerCase():null,vt[t]=i),r}:vt[t]=function(e,t,n){return n?void 0:e[p.camelCase("default-"+t)]?t.toLowerCase():null}}),wt&&bt||(p.attrHooks.value={set:function(e,t,n){return p.nodeName(e,"input")?void(e.defaultValue=t):gt&&gt.set(e,t,n)}}),bt||(gt={set:function(e,t,n){var o=e.getAttributeNode(n);return o||e.setAttributeNode(o=e.ownerDocument.createAttribute(n)),o.value=t+="","value"===n||t===e.getAttribute(n)?t:void 0}},vt.id=vt.name=vt.coords=function(e,t,n){var o;return n?void 0:(o=e.getAttributeNode(t))&&""!==o.value?o.value:null},p.valHooks.button={get:function(e,t){var n=e.getAttributeNode(t);return n&&n.specified?n.value:void 0},set:gt.set},p.attrHooks.contenteditable={set:function(e,t,n){gt.set(e,""!==t&&t,n)}},p.each(["width","height"],function(e,t){p.attrHooks[t]={set:function(e,n){return""===n?(e.setAttribute(t,"auto"),n):void 0}}})),d.style||(p.attrHooks.style={get:function(e){return e.style.cssText||void 0},set:function(e,t){return e.style.cssText=t+""}});var jt=/^(?:input|select|textarea|button|object)$/i,xt=/^(?:a|area)$/i;p.fn.extend({prop:function(e,t){return Y(this,p.prop,e,t,arguments.length>1)},removeProp:function(e){return e=p.propFix[e]||e,this.each(function(){try{this[e]=void 0,delete this[e]}catch(e){}})}}),p.extend({prop:function(e,t,n){var o,r,i=e.nodeType;if(3!==i&&8!==i&&2!==i)return 1===i&&p.isXMLDoc(e)||(t=p.propFix[t]||t,r=p.propHooks[t]),void 0!==n?r&&"set"in r&&void 0!==(o=r.set(e,n,t))?o:e[t]=n:r&&"get"in r&&null!==(o=r.get(e,t))?o:e[t]},propHooks:{tabIndex:{get:function(e){var t=p.find.attr(e,"tabindex");return t?parseInt(t,10):jt.test(e.nodeName)||xt.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),d.hrefNormalized||p.each(["href","src"],function(e,t){p.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}}),d.optSelected||(p.propHooks.selected={get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),p.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){p.propFix[this.toLowerCase()]=this}),d.enctype||(p.propFix.enctype="encoding");var kt=/[\t\r\n\f]/g;function Tt(e){return p.attr(e,"class")||""}p.fn.extend({addClass:function(e){var t,n,o,r,i,s,a,l=0;if(p.isFunction(e))return this.each(function(t){p(this).addClass(e.call(this,t,Tt(this)))});if("string"==typeof e&&e)for(t=e.match(M)||[];n=this[l++];)if(r=Tt(n),o=1===n.nodeType&&(" "+r+" ").replace(kt," ")){for(s=0;i=t[s++];)o.indexOf(" "+i+" ")<0&&(o+=i+" ");r!==(a=p.trim(o))&&p.attr(n,"class",a)}return this},removeClass:function(e){var t,n,o,r,i,s,a,l=0;if(p.isFunction(e))return this.each(function(t){p(this).removeClass(e.call(this,t,Tt(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof e&&e)for(t=e.match(M)||[];n=this[l++];)if(r=Tt(n),o=1===n.nodeType&&(" "+r+" ").replace(kt," ")){for(s=0;i=t[s++];)for(;o.indexOf(" "+i+" ")>-1;)o=o.replace(" "+i+" "," ");r!==(a=p.trim(o))&&p.attr(n,"class",a)}return this},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):p.isFunction(e)?this.each(function(n){p(this).toggleClass(e.call(this,n,Tt(this),t),t)}):this.each(function(){var t,o,r,i;if("string"===n)for(o=0,r=p(this),i=e.match(M)||[];t=i[o++];)r.hasClass(t)?r.removeClass(t):r.addClass(t);else void 0!==e&&"boolean"!==n||((t=Tt(this))&&p._data(this,"__className__",t),p.attr(this,"class",t||!1===e?"":p._data(this,"__className__")||""))})},hasClass:function(e){var t,n,o=0;for(t=" "+e+" ";n=this[o++];)if(1===n.nodeType&&(" "+Tt(n)+" ").replace(kt," ").indexOf(t)>-1)return!0;return!1}}),p.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){p.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),p.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}});var Ct=e.location,St=p.now(),Et=/\?/,At=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;p.parseJSON=function(t){if(e.JSON&&e.JSON.parse)return e.JSON.parse(t+"");var n,o=null,r=p.trim(t+"");return r&&!p.trim(r.replace(At,function(e,t,r,i){return n&&t&&(o=0),0===o?e:(n=r||t,o+=!i-!r,"")}))?Function("return "+r)():p.error("Invalid JSON: "+t)},p.parseXML=function(t){var n;if(!t||"string"!=typeof t)return null;try{e.DOMParser?n=(new e.DOMParser).parseFromString(t,"text/xml"):((n=new e.ActiveXObject("Microsoft.XMLDOM")).async="false",n.loadXML(t))}catch(e){n=void 0}return n&&n.documentElement&&!n.getElementsByTagName("parsererror").length||p.error("Invalid XML: "+t),n};var It=/#.*$/,Nt=/([?&])_=[^&]*/,_t=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Dt=/^(?:GET|HEAD)$/,Lt=/^\/\//,Mt=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,Rt={},Ot={},Ht="*/".concat("*"),Pt=Ct.href,qt=Mt.exec(Pt.toLowerCase())||[];function Ft(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var o,r=0,i=t.toLowerCase().match(M)||[];if(p.isFunction(n))for(;o=i[r++];)"+"===o.charAt(0)?(o=o.slice(1)||"*",(e[o]=e[o]||[]).unshift(n)):(e[o]=e[o]||[]).push(n)}}function Jt(e,t,n,o){var r={},i=e===Ot;function s(a){var l;return r[a]=!0,p.each(e[a]||[],function(e,a){var c=a(t,n,o);return"string"!=typeof c||i||r[c]?i?!(l=c):void 0:(t.dataTypes.unshift(c),s(c),!1)}),l}return s(t.dataTypes[0])||!r["*"]&&s("*")}function Ut(e,t){var n,o,r=p.ajaxSettings.flatOptions||{};for(o in t)void 0!==t[o]&&((r[o]?e:n||(n={}))[o]=t[o]);return n&&p.extend(!0,e,n),e}function zt(e){return e.style&&e.style.display||p.css(e,"display")}p.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Pt,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(qt[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Ht,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":p.parseJSON,"text xml":p.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Ut(Ut(e,p.ajaxSettings),t):Ut(p.ajaxSettings,e)},ajaxPrefilter:Ft(Rt),ajaxTransport:Ft(Ot),ajax:function(t,n){"object"==typeof t&&(n=t,t=void 0),n=n||{};var o,r,i,s,a,l,c,u,h=p.ajaxSetup({},n),d=h.context||h,f=h.context&&(d.nodeType||d.jquery)?p(d):p.event,g=p.Deferred(),m=p.Callbacks("once memory"),v=h.statusCode||{},y={},b={},w=0,j="canceled",x={readyState:0,getResponseHeader:function(e){var t;if(2===w){if(!u)for(u={};t=_t.exec(s);)u[t[1].toLowerCase()]=t[2];t=u[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===w?s:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return w||(e=b[n]=b[n]||e,y[e]=t),this},overrideMimeType:function(e){return w||(h.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>w)for(t in e)v[t]=[v[t],e[t]];else x.always(e[x.status]);return this},abort:function(e){var t=e||j;return c&&c.abort(t),k(0,t),this}};if(g.promise(x).complete=m.add,x.success=x.done,x.error=x.fail,h.url=((t||h.url||Pt)+"").replace(It,"").replace(Lt,qt[1]+"//"),h.type=n.method||n.type||h.method||h.type,h.dataTypes=p.trim(h.dataType||"*").toLowerCase().match(M)||[""],null==h.crossDomain&&(o=Mt.exec(h.url.toLowerCase()),h.crossDomain=!(!o||o[1]===qt[1]&&o[2]===qt[2]&&(o[3]||("http:"===o[1]?"80":"443"))===(qt[3]||("http:"===qt[1]?"80":"443")))),h.data&&h.processData&&"string"!=typeof h.data&&(h.data=p.param(h.data,h.traditional)),Jt(Rt,h,n,x),2===w)return x;for(r in(l=p.event&&h.global)&&0==p.active++&&p.event.trigger("ajaxStart"),h.type=h.type.toUpperCase(),h.hasContent=!Dt.test(h.type),i=h.url,h.hasContent||(h.data&&(i=h.url+=(Et.test(i)?"&":"?")+h.data,delete h.data),!1===h.cache&&(h.url=Nt.test(i)?i.replace(Nt,"$1_="+St++):i+(Et.test(i)?"&":"?")+"_="+St++)),h.ifModified&&(p.lastModified[i]&&x.setRequestHeader("If-Modified-Since",p.lastModified[i]),p.etag[i]&&x.setRequestHeader("If-None-Match",p.etag[i])),(h.data&&h.hasContent&&!1!==h.contentType||n.contentType)&&x.setRequestHeader("Content-Type",h.contentType),x.setRequestHeader("Accept",h.dataTypes[0]&&h.accepts[h.dataTypes[0]]?h.accepts[h.dataTypes[0]]+("*"!==h.dataTypes[0]?", "+Ht+"; q=0.01":""):h.accepts["*"]),h.headers)x.setRequestHeader(r,h.headers[r]);if(h.beforeSend&&(!1===h.beforeSend.call(d,x,h)||2===w))return x.abort();for(r in j="abort",{success:1,error:1,complete:1})x[r](h[r]);if(c=Jt(Ot,h,n,x)){if(x.readyState=1,l&&f.trigger("ajaxSend",[x,h]),2===w)return x;h.async&&h.timeout>0&&(a=e.setTimeout(function(){x.abort("timeout")},h.timeout));try{w=1,c.send(y,k)}catch(e){if(!(2>w))throw e;k(-1,e)}}else k(-1,"No Transport");function k(t,n,o,r){var u,y,b,j,k,T=n;2!==w&&(w=2,a&&e.clearTimeout(a),c=void 0,s=r||"",x.readyState=t>0?4:0,u=t>=200&&300>t||304===t,o&&(j=function(e,t,n){for(var o,r,i,s,a=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(s in a)if(a[s]&&a[s].test(r)){l.unshift(s);break}if(l[0]in n)i=l[0];else{for(s in n){if(!l[0]||e.converters[s+" "+l[0]]){i=s;break}o||(o=s)}i=i||o}return i?(i!==l[0]&&l.unshift(i),n[i]):void 0}(h,x,o)),j=function(e,t,n,o){var r,i,s,a,l,c={},u=e.dataTypes.slice();if(u[1])for(s in e.converters)c[s.toLowerCase()]=e.converters[s];for(i=u.shift();i;)if(e.responseFields[i]&&(n[e.responseFields[i]]=t),!l&&o&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=i,i=u.shift())if("*"===i)i=l;else if("*"!==l&&l!==i){if(!(s=c[l+" "+i]||c["* "+i]))for(r in c)if((a=r.split(" "))[1]===i&&(s=c[l+" "+a[0]]||c["* "+a[0]])){!0===s?s=c[r]:!0!==c[r]&&(i=a[0],u.unshift(a[1]));break}if(!0!==s)if(s&&e.throws)t=s(t);else try{t=s(t)}catch(e){return{state:"parsererror",error:s?e:"No conversion from "+l+" to "+i}}}return{state:"success",data:t}}(h,j,x,u),u?(h.ifModified&&((k=x.getResponseHeader("Last-Modified"))&&(p.lastModified[i]=k),(k=x.getResponseHeader("etag"))&&(p.etag[i]=k)),204===t||"HEAD"===h.type?T="nocontent":304===t?T="notmodified":(T=j.state,y=j.data,u=!(b=j.error))):(b=T,!t&&T||(T="error",0>t&&(t=0))),x.status=t,x.statusText=(n||T)+"",u?g.resolveWith(d,[y,T,x]):g.rejectWith(d,[x,T,b]),x.statusCode(v),v=void 0,l&&f.trigger(u?"ajaxSuccess":"ajaxError",[x,h,u?y:b]),m.fireWith(d,[x,T]),l&&(f.trigger("ajaxComplete",[x,h]),--p.active||p.event.trigger("ajaxStop")))}return x},getJSON:function(e,t,n){return p.get(e,t,n,"json")},getScript:function(e,t){return p.get(e,void 0,t,"script")}}),p.each(["get","post"],function(e,t){p[t]=function(e,n,o,r){return p.isFunction(n)&&(r=r||o,o=n,n=void 0),p.ajax(p.extend({url:e,type:t,dataType:r,data:n,success:o},p.isPlainObject(e)&&e))}}),p._evalUrl=function(e){return p.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,throws:!0})},p.fn.extend({wrapAll:function(e){if(p.isFunction(e))return this.each(function(t){p(this).wrapAll(e.call(this,t))});if(this[0]){var t=p(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return p.isFunction(e)?this.each(function(t){p(this).wrapInner(e.call(this,t))}):this.each(function(){var t=p(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=p.isFunction(e);return this.each(function(n){p(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){p.nodeName(this,"body")||p(this).replaceWith(this.childNodes)}).end()}}),p.expr.filters.hidden=function(e){return d.reliableHiddenOffsets()?e.offsetWidth<=0&&e.offsetHeight<=0&&!e.getClientRects().length:function(e){if(!p.contains(e.ownerDocument||r,e))return!0;for(;e&&1===e.nodeType;){if("none"===zt(e)||"hidden"===e.type)return!0;e=e.parentNode}return!1}(e)},p.expr.filters.visible=function(e){return!p.expr.filters.hidden(e)};var Bt=/%20/g,Wt=/\[\]$/,Vt=/\r?\n/g,$t=/^(?:submit|button|image|reset|file)$/i,Xt=/^(?:input|select|textarea|keygen)/i;function Yt(e,t,n,o){var r;if(p.isArray(t))p.each(t,function(t,r){n||Wt.test(e)?o(e,r):Yt(e+"["+("object"==typeof r&&null!=r?t:"")+"]",r,n,o)});else if(n||"object"!==p.type(t))o(e,t);else for(r in t)Yt(e+"["+r+"]",t[r],n,o)}p.param=function(e,t){var n,o=[],r=function(e,t){t=p.isFunction(t)?t():null==t?"":t,o[o.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(void 0===t&&(t=p.ajaxSettings&&p.ajaxSettings.traditional),p.isArray(e)||e.jquery&&!p.isPlainObject(e))p.each(e,function(){r(this.name,this.value)});else for(n in e)Yt(n,e[n],t,r);return o.join("&").replace(Bt,"+")},p.fn.extend({serialize:function(){return p.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=p.prop(this,"elements");return e?p.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!p(this).is(":disabled")&&Xt.test(this.nodeName)&&!$t.test(e)&&(this.checked||!K.test(e))}).map(function(e,t){var n=p(this).val();return null==n?null:p.isArray(n)?p.map(n,function(e){return{name:t.name,value:e.replace(Vt,"\r\n")}}):{name:t.name,value:n.replace(Vt,"\r\n")}}).get()}}),p.ajaxSettings.xhr=void 0!==e.ActiveXObject?function(){return this.isLocal?en():r.documentMode>8?Qt():/^(get|post|head|put|delete|options)$/i.test(this.type)&&Qt()||en()}:Qt;var Kt=0,Gt={},Zt=p.ajaxSettings.xhr();function Qt(){try{return new e.XMLHttpRequest}catch(e){}}function en(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}e.attachEvent&&e.attachEvent("onunload",function(){for(var e in Gt)Gt[e](void 0,!0)}),d.cors=!!Zt&&"withCredentials"in Zt,(Zt=d.ajax=!!Zt)&&p.ajaxTransport(function(t){var n;if(!t.crossDomain||d.cors)return{send:function(o,r){var i,s=t.xhr(),a=++Kt;if(s.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(i in t.xhrFields)s[i]=t.xhrFields[i];for(i in t.mimeType&&s.overrideMimeType&&s.overrideMimeType(t.mimeType),t.crossDomain||o["X-Requested-With"]||(o["X-Requested-With"]="XMLHttpRequest"),o)void 0!==o[i]&&s.setRequestHeader(i,o[i]+"");s.send(t.hasContent&&t.data||null),n=function(e,o){var i,l,c;if(n&&(o||4===s.readyState))if(delete Gt[a],n=void 0,s.onreadystatechange=p.noop,o)4!==s.readyState&&s.abort();else{c={},i=s.status,"string"==typeof s.responseText&&(c.text=s.responseText);try{l=s.statusText}catch(e){l=""}i||!t.isLocal||t.crossDomain?1223===i&&(i=204):i=c.text?200:404}c&&r(i,l,c,s.getAllResponseHeaders())},t.async?4===s.readyState?e.setTimeout(n):s.onreadystatechange=Gt[a]=n:n()},abort:function(){n&&n(void 0,!0)}}}),p.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return p.globalEval(e),e}}}),p.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),p.ajaxTransport("script",function(e){if(e.crossDomain){var t,n=r.head||p("head")[0]||r.documentElement;return{send:function(o,i){(t=r.createElement("script")).async=!0,e.scriptCharset&&(t.charset=e.scriptCharset),t.src=e.url,t.onload=t.onreadystatechange=function(e,n){(n||!t.readyState||/loaded|complete/.test(t.readyState))&&(t.onload=t.onreadystatechange=null,t.parentNode&&t.parentNode.removeChild(t),t=null,n||i(200,"success"))},n.insertBefore(t,n.firstChild)},abort:function(){t&&t.onload(void 0,!0)}}}});var tn=[],nn=/(=)\?(?=&|$)|\?\?/;p.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=tn.pop()||p.expando+"_"+St++;return this[e]=!0,e}}),p.ajaxPrefilter("json jsonp",function(t,n,o){var r,i,s,a=!1!==t.jsonp&&(nn.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&nn.test(t.data)&&"data");return a||"jsonp"===t.dataTypes[0]?(r=t.jsonpCallback=p.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace(nn,"$1"+r):!1!==t.jsonp&&(t.url+=(Et.test(t.url)?"&":"?")+t.jsonp+"="+r),t.converters["script json"]=function(){return s||p.error(r+" was not called"),s[0]},t.dataTypes[0]="json",i=e[r],e[r]=function(){s=arguments},o.always(function(){void 0===i?p(e).removeProp(r):e[r]=i,t[r]&&(t.jsonpCallback=n.jsonpCallback,tn.push(r)),s&&p.isFunction(i)&&i(s[0]),s=i=void 0}),"script"):void 0}),p.parseHTML=function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||r;var o=T.exec(e),i=!n&&[];return o?[t.createElement(o[1])]:(o=le([e],t,i),i&&i.length&&p(i).remove(),p.merge([],o.childNodes))};var on=p.fn.load;function rn(e){return p.isWindow(e)?e:9===e.nodeType&&(e.defaultView||e.parentWindow)}p.fn.load=function(e,t,n){if("string"!=typeof e&&on)return on.apply(this,arguments);var o,r,i,s=this,a=e.indexOf(" ");return a>-1&&(o=p.trim(e.slice(a,e.length)),e=e.slice(0,a)),p.isFunction(t)?(n=t,t=void 0):t&&"object"==typeof t&&(r="POST"),s.length>0&&p.ajax({url:e,type:r||"GET",dataType:"html",data:t}).done(function(e){i=arguments,s.html(o?p("<div>").append(p.parseHTML(e)).find(o):e)}).always(n&&function(e,t){s.each(function(){n.apply(this,i||[e.responseText,t,e])})}),this},p.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){p.fn[t]=function(e){return this.on(t,e)}}),p.expr.filters.animated=function(e){return p.grep(p.timers,function(t){return e===t.elem}).length},p.offset={setOffset:function(e,t,n){var o,r,i,s,a,l,c=p.css(e,"position"),u=p(e),h={};"static"===c&&(e.style.position="relative"),a=u.offset(),i=p.css(e,"top"),l=p.css(e,"left"),("absolute"===c||"fixed"===c)&&p.inArray("auto",[i,l])>-1?(s=(o=u.position()).top,r=o.left):(s=parseFloat(i)||0,r=parseFloat(l)||0),p.isFunction(t)&&(t=t.call(e,n,p.extend({},a))),null!=t.top&&(h.top=t.top-a.top+s),null!=t.left&&(h.left=t.left-a.left+r),"using"in t?t.using.call(e,h):u.css(h)}},p.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){p.offset.setOffset(this,e,t)});var t,n,o={top:0,left:0},r=this[0],i=r&&r.ownerDocument;return i?(t=i.documentElement,p.contains(t,r)?(void 0!==r.getBoundingClientRect&&(o=r.getBoundingClientRect()),n=rn(i),{top:o.top+(n.pageYOffset||t.scrollTop)-(t.clientTop||0),left:o.left+(n.pageXOffset||t.scrollLeft)-(t.clientLeft||0)}):o):void 0},position:function(){if(this[0]){var e,t,n={top:0,left:0},o=this[0];return"fixed"===p.css(o,"position")?t=o.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),p.nodeName(e[0],"html")||(n=e.offset()),n.top+=p.css(e[0],"borderTopWidth",!0),n.left+=p.css(e[0],"borderLeftWidth",!0)),{top:t.top-n.top-p.css(o,"marginTop",!0),left:t.left-n.left-p.css(o,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent;e&&!p.nodeName(e,"html")&&"static"===p.css(e,"position");)e=e.offsetParent;return e||Fe})}}),p.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var n=/Y/.test(t);p.fn[e]=function(o){return Y(this,function(e,o,r){var i=rn(e);return void 0===r?i?t in i?i[t]:i.document.documentElement[o]:e[o]:void(i?i.scrollTo(n?p(i).scrollLeft():r,n?r:p(i).scrollTop()):e[o]=r)},e,o,arguments.length,null)}}),p.each(["top","left"],function(e,t){p.cssHooks[t]=Be(d.pixelPosition,function(e,n){return n?(n=Ue(e,t),Pe.test(n)?p(e).position()[t]+"px":n):void 0})}),p.each({Height:"height",Width:"width"},function(e,t){p.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,o){p.fn[o]=function(o,r){var i=arguments.length&&(n||"boolean"!=typeof o),s=n||(!0===o||!0===r?"margin":"border");return Y(this,function(t,n,o){var r;return p.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(r=t.documentElement,Math.max(t.body["scroll"+e],r["scroll"+e],t.body["offset"+e],r["offset"+e],r["client"+e])):void 0===o?p.css(t,n,s):p.style(t,n,o,s)},t,i?o:void 0,i,null)}})}),p.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,o){return this.on(t,e,n,o)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}}),p.fn.size=function(){return this.length},p.fn.andSelf=p.fn.addBack,"function"==typeof t&&t.amd&&t("jquery",[],function(){return p});var sn=e.jQuery,an=e.$;return p.noConflict=function(t){return e.$===p&&(e.$=an),t&&e.jQuery===p&&(e.jQuery=sn),p},n||(e.jQuery=e.$=p),p},"object"==typeof module&&"object"==typeof module.exports?module.exports=n.document?o(n,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return o(e)}:o(n),t("jqueryPlugins",["jquery"],function(t){t.fn.rotateCursorDown=function(){t("svg").animate({borderSpacing:-150,opacity:1},{step:function(e,n){"borderSpacing"==n.prop?t(this).css("-webkit-transform","rotate("+e+"deg)").css("-moz-transform","rotate("+e+"deg)").css("-ms-transform","rotate("+e+"deg)").css("-o-transform","rotate("+e+"deg)").css("transform","rotate("+e+"deg)"):t(this).css(n.prop,e)},duration:500},"linear").promise().then(function(){this.css("-webkit-transform",""),this.css("-moz-transform",""),this.css("-ms-transform",""),this.css("-o-transform",""),this.css("transform",""),this.css("opacity","")})},t.fn.rotateCursorDown=function(){t(".togetherjs-cursor svg").animate({borderSpacing:0,opacity:1},{step:function(e,n){"borderSpacing"==n.prop?t(this).css("-webkit-transform","rotate("+e+"deg)").css("-moz-transform","rotate("+e+"deg)").css("-ms-transform","rotate("+e+"deg)").css("-o-transform","rotate("+e+"deg)").css("transform","rotate("+e+"deg)"):t(this).css(n.prop,e)},duration:500},"linear").promise().then(function(){this.css("-webkit-transform",""),this.css("-moz-transform",""),this.css("-ms-transform",""),this.css("-o-transform",""),this.css("transform",""),this.css("opacity","")})},t.fn.popinWindow=function(){if(t.browser.mobile)this.css({left:"0px",opacity:1,zIndex:8888}),t("#togetherjs-window-pointer").css({left:"+=74px",opacity:1,zIndex:8888}),t("#togetherjs-window-pointer").animate({opacity:1,left:"-=78px"},{duration:60,easing:"linear"}),t("#togetherjs-window-pointer").queue(),t("#togetherjs-window-pointer").animate({left:"+=4px"},{duration:60,easing:"linear"}),this.animate({opacity:1,left:"0px"},{duration:60,easing:"linear"}),this.queue(),this.animate({left:"0px"},{duration:60,easing:"linear"});else{const n=e("ui").panelPosition(),o="right"==n,r=t("#togetherjs-window-pointer");if(o||"left"==n)this.css({left:o?"+=74px":"-=74px",opacity:1,zIndex:8888}),r.css({left:o?"+=74px":"-=74px",opacity:1,zIndex:8888}),r.animate({opacity:1,left:o?"-=78px":"+=78px"},{duration:60,easing:"linear"}),r.queue(),r.animate({left:o?"+=4px":"-=4px"},{duration:60,easing:"linear"}),this.animate({opacity:1,left:o?"-=78px":"+=78px"},{duration:60,easing:"linear"}),this.queue(),this.animate({left:o?"+=4px":"-=4px"},{duration:60,easing:"linear"});else{const e="bottom"==n;this.css({top:e?"+=74px":"-=74px",opacity:1,zIndex:8888}),r.css({top:e?"+=74px":"-=74px",opacity:1,zIndex:8888}),r.animate({opacity:1,top:e?"-=78px":"+=78px"},{duration:60,easing:"linear"}),r.queue(),r.animate({top:e?"+=4px":"-=4px"},{duration:60,easing:"linear"}),this.animate({opacity:1,top:e?"-=78px":"+=78px"},{duration:60,easing:"linear"}),this.queue(),this.animate({top:e?"+=4px":"-=4px"},{duration:60,easing:"linear"})}}},t.fn.slideIn=function(){return this.css({left:"+=74px",opacity:0,zIndex:8888}),this.animate({left:"-=74px",opacity:1,zIndex:9999},"fast")},t.fn.fadeOut=function(){return this.animate({borderSpacing:-90,opacity:.5},{step:function(e,n){"borderSpacing"==n.prop?t(this).css("-webkit-transform","perspective( 600px ) rotateX("+e+"deg)").css("-moz-transform","perspective( 600px ) rotateX("+e+"deg)").css("-ms-transform","perspective( 600px ) rotateX("+e+"deg)").css("-o-transform","perspective( 600px ) rotateX("+e+"deg)").css("transform","perspective( 600px ) rotateX("+e+"deg)"):t(this).css(n.prop,e)},duration:500},"linear").promise().then(function(){this.css("-webkit-transform",""),this.css("-moz-transform",""),this.css("-ms-transform",""),this.css("-o-transform",""),this.css("transform",""),this.css("opacity","")}),this},t.fn.easeTo=function(e){return this.animate({scrollTop:e},{duration:400,easing:"swing"})},t.fn.animateDockEntry=function(){var e=this.height(),t=this.width(),n=e+4,o=parseInt(this.css("marginLeft"),10);this.css({marginLeft:o+t/2,height:0,width:0,backgroundSize:"0 0"});var r=this;return this.animate({marginLeft:o,height:e,width:t,backgroundSize:n},{duration:600}).promise().then(function(){r.css({marginLeft:"",height:"",width:"",backgroundSize:""})}),this},t.fn.animateDockExit=function(){this.height();var e=this.width(),t=parseInt(this.css("marginLeft"),10);return this.animate({marginLeft:t+e/2,height:0,width:0,backgroundSize:"0 0",opacity:0},600),this},t.fn.animateCursorEntry=function(){},t.fn.animateKeyboard=function(){var e=this.find(".togetherjs-typing-ellipse-one"),t=this.find(".togetherjs-typing-ellipse-two"),n=this.find(".togetherjs-typing-ellipse-three"),o=-1,r=function(){0===(o=(o+1)%4)?(e.css("opacity",.5),t.css("opacity",.5),n.css("opacity",.5)):1==o?e.css("opacity",1):2==o?t.css("opacity",1):n.css("opacity",1)}.bind(this);r();var i=setInterval(r,300);this.data("animateKeyboard",i)},t.fn.stopKeyboardAnimation=function(){clearTimeout(this.data("animateKeyboard")),this.data("animateKeyboard",null)},t.browser||(t.browser={}),t.browser.mobile=void 0!==window.orientation,-1!=navigator.userAgent.search(/mobile/i)&&(t.browser.mobile=!0),t.browser.mobile&&window.matchMedia&&!window.matchMedia("screen and (max-screen-width: 480px)").matches&&(document.body.className+=" togetherjs-mobile-browser")}),t("util",["jquery","jqueryPlugins"],function(e){var t={};return t.Deferred=e.Deferred,TogetherJS.$=e,t.Class=function(e,t){var n;if(void 0===t)t=e;else{e.prototype&&(e=e.prototype);var o=Object.create(e);for(n in t)t.hasOwnProperty(n)&&(o[n]=t[n]);t=o}var r=function(){var e=Object.create(t);return e.constructor.apply(e,arguments),e.constructor=r,e};if(r.prototype=t,t.constructor.name&&(r.className=t.constructor.name,r.toString=function(){return"[Class "+this.className+"]"}),t.classMethods)for(n in t.classMethods)t.classMethods.hasOwnProperty(n)&&(r[n]=t.classMethods[n]);return r},t.extend=TogetherJS._extend,t.forEachAttr=function(e,t,n){for(var o in n=n||e,e)e.hasOwnProperty(o)&&t.call(n,e[o],o)},t.trim=function(e){return e.replace(/^\s+/,"").replace(/\s+$/,"")},t.safeClassName=function(e){return e.replace(/[^a-zA-Z0-9_\-]/g,"_")||"class"},t.AssertionError=function(e){if(!this instanceof t.AssertionError)return new t.AssertionError(e);this.message=e,this.name="AssertionError"},t.AssertionError.prototype=Error.prototype,t.assert=function(e){if(!e){var n=["Assertion error:"].concat(Array.prototype.slice.call(arguments,1));throw console.error.apply(console,n),console.trace&&console.trace(),new t.AssertionError(n.join(" "))}},t.generateId=function(e){e=e||10;for(var t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUV0123456789",n="",o=0;o<e;o++)n+=t.charAt(Math.floor(Math.random()*t.length));return n},t.pickRandom=function(e){return e[Math.floor(Math.random()*e.length)]},t.mixinEvents=TogetherJS._mixinEvents,t.Module=t.Class({constructor:function(e){this._name=e},toString:function(){return"[Module "+this._name+"]"}}),t.blobToBase64=function(e){for(var t="",n=new Uint8Array(e),o=n.byteLength,r=0;r<o;r++)t+=String.fromCharCode(n[r]);return btoa(t)},t.truncateCommonDomain=function(e,t){if(!t)return e;var n=/^https?:\/\/[^\/]*/i,o=n.exec(e),r=n.exec(t);return o&&r&&o[0]==r[0]?e.substr(o[0].length):e},t.makeUrlAbsolute=function(e,n){if(0===e.search(/^(http|https|ws|wss):/i))return e;if(0===e.search(/^\/\/[^\/]/)){var o=/^(http|https|ws|wss):/i.exec(n);return t.assert(o,"No scheme on base URL",n),o[1]+":"+e}if(0===e.search(/^\//)){var r=/^(http|https|ws|wss):\/\/[^\/]+/i.exec(n);return t.assert(r,"No scheme/domain on base URL",n),r[0]+e}var i=/[^\/]+$/.exec(n);return t.assert(i,"Does not appear to be a URL?",n),n.substr(0,i.index)+e},t.assertValidUrl=function(e){t.assert("string"==typeof e,"URLs must be a string:",e),t.assert(0===e.search(/^(http:\/\/|https:\/\/|\/\/|data:)/i),"URL must have an http, https, data, or // scheme:",e),t.assert(-1===e.search(/[\)\'\"\ ]/),"URLs cannot contain ), ', \", or spaces:",JSON.stringify(e))},t.resolver=function(e,n){return t.assert(e.then,"Bad deferred:",e),t.assert("function"==typeof n,"Not a function:",n),function(){var t;try{t=n.apply(this,arguments)}catch(t){throw e.reject(t),t}return t&&t.then?t.then(function(){e.resolveWith(this,arguments)},function(){e.rejectWith(this,arguments)}):void 0===t?e.resolve():e.resolve(t),t}},t.isPromise=function(e){return"object"==typeof e&&e.then},t.makePromise=function(n){return t.isPromise(n)?n:e.Deferred(function(e){e.resolve(n)})},t.resolveMany=function(){var e,n=!1;return 1==arguments.length&&Array.isArray(arguments[0])?(n=!0,e=arguments[0]):e=Array.prototype.slice.call(arguments),t.Deferred(function(t){var o=e.length;if(o){var r=[],i=!1;e.forEach(function(e,t){e.then(function(e){r[t]=e,o--,s()},function(e){r[t]=e,i=!0,o--,s()})})}else t.resolve();function s(){o||(i?n?t.reject(r):t.reject.apply(t,r):n?t.resolve(r):t.resolve.apply(t,r))}})},t.readFileImage=function(e){return t.Deferred(function(n){var o=new FileReader;o.onload=function(){n.resolve("data:image/jpeg;base64,"+t.blobToBase64(this.result))},o.onerror=function(){n.reject(this.error)},o.readAsArrayBuffer(e.files[0])})},t.matchElement=function(t,n){if(!0===n||!n)return!!n;try{return e(t).is(n)}catch(e){return console.warn("Bad selector:",n,"error:",e),!1}},t.testExpose=function(e){"undefined"!=typeof TogetherJSTestSpy&&t.forEachAttr(e,function(e,t){TogetherJSTestSpy[t]=e})},t}),t("analytics",["util"],function(e){var t=e.Module("analytics");return t.activate=function(){var e=TogetherJS.config.get("enableAnalytics"),t=TogetherJS.config.get("analyticsCode");if(TogetherJS.config.close("enableAnalytics"),TogetherJS.config.close("analyticsCode"),e&&t){var n=window._gaq||[];n.push(["_setAccount",t]),n.push(["_setDomainName",location.hostname]),n.push(["_trackPageview"]),window._gaq=n,function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()}},t}),t("channels",["util"],function(e){var t=e.Module("channels"),n=e.mixinEvents({onmessage:null,rawdata:!1,onclose:null,closed:!1,baseConstructor:function(){this._buffer=[],this._setupConnection()},send:function(e){if(this.closed)throw"Cannot send to a closed connection";"string"!=typeof e&&(e=JSON.stringify(e)),this._ready()?this._send(e):this._buffer.push(e)},_flush:function(){for(var e=0;e<this._buffer.length;e++)this._send(this._buffer[e]);this._buffer=[]},_incoming:function(e){if(!this.rawdata)try{e=JSON.parse(e)}catch(t){throw console.error("Got invalid JSON data:",e.substr(0,40)),t}this.onmessage&&this.onmessage(e),this.emit("message",e)}});t.WebSocketChannel=e.Class(n,{constructor:function(e){0===e.search(/^https?:/i)&&(e=e.replace(/^http/i,"ws")),this.address=e,this.socket=null,this._reopening=!1,this._lastConnectTime=0,this._backoff=0,this.baseConstructor()},backoffTime:50,maxBackoffTime:1500,backoffDetection:2e3,toString:function(){var e="[WebSocketChannel to "+this.address;return this.socket?e+=" readyState: "+this.socket.readyState:e+=" (socket unopened)",this.closed&&(e+=" CLOSED"),e+"]"},close:function(){this.closed=!0,this.socket?this.socket.close():(this.onclose&&this.onclose(),this.emit("close"))},_send:function(e){this.socket.send(e)},_ready:function(){return this.socket&&this.socket.readyState==this.socket.OPEN},_setupConnection:function(){this.closed||(this._lastConnectTime=Date.now(),this.socket=new WebSocket(this.address),this.socket.onopen=function(){this._flush(),this._reopening=!1}.bind(this),this.socket.onclose=function(e){this.socket=null;var t="error";if(e.wasClean&&(t="log"),console[t]("WebSocket close",e.wasClean?"clean":"unclean","code:",e.code,"reason:",e.reason||"none"),!this.closed){this._reopening=!0,Date.now()-this._lastConnectTime>this.backoffDetection?this._backoff=0:this._backoff++;var n=Math.min(this._backoff*this.backoffTime,this.maxBackoffTime);setTimeout(function(){this._setupConnection()}.bind(this),n)}}.bind(this),this.socket.onmessage=function(e){this._incoming(e.data)}.bind(this),this.socket.onerror=function(e){console.error("WebSocket error:",e.data)}.bind(this))}}),t.PostMessageChannel=e.Class(n,{_pingPollPeriod:100,_pingPollIncrease:100,_pingMax:2e3,constructor:function(e,t){this.expectedOrigin=t,this._pingReceived=!1,this._receiveMessage=this._receiveMessage.bind(this),e&&this.bindWindow(e,!0),this._pingFailures=0,this.baseConstructor()},toString:function(){var e="[PostMessageChannel";return this.window?e+=" to window "+this.window:e+=" not bound to a window",this.window&&!this._pingReceived&&(e+=" still establishing"),e+"]"},bindWindow:function(e,t){this.window&&(this.close(),this.closed=!1),e&&e.contentWindow&&(e=e.contentWindow),this.window=e;var n=this.window;"undefined"!=typeof window&&(n=window),n.addEventListener("message",this._receiveMessage,!1),t||this._setupConnection()},_send:function(e){this.window.postMessage(e,this.expectedOrigin||"*")},_ready:function(){return this.window&&this._pingReceived},_setupConnection:function(){if(!this.closed&&!this._pingReceived&&this.window){this._pingFailures++,this._send("hello");var e=this._pingPollPeriod+this._pingPollIncrease*this._pingFailures;e=e>this._pingPollMax?this._pingPollMax:e,this._pingTimeout=setTimeout(this._setupConnection.bind(this),e)}},_receiveMessage:function(e){if(e.source===this.window)if(this.expectedOrigin&&e.origin!=this.expectedOrigin)console.info("Expected message from",this.expectedOrigin,"but got message from",e.origin);else{if(this.expectedOrigin||(this.expectedOrigin=e.origin),"hello"==e.data)return this._pingReceived=!0,this._pingTimeout&&(clearTimeout(this._pingTimeout),this._pingTimeout=null),void this._flush();this._incoming(e.data)}},close:function(){this.closed=!0,this._pingReceived=!1,this._pingTimeout&&clearTimeout(this._pingTimeout),window.removeEventListener("message",this._receiveMessage,!1),this.onclose&&this.onclose(),this.emit("close")}}),t.PostMessageIncomingChannel=e.Class(n,{constructor:function(e){this.source=null,this.expectedOrigin=e,this._receiveMessage=this._receiveMessage.bind(this),window.addEventListener("message",this._receiveMessage,!1),this.baseConstructor()},toString:function(){var e="[PostMessageIncomingChannel";return this.source?e+=" bound to source "+e:e+=" awaiting source",e+"]"},_send:function(e){this.source.postMessage(e,this.expectedOrigin)},_ready:function(){return!!this.source},_setupConnection:function(){},_receiveMessage:function(e){this.expectedOrigin&&"*"!=this.expectedOrigin&&e.origin!=this.expectedOrigin?console.info("Expected message from",this.expectedOrigin,"but got message from",e.origin):(this.expectedOrigin||(this.expectedOrigin=e.origin),this.source||(this.source=e.source),"hello"!=e.data?this._incoming(e.data):this.source.postMessage("hello",this.expectedOrigin))},close:function(){this.closed=!0,window.removeEventListener("message",this._receiveMessage,!1),this._pingTimeout&&clearTimeout(this._pingTimeout),this.onclose&&this.onclose(),this.emit("close")}}),t.Router=e.Class(e.mixinEvents({constructor:function(e){this._channelMessage=this._channelMessage.bind(this),this._channelClosed=this._channelClosed.bind(this),this._routes=Object.create(null),e&&this.bindChannel(e)},bindChannel:function(e){this.channel&&(this.channel.removeListener("message",this._channelMessage),this.channel.removeListener("close",this._channelClosed)),this.channel=e,this.channel.on("message",this._channelMessage.bind(this)),this.channel.on("close",this._channelClosed.bind(this))},_channelMessage:function(e){if("route"==e.type){var t=e.routeId,n=this._routes[t];if(!n)return void console.warn("No route with the id",t);e.close?this._closeRoute(n.id):(n.onmessage&&n.onmessage(e.message),n.emit("message",e.message))}},_channelClosed:function(){for(var e in this._routes)this._closeRoute(e)},_closeRoute:function(e){var t=this._routes[e];t.onclose&&t.onclose(),t.emit("close"),delete this._routes[e]},makeRoute:function(t){t=t||e.generateId();var n=o(this,t);return this._routes[t]=n,n}}));var o=e.Class(e.mixinEvents({constructor:function(e,t){this.router=e,this.id=t},send:function(e){this.router.channel.send({type:"route",routeId:this.id,message:e})},close:function(){this.router._routes[this.id]===this&&delete this.router._routes[this.id]}}));return t}),t("storage",["util"],function(e){var t=e.assert,n=e.Deferred,o=e.Class({constructor:function(e,t,n){this.name=e,this.storage=t,this.prefix=n},get:function(t,o){var r=this;return n(function(n){setTimeout(e.resolver(n,function(){t=r.prefix+t;var e=r.storage.getItem(t);return e=e?JSON.parse(e):o}))})},set:function(e,t){var o=this;return void 0!==t&&(t=JSON.stringify(t)),n(function(n){e=o.prefix+e,void 0===t?o.storage.removeItem(e):o.storage.setItem(e,t),setTimeout(n.resolve)})},clear:function(){var t=this,o=[];return n(function(n){this.keys().then(function(r){r.forEach(function(e){o.push(t.set(e,void 0))}),e.resolveMany(o).then(function(){n.resolve()})})}.bind(this))},keys:function(t,o){var r=this;return n(function(n){setTimeout(e.resolver(n,function(){t=t||"";for(var e=[],n=0;n<r.storage.length;n++){var i=r.storage.key(n);if(0===i.indexOf(r.prefix+t)){var s=i.substr(r.prefix.length);o&&(s=s.substr(t.length)),e.push(s)}}return e}))})},toString:function(){return"[storage for "+this.name+"]"}}),r=TogetherJS.config.get("storagePrefix");TogetherJS.config.close("storagePrefix");var i=o("localStorage",localStorage,r+".");return i.settings=e.mixinEvents({defaults:{dockConfig:null,name:"",defaultName:"",avatar:null,stickyShare:null,color:null,seenIntroDialog:!1,seenWalkthrough:!1,dontShowRtcInfo:!1},get:function(e){return t(i.settings.defaults.hasOwnProperty(e),"Unknown setting:",e),i.get("settings."+e,i.settings.defaults[e])},set:function(e,n){return t(i.settings.defaults.hasOwnProperty(e),"Unknown setting:",e),i.set("settings."+e,n)}}),i.tab=o("sessionStorage",sessionStorage,r+"-session."),i}),t("session",["require","util","channels","jquery","storage"],function(e,t,n,o,r){var i,s=!1,a=t.mixinEvents(t.Module("session")),l=t.assert;a.shareId=null,a.clientId=null,a.router=n.Router(),a.firstRun=!1;var c=null;a.AVATAR_SIZE=90;var u=TogetherJS.config.get("includeHashInUrl");TogetherJS.config.close("includeHashInUrl");var h=(location.href+"").replace(/\#.*$/,"");u&&(h=location.href),a.hubUrl=function(e){return e=e||a.shareId,l(e,"URL cannot be resolved before TogetherJS.shareId has been initialized"),TogetherJS.config.close("hubBase"),TogetherJS.config.get("hubBase").replace(/\/*$/,"")+"/hub/"+e},a.shareUrl=function(){l(a.shareId,"Attempted to access shareUrl() before shareId is set");var e=location.hash,t=/\?[^#]*/.exec(location.href),n="";return t&&(n=t[0]),e=(e=e.replace(/&?togetherjs-[a-zA-Z0-9]+/,""))||"#",location.protocol+"//"+location.host+location.pathname+n+e+"&togetherjs="+a.shareId},a.recordUrl=function(){l(a.shareId);var e=TogetherJS.baseUrl.replace(/\/*$/,"")+"/togetherjs/recorder.html";return e+="#&togetherjs="+a.shareId+"&hubBase="+TogetherJS.config.get("hubBase")},a.currentUrl=function(){return u?location.href:location.href.replace(/#.*/,"")},a.hub=t.mixinEvents({});var d=TogetherJS.config.get("ignoreMessages");!0===d&&(s=!1,d=[]);var f=["who","invite","init-connection"],p=!1;function g(e){var t=a.makeHelloMessage(e);e||(a.timeHelloSent=Date.now(),i.Self.url=t.url),a.send(t)}a.send=function(e){s&&-1==d.indexOf(e.type)&&console.info("Send:",e),e.clientId=a.clientId,c.send(e)},a.appSend=function(e){var t=e.type;0===t.search(/^togetherjs\./)?t=t.substr("togetherjs.".length):-1===t.search(/^app\./)&&(t="app."+t),e.type=t,a.send(e)},a.hub.on("hello hello-back",function(t){"hello"==t.type&&g(!0),a.isClient&&!t.isClient&&a.firstRun&&a.timeHelloSent&&Date.now()-a.timeHelloSent<1500&&function(t){if(!t.sameUrl){var n=t.url;t.urlHash&&(n+=t.urlHash),e("ui").showUrlChangeMessage(t.peer,n),location.href=n}}(t)}),a.hub.on("who",function(e){g(!0)}),a.timeHelloSent=null,a.makeHelloMessage=function(e){var t={name:i.Self.name||i.Self.defaultName,avatar:i.Self.avatar,color:i.Self.color,url:a.currentUrl(),urlHash:location.hash,title:document.title,rtcSupported:a.RTCSupported,isClient:a.isClient};return e?t.type="hello-back":(t.type="hello",t.clientVersion=TogetherJS.version),TogetherJS.startup.continued||(t.starting=!0),a.emit("prepare-hello",t),t};var m=["peers","ui","chat","webrtc","cursor","startup","videos","forms","visibilityApi","youtubeVideos"];function v(){return t.Deferred(function(e){a.identityId?e.resolve():r.get("identityId").then(function(n){n||(n=t.generateId(),r.set("identityId",n)),a.identityId=n,e.resolve()})})}function y(){return t.Deferred(function(e){var n,i,s=location.hash,c=a.shareId,u=!0,h=!0;if(a.firstRun=!TogetherJS.startup.continued,c||TogetherJS.startup._joinShareId&&(c=TogetherJS.startup._joinShareId),!c){var d=/&?togetherjs=([^&]*)/.exec(s);if(d){u=!d[1],c=d[2];var f=s.substr(0,d.index)+s.substr(d.index+d[0].length);location.hash=f}}return r.tab.get("status").then(function(s){var d=TogetherJS.config.get("findRoom");if(TogetherJS.config.close("findRoom"),d&&s&&d!=s.shareId?console.info("Ignoring findRoom in lieu of continued session"):d&&TogetherJS.startup._joinShareId&&console.info("Ignoring findRoom in lieu of explicit invite to session"),!d||"string"!=typeof d||s||TogetherJS.startup._joinShareId){if(d&&!s&&!TogetherJS.startup._joinShareId)return l(d.prefix&&"string"==typeof d.prefix,"Bad findRoom.prefix",d),l(d.max&&"number"==typeof d.max&&d.max>0,"Bad findRoom.max",d),n=t.generateId(),-1!=d.prefix.search(/[^a-zA-Z0-9]/)&&console.warn("Bad value for findRoom.prefix:",JSON.stringify(d.prefix)),void function(e,t){var n=TogetherJS.config.get("hubBase").replace(/\/*$/,"")+"/findroom";return o.ajax({url:n,dataType:"json",data:{prefix:e,max:t}}).then(function(e){return e.name})}(d.prefix,d.max).then(function(t){a.clientId=a.identityId+"."+n,r.tab.set("status",{reason:"joined",shareId:t,running:!0,date:Date.now(),sessionId:n}),a.isClient=!0,a.shareId=t,a.emit("shareId"),e.resolve(a.shareId)});if(TogetherJS.startup._launch)s?(i=r.tab.prefix+"isClient",u=JSON.parse(r.tab.storage[i]),c||(c=s.shareId),n=s.sessionId):(u="joined"==TogetherJS.startup.reason,l(!n),n=t.generateId()),c||(c=t.generateId());else{if(!s)throw new t.AssertionError("No saved status, and no startup._launch request; why did TogetherJS start?");u="joined"==s.reason,TogetherJS.startup.reason=s.reason,TogetherJS.startup.continued=!0,c=s.shareId,n=s.sessionId,h=!s.running}}else u=!0,c=d,n=t.generateId();l(a.identityId),a.clientId=a.identityId+"."+n,h&&r.tab.set("status",{reason:TogetherJS.startup.reason,shareId:c,running:!0,date:Date.now(),sessionId:n}),a.isClient=u,a.shareId=c,a.emit("shareId"),e.resolve(a.shareId)})})}function b(){g(!1)}function w(){a.emit("resize")}return v.done=v(),a.start=function(){var t;TogetherJS.startup.button?(t=TogetherJS.startup.button.id)&&r.set("startTarget",t):r.get("startTarget").then(function(e){var t=document.getElementById(e);t&&(TogetherJS.startup.button=t)}),v().then(function(){y().then(function(){p=!1,function(){l(!c,"Attempt to re-open channel"),console.info("Connecting to",a.hubUrl(),location.href);var e=n.WebSocketChannel(a.hubUrl());e.onmessage=function(e){if(p)if(s&&-1==d.indexOf(e.type)&&console.info("In:",e),i)if(e.clientId||-1!=f.indexOf(e.type)){if(e.clientId&&(e.peer=i.getPeer(e.clientId,e)),"hello"==e.type||"hello-back"==e.type||"peer-update"==e.type)try{e.peer.updateFromHello(e)}catch(e){console.warn(e)}e.peer&&(e.sameUrl=e.peer.url==h,e.peer.isSelf||e.peer.updateMessageDate(e)),a.hub.emit(e.type,e),TogetherJS._onmessage(e)}else console.warn("Got message without clientId, where clientId is required",e);else console.warn("Message received before all modules loaded (ignoring):",e);else s&&console.info("In (but ignored for being early):",e)},c=e,a.router.bindChannel(c)}(),e(["ui"],function(t){TogetherJS.running=!0,t.prepareUI(),e(m,function(){o(function(){i=e("peers");var n=e("startup");a.emit("start"),a.once("ui-ready",function(){p=!0,n.start()}),t.activateUI(),TogetherJS.config.close("enableAnalytics"),TogetherJS.config.get("enableAnalytics")&&e(["analytics"],function(e){e.activate()}),i._SelfLoaded.then(function(){g(!1)}),TogetherJS.emit("ready")})})})})})},a.close=function(e){TogetherJS.running=!1;var t={type:"bye"};e&&(t.reason=e),a.send(t),a.emit("close");var n=window.name;r.tab.get("status").then(function(e){e?(e.running=!1,e.date=Date.now(),r.tab.set("status",e)):console.warn("No session information saved in","status."+n),c.close(),c=null,a.shareId=null,a.emit("shareId"),TogetherJS.emit("close"),TogetherJS._teardown()})},a.on("start",function(){o(window).on("resize",w),u&&o(window).on("hashchange",b),r.tab.get("isClient").then(function(e){void 0===e&&r.tab.set("isClient",a.isClient)})}),a.on("close",function(){o(window).off("resize",w),u&&o(window).off("hashchange",b)}),TogetherJS.startup._launch&&setTimeout(a.start),t.testExpose({getChannel:function(){return c}}),a}),t("templates",["util"],function(e){function t(t){return t=t.replace(/[<][%]\s*\/\*[\S\s\r\n]*\*\/\s*[%][>]/,""),t=(t=e.trim(t)).replace(/http:\/\/localhost:8080/g,TogetherJS.baseUrl)}return{interface:t('<% /*\n   This is basically all the markup and interface for TogetherJS.\n   Note all links should be like http://localhost:8080/togetherjs/*\n   these links are rewritten with the location where TogetherJS was deployed.\n\n   This file is inlined into togetherjs/templates.js\n*/ %>\n<div id="togetherjs-container" class="togetherjs">\n\n  \x3c!-- This is the main set of buttons: --\x3e\n  <div id="togetherjs-dock" class="togetherjs-dock-right">\n    <div id="togetherjs-dock-anchor" title="Move the dock">\n      <span id="togetherjs-dock-anchor-horizontal">\n        <img src="http://localhost:8080/togetherjs/images/icn-handle-circle@2x.png" alt="drag">\n      </span>\n      <span id="togetherjs-dock-anchor-vertical">\n        <img src="http://localhost:8080/togetherjs/images/icn-handle-circle@2x.png" alt="drag">\n      </span>\n    </div>\n    <div id="togetherjs-buttons">\n      <div style="display: none">\n        <button id="togetherjs-template-dock-person" class="togetherjs-button togetherjs-dock-person">\n          <div class="togetherjs-tooltip togetherjs-dock-person-tooltip">\n            <span class="togetherjs-person-name"></span>\n            <span class="togetherjs-person-tooltip-arrow-r"></span>\n          </div>\n          <div class="togetherjs-person togetherjs-person-status-overlay"></div>\n        </button>\n      </div>\n      <button id="togetherjs-profile-button" class="togetherjs-button" title="This is you">\n        <div class="togetherjs-person togetherjs-person-self"></div>\n        <div id="togetherjs-profile-arrow"></div>\n      </button>\n      <button id="togetherjs-share-button" class="togetherjs-button" title="Add a friend"></button>\n      <button id="togetherjs-audio-button" class="togetherjs-button" title="Turn on microphone">\n        <span id="togetherjs-audio-unavailable" class="togetherjs-audio-set" data-toggles=".togetherjs-audio-set">\n        </span>\n        <span id="togetherjs-audio-ready" class="togetherjs-audio-set" data-toggles=".togetherjs-audio-set" style="display: none">\n        </span>\n        <span id="togetherjs-audio-outgoing" class="togetherjs-audio-set" data-toggles=".togetherjs-audio-set" style="display: none">\n        </span>\n        <span id="togetherjs-audio-incoming" class="togetherjs-audio-set" data-toggles=".togetherjs-audio-set" style="display: none">\n        </span>\n        <span id="togetherjs-audio-active" class="togetherjs-audio-set" data-toggles=".togetherjs-audio-set" style="display: none">\n        </span>\n        <span id="togetherjs-audio-muted" class="togetherjs-audio-set" data-toggles=".togetherjs-audio-set" style="display: none">\n        </span>\n        <span id="togetherjs-audio-error" class="togetherjs-audio-set" data-toggles=".togetherjs-audio-set" style="display: none">\n        </span>\n      </button>\n      <button id="togetherjs-chat-button" class="togetherjs-button" title="Chat"></button>\n      <div id="togetherjs-dock-participants"></div>\n    </div>\n  </div>\n\n  \x3c!-- The window for editing the avatar: --\x3e\n  <div id="togetherjs-avatar-edit" class="togetherjs-modal"\n       style="display: none">\n    <header> Update avatar </header>\n    <section>\n      <div class="togetherjs-avatar-preview togetherjs-person togetherjs-person-self"></div>\n      <div id="togetherjs-avatar-buttons">\n        <input type="file" class="togetherjs-upload-avatar">\n        \x3c!--<button id="togetherjs-upload-avatar" class="togetherjs-primary">Upload a picture</button>--\x3e\n        \x3c!--<button id="togetherjs-camera-avatar" class="togetherjs-default">Take a picture</button>--\x3e\n      </div>\n    </section>\n    <section class="togetherjs-buttons">\n      <button class="togetherjs-cancel togetherjs-dismiss">Cancel</button>\n      <span class="togetherjs-alt-text">or</span>\n      <button class="togetherjs-avatar-save togetherjs-primary">Save</button>\n    </section>\n  </div>\n\n  \x3c!-- The window for sharing the link: --\x3e\n  <div id="togetherjs-share" class="togetherjs-window"\n       data-bind-to="#togetherjs-share-button" style="display: none">\n    <header> Invite a friend </header>\n    <section>\n      <div class="togetherjs-not-mobile">\n        <p>Copy and paste this link over IM or email:</p>\n        <input type="text" class="togetherjs-share-link">\n      </div>\n      <div class="togetherjs-only-mobile">\n        <p>Copy and paste this link over IM or email:</p>\n        <input type="text" class="togetherjs-share-link">\n        \x3c!-- <a class="togetherjs-share-link" href="#">Press your thumb here.</a> --\x3e\n      </div>\n    </section>\n  </div>\n\n  \x3c!-- Participant Full List view template: --\x3e\n  <div id="togetherjs-participantlist" class="togetherjs-window"\n       data-bind-to="#togetherjs-participantlist-button" style="display: none">\n    <header> Participants </header>\n    <section>\n      <div class="togetherjs-not-mobile">\n        <ul>\n          <li id="togetherjs-participant-item">\n            <img class="togetherjs-person togetherjs-person-small" src="http://localhost:8080/togetherjs/images/btn-menu-change-avatar.png">\n            <span class="tj-name togetherjs-person-name">Useronewith alongname</span>\n            <span class="tj-status">&#9679;</span>\n            <p class="tj-urllocation">Currently at: <a class="togetherjs-person-url togetherjs-person-url-title" href="">http://www.location.comwww.location.comwww.location.comasdfsafd</a></p>\n            <p class="tj-follow">Follow:\n              <label class="togetherjs-follow-question" for="togetherjs-person-status-follow">\n                <input type="checkbox" id="togetherjs-person-status-follow">\n              </label>\n            </p>\n            <section class="togetherjs-buttons">\n              \x3c!-- Displayed when the peer is at a different URL: --\x3e\n              <div class="togetherjs-different-url">\n                <a class="togetherjs-nudge togetherjs-default tj-btn-sm">Nudge them</a>\n                <a href="#" class="togetherjs-follow togetherjs-person-url togetherjs-primary tj-btn-sm">Join them</a>\n              </div>\n              \x3c!-- Displayed when the peer is at your same URL: --\x3e\n              <div class="togetherjs-same-url" style="display: none">\n                <span class="togetherjs-person-name"></span> is on the same page as you.\n              </div>\n            </section>\n          </li>\n        </ul>\n    </section>\n  </div>\n\n  \x3c!-- Participant detail template: --\x3e\n  <div id="togetherjs-template-participant-window" class="togetherjs-window" style="display: none">\n    <header><div class="togetherjs-person togetherjs-person-small"></div><span class="togetherjs-person-name"></span></header>\n\n    <section class="togetherjs-participant-window-main">\n      <p class="togetherjs-participant-window-row"><strong>Role:</strong>\n        <span class="togetherjs-person-role"></span>\n      </p>\n\n      <p class="togetherjs-participant-window-row"><strong>Currently at:</strong>\n        <a class="togetherjs-person-url togetherjs-person-url-title"></a>\n      </p>\n\n      <p class="togetherjs-participant-window-row"><strong>Status:</strong>\n        <span class="togetherjs-person-status"></span>\n      </p>\n\n      <p class="togetherjs-participant-window-row"><strong class="togetherjs-float-left">Follow this participant:</strong>\n        <label class="togetherjs-follow-question togetherjs-float-left" for="togetherjs-person-status-follow">\n          <input type="checkbox" id="togetherjs-person-status-follow">\n        </label>\n        <span class="togetherjs-clear"></span>\n      </p>\n\n    </section>\n\n    <section class="togetherjs-buttons">\n      \x3c!-- Displayed when the peer is at a different URL: --\x3e\n      <div class="togetherjs-different-url">\n        <a class="togetherjs-nudge togetherjs-default">Nudge them</a>\n        <a href="#" class="togetherjs-follow togetherjs-person-url togetherjs-primary">Join them</a>\n      </div>\n      \x3c!-- Displayed when the peer is at your same URL: --\x3e\n      <div class="togetherjs-same-url" style="display: none">\n        <span class="togetherjs-person-name"></span> is on the same page as you.\n      </div>\n    </section>\n  </div>\n\n  \x3c!-- The chat screen: --\x3e\n  <div id="togetherjs-chat" class="togetherjs-window" data-bind-to="#togetherjs-chat-button"\n       style="display: none">\n    <header> Chat </header>\n    <section class="togetherjs-subtitle">\n      <div id="togetherjs-chat-participants" data-toggles="#togetherjs-chat-no-participants" style="display: none">\n        <span id="togetherjs-chat-participant-list"></span>\n        &amp; You\n      </div>\n      <div id="togetherjs-chat-no-participants" data-toggles="#togetherjs-chat-participants">\n        No one else is here.\n      </div>\n    </section>\n\n    <div style="display: none">\n\n      \x3c!-- Template for one message: --\x3e\n      <div id="togetherjs-template-chat-message" class="togetherjs-chat-item togetherjs-chat-message">\n        <div class="togetherjs-person"></div>\n        <div class="togetherjs-timestamp"><span class="togetherjs-time">HH:MM</span> <span class="togetherjs-ampm">AM/PM</span></div>\n        <div class="togetherjs-person-name-abbrev"></div>\n        <div class="togetherjs-chat-content togetherjs-sub-content"></div>\n      </div>\n\n      \x3c!-- Template for when a person leaves: --\x3e\n      <div id="togetherjs-template-chat-left" class="togetherjs-chat-item togetherjs-chat-left-item">\n        <div class="togetherjs-person"></div>\n        <div class="togetherjs-ifnot-declinedJoin">\n          <div class="togetherjs-inline-text"><span class="togetherjs-person-name"></span> left the session.</div>\n        </div>\n        <div class="togetherjs-if-declinedJoin">\n          <div class="togetherjs-inline-text"><span class="togetherjs-person-name"></span> declined to join the session.</div>\n        </div>\n        <div class="togetherjs-clear"></div>\n      </div>\n\n      \x3c!-- Template when a person joins the session: --\x3e\n      <div id="togetherjs-template-chat-joined" class="togetherjs-chat-item togetherjs-chat-join-item">\n        <div class="togetherjs-person"></div>\n        <div class="togetherjs-inline-text"><span class="togetherjs-person-name"></span> joined the session.</div>\n        <div class="togetherjs-clear"></div>\n      </div>\n\n      \x3c!-- Template for system-derived messages: --\x3e\n      <div id="togetherjs-template-chat-system" class="togetherjs-chat-item">\n        <span class="togetherjs-chat-content togetherjs-sub-content"></span>\n      </div>\n\n      \x3c!-- Template when a person joins the session: --\x3e\n      \x3c!-- <div id="togetherjs-template-chat-joined" class="togetherjs-chat-item togetherjs-chat-join-item">\n        <div class="togetherjs-person"></div>\n        <div class="togetherjs-inline-text"><span class="togetherjs-person-name"></span> joined the session.</div>\n        <div class="togetherjs-clear"></div>\n      </div> --\x3e\n\n      \x3c!-- Template for when someone goes to a new URL: --\x3e\n      <div id="togetherjs-template-url-change" class="togetherjs-chat-item togetherjs-chat-url-change">\n        <div class="togetherjs-person"></div>\n        <div class="togetherjs-inline-text">\n          <div class="togetherjs-if-sameUrl">\n            <span class="togetherjs-person-name"></span>\n            is on the same page as you.\n          </div>\n          <div class="togetherjs-ifnot-sameUrl">\n            <span class="togetherjs-person-name"></span>\n            has gone to: <a href="#" class="togetherjs-person-url togetherjs-person-url-title" target="_self"></a>\n            <section class="togetherjs-buttons togetherjs-buttons-notification-diff-url">\n              \x3c!-- Displayed when the peer is at a different URL: --\x3e\n              <div class="togetherjs-different-url togetherjs-notification-diff-url">\n                <a class="togetherjs-nudge togetherjs-default">Nudge them</a>\n                <a href="#" class="togetherjs-follow togetherjs-person-url togetherjs-primary">Join them</a>\n              </div>\n            </section>\n\n            \x3c!-- <div>\n              <a class="togetherjs-nudge togetherjs-secondary">Nudge them</a>\n              <a href="" class="togetherjs-person-url togetherjs-follow togetherjs-primary">Join them</a>\n            </div> --\x3e\n\n          </div>\n        </div>\n        <div class="togetherjs-clear"></div>\n      </div>\n    </div>\n\n    <section id="togetherjs-chat-messages">\n      \x3c!-- FIX ME// need to have some dialogue that says something like - There are no chats yet! --\x3e\n    </section>\n    <section id="togetherjs-chat-input-box">\n      <textarea id="togetherjs-chat-input" placeholder="Type your message here"></textarea>\n    </section>\n  </div>\n\n  \x3c!-- this is a kind of warning popped up when you (successfully) start RTC: --\x3e\n  <div id="togetherjs-rtc-info" class="togetherjs-window"\n       data-bind-to="#togetherjs-audio-button"\n       style="display: none">\n\n    <header> Audio Chat </header>\n    <section>\n      <p>\n        Activate your <strong>browser microphone</strong> near your URL bar above.\n      </p>\n      <p>\n        Talking on your microphone through your web browser is an experimental feature.\n      </p>\n      <p>\n        Read more about Audio Chat <a href="https://github.com/mozilla/togetherjs/wiki/About-Audio-Chat-and-WebRTC" target="_blank">here</a>.\n      </p>\n    </section>\n\n    <section class="togetherjs-buttons">\n      <label for="togetherjs-rtc-info-dismiss" style="display: inline;">\n        <input class="togetherjs-dont-show-again" id="togetherjs-rtc-info-dismiss" type="checkbox">\n        Don\'t show again.\n      </label>\n      <button class="togetherjs-default togetherjs-dismiss" type="button">Close</button>\n    </section>\n  </div>\n\n  \x3c!-- this is popped up when you hit the audio button, but RTC isn\'t\n  supported: --\x3e\n  <div id="togetherjs-rtc-not-supported" class="togetherjs-window"\n       data-bind-to="#togetherjs-audio-button"\n       style="display: none">\n    <header> Audio Chat </header>\n\n    <section>\n      <p>Audio chat requires you to use a <a href="https://github.com/mozilla/togetherjs/wiki/About-Audio-Chat-and-WebRTC" target="_blank">\n        newer browser\n      </a>!</p>\n      <p>\n        Live audio chat requires a newer (or different) browser than you\'re using.\n      </p>\n      <p>\n        See\n        <a href="https://github.com/mozilla/togetherjs/wiki/About-Audio-Chat-and-WebRTC" target="_blank">\n          this page\n        </a>\n        for more information and a list of supported browsers.\n      </p>\n    </section>\n\n    <section class="togetherjs-buttons">\n      <div class="togetherjs-rtc-dialog-btn">\n        <button class="togetherjs-default togetherjs-dismiss" type="button">Close</button>\n      </div>\n    </section>\n  </div>\n\n  \x3c!-- The popup when a chat message comes in and the #togetherjs-chat window isn\'t open --\x3e\n  <div id="togetherjs-chat-notifier" class="togetherjs-notification"\n       data-bind-to="#togetherjs-chat-button"\n       style="display: none">\n    <img src="http://localhost:8080/togetherjs/images/notification-togetherjs-logo.png" class="togetherjs-notification-logo" alt="">\n    <img src="http://localhost:8080/togetherjs/images/notification-btn-close.png" class="togetherjs-notification-closebtn togetherjs-dismiss" alt="[close]">\n    <section id="togetherjs-chat-notifier-message">\n    </section>\n  </div>\n\n  \x3c!-- The menu when you click on the profile: --\x3e\n  <div id="togetherjs-menu" class="togetherjs-menu" style="display: none">\n    <div class="togetherjs-menu-item togetherjs-menu-disabled" id="togetherjs-menu-profile">\n      <img id="togetherjs-menu-avatar">\n      <span class="togetherjs-person-name-self" id="togetherjs-self-name-display" data-toggles="#togetherjs-menu .togetherjs-self-name"></span>\n      <input class="togetherjs-self-name" type="text" data-toggles="#togetherjs-self-name-display" style="display: none" placeholder="Enter your name">\n    </div>\n    <div class="togetherjs-menu-hr-avatar"></div>\n    <div class="togetherjs-menu-item" id="togetherjs-menu-update-name"><img src="http://localhost:8080/togetherjs/images/button-pencil.png" alt=""> Update your name</div>\n    <div class="togetherjs-menu-item" id="togetherjs-menu-update-avatar"><img src="http://localhost:8080/togetherjs/images/btn-menu-change-avatar.png" alt=""> Change avatar</div>\n    <div class="togetherjs-menu-item" id="togetherjs-menu-update-color"><span class="togetherjs-person-bgcolor-self"></span> Pick profile color</div>\n    <div class="togetherjs-hr"></div>\n    <div class="togetherjs-menu-item" id="togetherjs-menu-help">Help</div>\n    <div class="togetherjs-menu-item" id="togetherjs-menu-feedback">Feedback</div>\n    <div id="togetherjs-invite" style="display: none">\n      <div class="togetherjs-hr"></div>\n      <div id="togetherjs-invite-users"></div>\n      <div class="togetherjs-menu-item" id="togetherjs-menu-refresh-invite">Refresh users</div>\n      <div class="togetherjs-menu-item" id="togetherjs-menu-invite-anyone">Invite anyone</div>\n    </div>\n    <div class="togetherjs-hr"></div>\n    <div class="togetherjs-menu-item" id="togetherjs-menu-end"><img src="http://localhost:8080/togetherjs/images/button-end-session.png" alt=""> End <span class="togetherjs-tool-name">TogetherJS</span></div>\n  </div>\n\n  \x3c!-- template for one person in the invite-users list --\x3e\n  <div style="display: none">\n    <div id="togetherjs-template-invite-user-item" class="togetherjs-menu-item">\n      \x3c!-- FIXME: should include avatar in some way --\x3e\n      <span class="togetherjs-person-name"></span>\n    </div>\n  </div>\n\n  \x3c!-- A window version of #togetherjs-menu, for use on mobile --\x3e\n  <div id="togetherjs-menu-window" class="togetherjs-window" style="display: none">\n    <header>Settings and Profile</header>\n    <section>\n    <div class="togetherjs-menu-item">\n      <img class="togetherjs-menu-avatar">\n      <span class="togetherjs-person-name-self" id="togetherjs-self-name-display"></span>\n    </div>\n    <div class="togetherjs-menu-hr-avatar"></div>\n    <div class="togetherjs-menu-item" id="togetherjs-menu-update-name-button"><img src="http://localhost:8080/togetherjs/images/button-pencil.png" alt=""> Update your name</div>\n    <div class="togetherjs-menu-item" id="togetherjs-menu-update-avatar-button"><img src="http://localhost:8080/togetherjs/images/btn-menu-change-avatar.png" alt=""> Change avatar</div>\n    <div class="togetherjs-menu-item" id="togetherjs-menu-update-color-button"><span class="togetherjs-person-bgcolor-self"></span> Pick profile color</div>\n    <div class="togetherjs-hr"></div>\n    <div class="togetherjs-menu-item" id="togetherjs-menu-help-button">Help</div>\n    <div class="togetherjs-menu-item" id="togetherjs-menu-feedback-button">Feedback</div>\n    <div class="togetherjs-hr"></div>\n    <div class="togetherjs-menu-item" id="togetherjs-menu-end-button"><img src="http://localhost:8080/togetherjs/images/button-end-session.png" alt=""> End <span class="togetherjs-tool-name">TogetherJS</span></div>\n    </section>\n    <section class="togetherjs-buttons">\n      <button class="togetherjs-dismiss togetherjs-primary">OK</button>\n    </section>\n  </div>\n\n  \x3c!-- The name editor, for use on mobile --\x3e\n  <div id="togetherjs-edit-name-window" class="togetherjs-window" style="display: none">\n    <header>Update Name</header>\n    <section>\n      <div>\n        <input class="togetherjs-self-name" type="text" placeholder="Enter your name">\n      </div>\n    </section>\n    <section class="togetherjs-buttons">\n      <button class="togetherjs-dismiss togetherjs-primary">OK</button>\n    </section>\n  </div>\n\n  <div class="togetherjs-menu" id="togetherjs-pick-color" style="display: none">\n    <div class="togetherjs-triangle-up"><img src="http://localhost:8080/togetherjs/images/icn-triangle-up.png"></div>\n    <div style="display: none">\n      <div id="togetherjs-template-swatch" class="togetherjs-swatch">\n      </div>\n    </div>\n  </div>\n\n  \x3c!-- Invisible elements that handle the RTC audio: --\x3e\n  <audio id="togetherjs-audio-element"></audio>\n  <audio id="togetherjs-local-audio" muted="true" volume="0.3"></audio>\n  <audio id="togetherjs-notification" src="http://localhost:8080/togetherjs/images/notification.ogg"></audio>\n\n  \x3c!-- The intro screen for someone who joins a session the first time: --\x3e\n  <div id="togetherjs-intro" class="togetherjs-modal" style="display: none">\n    <header>Join <span class="togetherjs-tool-name">TogetherJS</span> session?</header>\n    <section>\n      <p>Your friend has asked you to join their <a href="https://togetherjs.mozillalabs.com/" target="_blank"><span class="togetherjs-tool-name">TogetherJS</span></a> browser session to collaborate in real-time!</p>\n\n      <p>Would you like to join their session?</p>\n    </section>\n\n    <section class="togetherjs-buttons">\n      <button class="togetherjs-destructive togetherjs-modal-dont-join">No, don\'t join</button>\n      <button class="togetherjs-primary togetherjs-dismiss">Yes, join session</button>\n    </section>\n  </div>\n\n  \x3c!-- Shown when a web browser is completely incapable of running TogetherJS: --\x3e\n  <div id="togetherjs-browser-broken" class="togetherjs-modal" style="display: none">\n    <header> Sorry </header>\n\n    <section>\n      <p>\n        We\'re sorry, <span class="togetherjs-tool-name">TogetherJS</span> doesn\'t work with this browser.  Please\n        <a href="https://github.com/mozilla/togetherjs/wiki/Supported-Browsers#supported-browsers">upgrade\n          to a supported browser</a> to try <span class="togetherjs-tool-name">TogetherJS</span>.\n      </p>\n\n      <p id="togetherjs-browser-broken-is-ie" style="display: none">\n        We need your help fixing TogetherJS on Internet Explorer!  Here are a list of IE <a href="https://github.com/mozilla/togetherjs/issues?labels=IE&milestone=&page=1&state=open" target="_blank">GitHub issues</a> we need fixed that you can work on.\n        Internet Explorer <a href="https://github.com/mozilla/togetherjs/wiki/Supported-Browsers#internet-explorer">is\n          currently not supported</a>.  If you do want to try out TogetherJS, we\'d suggest using Firefox or Chrome.\n      </p>\n    </section>\n\n    <section class="togetherjs-buttons">\n      <button class="togetherjs-dismiss togetherjs-primary">End <span class="togetherjs-tool-name">TogetherJS</span></button>\n    </section>\n\n  </div>\n\n  \x3c!-- Shown when the browser has WebSockets, but is IE (i.e., IE10) --\x3e\n  <div id="togetherjs-browser-unsupported" class="togetherjs-modal" style="display: none">\n    <header> Unsupported Browser </header>\n\n    <section>\n      <p>\n        We need your help fixing TogetherJS on Internet Explorer!  Here are a list of IE <a href="https://github.com/mozilla/togetherjs/issues?labels=IE&milestone=&page=1&state=open" target="_blank">GitHub issues</a> we need fixed that you can work on.\n        Internet Explorer <a href="https://github.com/mozilla/togetherjs/wiki/Supported-Browsers#internet-explorer">is not supported</a>\n        at this time.  While we may add support later, adding support is\n        not currently on our roadmap.  If you do want to try out TogetherJS, we\'d suggest using Firefox or Chrome.\n      </p>\n\n      <p>You can continue to try to use <span class="togetherjs-tool-name">TogetherJS</span>, but you are likely to hit\n        lots of bugs.  So be warned.</p>\n\n    </section>\n\n    <section class="togetherjs-buttons">\n      <button class="togetherjs-dismiss togetherjs-primary">End <span class="togetherjs-tool-name">TogetherJS</span></button>\n      <button class="togetherjs-dismiss togetherjs-secondary togetherjs-browser-unsupported-anyway">Try <span class="togetherjs-tool-name">TogetherJS</span> Anyway</button>\n    </section>\n\n  </div>\n\n  <div id="togetherjs-confirm-end" class="togetherjs-modal" style="display: none">\n    <header> End session? </header>\n    <section>\n      <p>\n        Are you sure you\'d like to end your <span class="togetherjs-tool-name">TogetherJS</span> session?\n      </p>\n    </section>\n    <section class="togetherjs-buttons">\n      <button class="togetherjs-cancel togetherjs-dismiss">Cancel</button>\n      <span class="togetherjs-alt-text">or</span>\n      <button id="togetherjs-end-session" class="togetherjs-destructive">End session</button>\n    </section>\n  </div>\n\n  <div id="togetherjs-feedback-form" class="togetherjs-modal" style="display: none;">\n    <header> Feedback </header>\n    <iframe src="https://docs.google.com/a/mozilla.com/forms/d/1lVE7JyRo_tjakN0mLG1Cd9X9vseBX9wci153z9JcNEs/viewform?embedded=true" width="400" height="300" frameborder="0" marginheight="0" marginwidth="0">Loading form...</iframe>\n    \x3c!-- <p><button class="togetherjs-modal-close">Close</button></p> --\x3e\n  </div>\n\n  <div style="display: none">\n    \x3c!-- This is when you join a session and the other person has already changed to another URL: --\x3e\n    <div id="togetherjs-template-url-change" class="togetherjs-modal">\n      <header> Following to new URL... </header>\n      <section>\n        <div class="togetherjs-person"></div>\n        Following\n        <span class="togetherjs-person-name"></span>\n        to <a href="" class="togetherjs-person-url togetherjs-person-url-title"></a>\n      </section>\n    </div>\n\n    \x3c!-- This is when someone invites you to their session: --\x3e\n    <div id="togetherjs-template-invite" class="togetherjs-chat-item">\n      <div class="togetherjs-person"></div>\n      <div>\n        <span class="togetherjs-person-name"></span>\n        has invited <strong class="togetherjs-if-forEveryone">anyone</strong>\n        <strong class="togetherjs-ifnot-forEveryone">you</strong>\n        to <a href="" data-togetherjs-subattr-href="href" class="togetherjs-sub-hrefTitle" target="_blank"></a>\n      </div>\n    </div>\n\n  </div>\n\n  \x3c!-- The pointer at the side of a window: --\x3e\n  <div id="togetherjs-window-pointer-right" style="display: none"></div>\n  <div id="togetherjs-window-pointer-left" style="display: none"></div>\n\n  \x3c!-- The element that overlaps the background of the page during a modal dialog: --\x3e\n  <div id="togetherjs-modal-background" style="display: none"></div>\n\n  \x3c!-- Some miscellaneous templates --\x3e\n  <div style="display: none">\n\n    \x3c!-- This is the cursor: --\x3e\n    <div id="togetherjs-template-cursor" class="togetherjs-cursor togetherjs">\n      \x3c!-- Note: images/cursor.svg is a copy of this (for editing): --\x3e\n      \x3c!-- crossbrowser svg dropshadow http://demosthenes.info/blog/600/Creating-a-True-CrossBrowser-Drop-Shadow- --\x3e\n      <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n      \t width="15px" height="22.838px" viewBox="96.344 146.692 15 22.838" enable-background="new 96.344 146.692 15 22.838"\n      \t xml:space="preserve">\n      <path fill="#231F20" d="M98.984,146.692c2.167,1.322,1.624,6.067,3.773,7.298c-0.072-0.488,2.512-0.931,3.097,0\n      \tc0.503,0.337,1.104-0.846,2.653,0.443c0.555,0.593,3.258,2.179,1.001,8.851c-0.446,1.316,2.854,0.135,1.169,2.619\n      \tc-3.748,5.521-9.455,2.787-9.062,1.746c1.06-2.809-6.889-4.885-4.97-9.896c0.834-2.559,2.898,0.653,2.923,0.29\n      \tc-0.434-1.07-2.608-5.541-2.923-6.985C96.587,150.793,95.342,147.033,98.984,146.692z"/>\n      </svg>\n      \x3c!-- <img class="togetherjs-cursor-img" src="http://localhost:8080/togetherjs/images/cursor.svg"> --\x3e\n      <span class="togetherjs-cursor-container">\n        <span class="togetherjs-cursor-name"></span>\n        <span style="display:none" class="togetherjs-cursor-typing" id="togetherjs-cursor-typebox">\n          <span class="togetherjs-typing-ellipse-one">&#9679;</span><span class="togetherjs-typing-ellipse-two">&#9679;</span><span class="togetherjs-typing-ellipse-three">&#9679;</span>\n        </span>\n        \x3c!-- Displayed when the cursor is below the screen: --\x3e\n        <span class="togetherjs-cursor-down">\n\n        </span>\n        \x3c!-- Displayed when the cursor is above the screen: --\x3e\n        <span class="togetherjs-cursor-up">\n\n        </span>\n      </span>\n    </div>\n\n    \x3c!-- This is the element that goes around focused form elements: --\x3e\n    <div id="togetherjs-template-focus">\n      <div class="togetherjs-focus togetherjs-person-bordercolor"></div>\n    </div>\n\n    \x3c!-- This is a click: --\x3e\n    <div id="togetherjs-template-click" class="togetherjs-click togetherjs">\n    </div>\n  </div>\n</div>\n'),help:t('<% /*\n  This is used to show the help when you type /help.  Used in\n  TogetherJS.localChatMessage().\n\n*/ %>\n/help : this message\n/test : run an automated/randomized test (or stop one that is in progress)\n  /test start N : run N times (instead of default 100)\n  /test show : show what kind of actions the random test would take (or stop showing)\n  /test describe : describe the possible actions (instead of showing them)\n/clear : clear the chat area\n/record : open up a recorder for the session\n/playback URL : play back a session that was recorded (it\'s up to you to figure out how to host it)\n  /playback local:NAME : play a locally saved log\n/savelogs NAME : save the currently recorded logs under NAME (recorder must be open)\n/baseurl : set a local baseUrl to load TogetherJS from, for debugging a development version of TogetherJS.\n/config : override some TogetherJS configuration parameters\n  /config VAR VALUE : set TogetherJS.config("VAR", VALUE).  VALUE must be a legal Javascript/JSON literal.\n  /config clear : remove all overridden configuration\n'),walkthrough:t('\x3c!--\n    Any elements with .togetherjs-walkthrough-firsttime will only be\n    displayed on during the first-time experience.  Any elements with\n    .togetherjs-walkthrough-not-firsttime will only be displayed when\n    the walkthrough is accessed through the Help menu.\n\n    Note you *cannot* use <section class="togetherjs-walkthrough-slide\n    togetherjs-walkthrough-firsttime">: the number of sections must be the\n    same regardless.\n  --\x3e\n<div id="togetherjs-walkthrough" class="togetherjs-modal togetherjs-modal-wide">\n  <header>You\'re using <span class="togetherjs-tool-name">TogetherJS</span>!<button class="togetherjs-close"></button></header>\n\n  <div id="togetherjs-walkthrough-previous"></div>\n  <div id="togetherjs-walkthrough-next"></div>\n\n  <section class="togetherjs-walkthrough-slide">\n    <p class="togetherjs-walkthrough-main-image"><img src="http://localhost:8080/togetherjs/images/walkthrough-images-intro.png"></p>\n\t<p><span class="togetherjs-tool-name">TogetherJS</span> is a service for your website that makes it easy to collaborate in real-time on: <strong class="togetherjs-site-name">[site name]</strong></p>\n  </section>\n\n  <section class="togetherjs-walkthrough-slide">\n    <div class="togetherjs-walkthrough-firsttime">\n      <div class="togetherjs-walkthrough-main-image">\n        <div class="togetherjs-walkthrough-avatar-section">\n          <div class="togetherjs-avatar-preview togetherjs-person togetherjs-person-self"></div>\n          <div class="togetherjs-avatar-upload-input"><input type="file" class="togetherjs-upload-avatar"></div>\n        </div>\n        <input class="togetherjs-self-name" type="text" placeholder="Enter your name">\n        <div class="togetherjs-swatch togetherjs-person-bgcolor-self"></div>\n        <div class="togetherjs-save-settings">\n          <button class="togetherjs-avatar-save togetherjs-primary">\n            <span id="togetherjs-avatar-when-unsaved">Save</span>\n            <span id="togetherjs-avatar-when-saved" style="display: none">Saved!</span>\n          </button>\n        </div>\n      </div>\n      <p>Set up your avatar, name and user color above.  If you\'d like to update it later, you can click your Profile button.</p>\n    </div>\n    <div class="togetherjs-walkthrough-not-firsttime">\n      <p class="togetherjs-walkthrough-main-image"><img src="http://localhost:8080/togetherjs/images/walkthrough-images-profile.png"></p>\n      <p>Change your avatar, name and user color using the Profile button.</p>\n    </div>\n  </section>\n\n  <section class="togetherjs-walkthrough-slide">\n    <p class="togetherjs-walkthrough-main-image togetherjs-ifnot-creator"><img src="http://localhost:8080/togetherjs/images/walkthrough-images-invite.png">\n    </p>\n    <p class="togetherjs-ifnot-creator">You can invite more friends to the session by sending the invite link in the <span class="togetherjs-tool-name">TogetherJS</span> dock.</p>\n    <p class="togetherjs-walkthrough-main-image togetherjs-if-creator">\n      <span class="togetherjs-walkthrough-sendlink">\n        Copy and paste this link into IM or email to invite friends.\n      </span>\n      <input type="text" class="togetherjs-share-link">\n    </p>\n    <p class="togetherjs-if-creator">Send the above link to a friend so they can join your session!  You can find this invite link on the <span class="togetherjs-tool-name">TogetherJS</span> dock as well.</p>\n  </section>\n\n  <section class="togetherjs-walkthrough-slide">\n    <p class="togetherjs-walkthrough-main-image"><img src="http://localhost:8080/togetherjs/images/walkthrough-images-participant.png"></p>\n    <p>Friends who join your <span class="togetherjs-tool-name">TogetherJS</span> session will appear here.  You can click their avatars to see more.</p>\n  </section>\n\n  <section class="togetherjs-walkthrough-slide">\n    <p class="togetherjs-walkthrough-main-image"><img src="http://localhost:8080/togetherjs/images/walkthrough-images-chat.png"></p>\n    <p>When your friends join you in your <span class="togetherjs-tool-name">TogetherJS</span> session, you can chat with them here!</p>\n  </section>\n\n  <section class="togetherjs-walkthrough-slide">\n    <p class="togetherjs-walkthrough-main-image"><img src="http://localhost:8080/togetherjs/images/walkthrough-images-rtc.png"></p>\n    <p>If your browser supports it, click the microphone icon to begin a audio chat. Learn more about this experimental feature <a href="https://github.com/mozilla/togetherjs/wiki/About-Audio-Chat-and-WebRTC" target="_blank">here</a>.</p>\n  </section>\n\n  <section class="togetherjs-walkthrough-slide">\n    <p class="togetherjs-walkthrough-main-image"><img src="http://localhost:8080/togetherjs/images/walkthrough-images-logo.png"></p>\n    <p>Alright, you\'re ready to use <span class="togetherjs-tool-name">TogetherJS</span>. Now start collaborating on <strong class="togetherjs-site-name">[site name]</strong>!</p>\n  </section>\n\n  <div style="display: none">\n    \x3c!-- There is one of these created for each slide: --\x3e\n    <span id="togetherjs-template-walkthrough-slide-progress" class="togetherjs-walkthrough-slide-progress">&#9679;</span>\n  </div>\n  <section id="togetherjs-walkthrough-progress">\n  </section>\n\n  <section class="togetherjs-buttons">\n    <button class="togetherjs-primary togetherjs-dismiss">I\'m ready!</button>\n  </section>\n\n</div>\x3c!-- /.togetherjs-modal --\x3e\n')}}),t("peers",["util","session","storage","require"],function(e,t,n,o){var r,i=e.Module("peers"),s=e.assert,a=1e4,l=18e4,c=6e5;o(["ui"],function(e){r=e});var u=["Friendly Fox","Brilliant Beaver","Observant Owl","Gregarious Giraffe","Wild Wolf","Silent Seal","Wacky Whale","Curious Cat","Intelligent Iguana"],h=e.Class({isSelf:!1,constructor:function(e,t){t=t||{},s(e),s(!h.peers[e]),this.id=e,this.identityId=t.identityId||null,this.status=t.status||"live",this.idle=t.status||"active",this.name=t.name||null,this.avatar=t.avatar||null,this.color=t.color||"#00FF00",this.view=r.PeerView(this),this.lastMessageDate=0,this.following=t.following||!1,h.peers[e]=this;var n=t.joined||!1;t.fromHelloMessage&&(this.updateFromHello(t.fromHelloMessage),"hello"==t.fromHelloMessage.type&&(n=!0)),i.emit("new-peer",this),n&&this.view.notifyJoined(),this.view.update()},repr:function(){return"Peer("+JSON.stringify(this.id)+")"},serialize:function(){return{id:this.id,status:this.status,idle:this.idle,url:this.url,hash:this.hash,title:this.title,identityId:this.identityId,rtcSupported:this.rtcSupported,name:this.name,avatar:this.avatar,color:this.color,following:this.following}},destroy:function(){this.view.destroy(),delete h.peers[this.id]},updateMessageDate:function(e){"inactive"==this.idle&&this.update({idle:"active"}),"bye"==this.status&&this.unbye(),this.lastMessageDate=Date.now()},updateFromHello:function(n){var o=!1,r=!1;n.url&&n.url!=this.url&&(this.url=n.url,this.hash=null,this.title=null,o=!0),n.hash!=this.hash&&(this.hash=n.urlHash,o=!0),n.title!=this.title&&(this.title=n.title,o=!0),void 0!==n.rtcSupported&&(this.rtcSupported=n.rtcSupported),void 0!==n.identityId&&(this.identityId=n.identityId),n.name&&n.name!=this.name&&(this.name=n.name,r=!0),n.avatar&&n.avatar!=this.avatar&&(e.assertValidUrl(n.avatar),this.avatar=n.avatar,r=!0),n.color&&n.color!=this.color&&(this.color=n.color,r=!0),void 0!==n.isClient&&(this.isCreator=!n.isClient),"live"!=this.status&&(this.status="live",i.emit("status-updated",this)),"active"!=this.idle&&(this.idle="active",i.emit("idle-updated",this)),n.rtcSupported&&i.emit("rtc-supported",this),o&&i.emit("url-updated",this),r&&i.emit("identity-updated",this),this.following&&t.emit("follow-peer",this)},update:function(e){e.idle&&(this.idle=e.idle),e.status&&(this.status=e.status),this.view.update()},className:function(t){return(t=t||"")+e.safeClassName(this.id)},bye:function(){"bye"!=this.status&&(this.status="bye",i.emit("status-updated",this)),this.view.update()},unbye:function(){"bye"==this.status&&(this.status="live",i.emit("status-updated",this)),this.view.update()},nudge:function(){t.send({type:"url-change-nudge",url:location.href,to:this.id})},follow:function(){this.following||(i.getAllPeers().forEach(function(e){e.following&&e.unfollow()}),this.following=!0,m(),this.view.update(),t.emit("follow-peer",this))},unfollow:function(){this.following=!1,m(),this.view.update()}});function d(e){e&&e.peers.forEach(function(e){h.deserialize(e)})}function f(){var e=i.getAllPeers(),t=Date.now();e.forEach(function(e){"active"==e.idle&&t-e.lastMessageDate>l&&e.update({idle:"inactive"}),"bye"!=e.status&&t-e.lastMessageDate>c&&e.bye()})}t.on("follow-peer",function(e){if(e.url!=t.currentUrl()){var n=e.url;e.urlHash&&(n+=e.urlHash),location.href=n}}),h.peers={},h.deserialize=function(e){e.fromStorage=!0;h(e.id,e)},i.Self=void 0,t.on("start",function(){i.Self||(i.Self=e.mixinEvents({isSelf:!0,id:t.clientId,identityId:t.identityId,status:"live",idle:"active",name:null,avatar:null,color:null,defaultName:null,loaded:!1,isCreator:!t.isClient,updateFromHello:function(n){var o=!1,r=!1;n.url&&n.url!=this.url&&(this.url=n.url,this.hash=null,this.title=null,o=!0),n.hash!=this.hash&&(this.hash=n.urlHash,o=!0),n.title!=this.title&&(this.title=n.title,o=!0),void 0!==n.rtcSupported&&(this.rtcSupported=n.rtcSupported),void 0!==n.identityId&&(this.identityId=n.identityId),n.name&&n.name!=this.name&&(this.name=n.name,r=!0),n.avatar&&n.avatar!=this.avatar&&(e.assertValidUrl(n.avatar),this.avatar=n.avatar,r=!0),n.color&&n.color!=this.color&&(this.color=n.color,r=!0),void 0!==n.isClient&&(this.isCreator=!n.isClient),"live"!=this.status&&(this.status="live",i.emit("status-updated",this)),"active"!=this.idle&&(this.idle="active",i.emit("idle-updated",this)),n.rtcSupported&&i.emit("rtc-supported",this),o&&i.emit("url-updated",this),r&&i.emit("identity-updated",this),this.following&&t.emit("follow-peer",this)},update:function(o){var r=!1,s=!1,a={type:"peer-update"};"string"==typeof o.name&&o.name!=this.name&&(this.name=o.name,a.name=this.name,o.fromLoad||(n.settings.set("name",this.name),r=!0)),o.avatar&&o.avatar!=this.avatar&&(e.assertValidUrl(o.avatar),this.avatar=o.avatar,a.avatar=this.avatar,o.fromLoad||(n.settings.set("avatar",this.avatar),r=!0)),o.color&&o.color!=this.color&&(this.color=o.color,a.color=this.color,o.fromLoad||(n.settings.set("color",this.color),r=!0)),o.defaultName&&o.defaultName!=this.defaultName&&(this.defaultName=o.defaultName,o.fromLoad||(n.settings.set("defaultName",this.defaultName),r=!0)),o.status&&o.status!=this.status&&(this.status=o.status,i.emit("status-updated",this)),o.idle&&o.idle!=this.idle&&(this.idle=o.idle,s=!0,i.emit("idle-updated",this)),this.view.update(),r&&!o.fromLoad&&(t.emit("self-updated"),t.send(a)),s&&!o.fromLoad&&t.send({type:"idle-status",idle:this.idle})},className:function(e){return(e=e||"")+"self"},_loadFromSettings:function(){return e.resolveMany(n.settings.get("name"),n.settings.get("avatar"),n.settings.get("defaultName"),n.settings.get("color")).then(function(t,o,r,s){if(r||(r=e.pickRandom(u),n.settings.set("defaultName",r)),!s){for(s=Math.floor(16777215*Math.random()).toString(16);s.length<6;)s="0"+s;s="#"+s,n.settings.set("color",s)}o||(o=TogetherJS.baseUrl+"/togetherjs/images/default-avatar.png"),this.update({name:t,avatar:o,defaultName:r,color:s,fromLoad:!0}),i._SelfLoaded.resolve()}.bind(this))},_loadFromApp:function(){var e,t,n,o=TogetherJS.config.get("getUserName"),r=TogetherJS.config.get("getUserColor"),i=TogetherJS.config.get("getUserAvatar");o&&(e="string"==typeof o?o:o())&&"string"!=typeof e&&(console.warn("Error in getUserName(): should return a string (got",e,")"),e=null),r&&(t="string"==typeof r?r:r())&&"string"!=typeof t&&(console.warn("Error in getUserColor(): should return a string (got",t,")"),t=null),i&&(n="string"==typeof i?i:i())&&"string"!=typeof n&&(console.warn("Error in getUserAvatar(): should return a string (got",n,")"),n=null),(e||t||n)&&this.update({name:e,color:t,avatar:n})}}),i.Self.view=r.PeerView(i.Self),n.tab.get("peerCache").then(d),i.Self._loadFromSettings().then(function(){i.Self._loadFromApp(),i.Self.view.update(),t.emit("self-updated")}))}),t.on("refresh-user-data",function(){i.Self&&i.Self._loadFromApp()}),TogetherJS.config.track("getUserName",TogetherJS.config.track("getUserColor",TogetherJS.config.track("getUserAvatar",function(){i.Self&&i.Self._loadFromApp()}))),i._SelfLoaded=e.Deferred(),i.getPeer=function(e,n){s(e);var o=h.peers[e];return e===t.clientId?i.Self:n&&!o?o=h(e,{fromHelloMessage:n}):(s(o,"No peer with id:",e),!n||"hello"!=n.type&&"hello-back"!=n.type&&"peer-update"!=n.type||(o.updateFromHello(n),o.view.update()),h.peers[e])},i.getAllPeers=function(t){var n=[];return e.forEachAttr(h.peers,function(e){t&&"live"!=e.status||n.push(e)}),n},t.hub.on("bye",function(e){i.getPeer(e.clientId).bye()});var p=null;t.on("start",function(){p&&(console.warn("Old peers checkActivityTask left over?"),clearTimeout(p)),p=setInterval(f,a)}),t.on("close",function(){e.forEachAttr(h.peers,function(e){e.destroy()}),n.tab.set("peerCache",void 0),clearTimeout(p),p=null});var g=null;function m(){var t;n.tab.set("peerCache",(t=[],e.forEachAttr(h.peers,function(e){t.push(e.serialize())}),{peers:t}))}return t.on("visibility-change",function(e){e?(g&&clearTimeout(g),g=setTimeout(function(){i.Self.update({idle:"inactive"})},12e4)):(g&&clearTimeout(g),"inactive"==i.Self.idle&&i.Self.update({idle:"active"}))}),t.hub.on("idle-status",function(e){e.peer.update({idle:e.idle})}),t.hub.on("ping",function(){t.send({type:"ping-back"})}),window.addEventListener("pagehide",function(){m()},!1),e.mixinEvents(i),e.testExpose({setIdleTime:function(e){l=e,a=e/2,TogetherJS.running&&(clearTimeout(p),p=setInterval(f,a))}}),e.testExpose({setByeTime:function(e){c=e,a=Math.min(a,e/2),TogetherJS.running&&(clearTimeout(p),p=setInterval(f,a))}}),i}),t("windowing",["jquery","util","peers","session"],function(t,n,o,r){var i=n.assert,s=n.Module("windowing"),a=t(window);s.show=function(e,n){e=t(e),(n=n||{}).bind=n.bind||e.attr("data-bind-to");var o=e.hasClass("togetherjs-notification"),a=e.hasClass("togetherjs-modal");n.bind&&(n.bind=t(n.bind)),s.hide(),e.stop(),e.show(),e.css({opacity:"1"}),n.bind&&(i(!a,"Binding does not currently work with modals"),c(e,n.bind)),o?e.slideIn():a||e.popinWindow(),a&&(u().show(),h.bind()),l=n.onClose||null,r.emit("display-window",e.attr("id"),e)};var l=null;function c(n,o){if(t.browser.mobile)return;n=t(n),i(o.length,"Cannot find binding:",o.selector,"from:",n.selector);const r=e("ui").panelPosition();var s=o.offset();s.height=o.height(),s.width=o.width(),s.top-=a.scrollTop(),s.left-=a.scrollLeft();var l,c,u=n.height()+5,h=n.width()+20;if("left"==r?(l=s.left+s.width+15,c=s.top+s.height/2-u/2):"right"==r?(l=s.left-11-h,c=s.top+s.height/2-u/2):"top"==r?(l=s.left+s.width/2-h/2,c=s.top+s.width+15):(l=s.left+s.width/2-h/2,c=s.top-10-u),n.css({left:l+"px",right:"",top:c+"px",bottom:""}),parseInt(n.css("left"))<5?n.css({left:"5px"}):parseInt(n.css("right"))<5&&n.css({left:"",right:"5px"}),parseInt(n.css("top"))<5?n.css({top:"5px"}):parseInt(n.css("bottom"))<5&&n.css({top:"",bottom:"5px"}),n.hasClass("togetherjs-window")){t("#togetherjs-window-pointer").hide();var d=t("#togetherjs-window-pointer");d.removeClass(),d.addClass(r),d.show(),"left"==r?d.css({left:l-30+"px",top:s.top+Math.floor(s.height/2)-13+"px"}):"right"==r?d.css({left:l+n.width()+14+"px",top:s.top+Math.floor(s.height/2)-13+"px"}):"top"==r?d.css({left:s.left+Math.floor(s.width/2)-13+"px",top:c-30+"px"}):"bottom"==r&&d.css({left:s.left+Math.floor(s.width/2)-13+"px",top:c+n.height()+"px"})}n.data("boundTo",o.selector||"#"+o.attr("id")),o.addClass("togetherjs-active")}function u(){if(u.element)return u.element;var e=t("#togetherjs-modal-background");return i(e.length),u.element=e,e.click(function(){s.hide()}),e}r.on("resize",function(){var e=t(".togetherjs-modal:visible, .togetherjs-window:visible");if(e.length){var n=e.data("boundTo");n&&c(e,n=t(n))}}),s.hide=function(e){(e=(e=t(e=e||".togetherjs-window, .togetherjs-modal, .togetherjs-notification")).filter(":visible")).filter(":not(.togetherjs-notification)").hide(),u().hide();var n=[];e.each(function(e,o){o=t(o),n.push(o);var r=o.data("boundTo");r&&((r=t(r)).addClass("togetherjs-animated").addClass("togetherjs-color-pulse"),setTimeout(function(){r.removeClass("togetherjs-color-pulse").removeClass("togetherjs-animated")},1010),o.data("boundTo",null),r.removeClass("togetherjs-active"),o.hasClass("togetherjs-notification")&&o.fadeOut().promise().then(function(){this.hide()}))}),t("#togetherjs-window-pointer").hide(),l&&(l(),l=null),n.length&&r.emit("hide-window",n)},s.showNotification=function(e,n){e=t(e),n=n||{},i(!1)},s.toggle=function(e){(e=t(e)).is(":visible")?s.hide(e):s.show(e)};var h={bind:function(){t(document).keydown(h.onKeydown)},unbind:function(){t(document).unbind("keydown",h.onKeydown)},onKeydown:function(e){27==e.which&&s.hide()}};return r.on("close",function(){h.unbind()}),r.on("new-element",function(e){!function(e){e.find(".togetherjs-close, .togetherjs-dismiss").click(function(e){var n=t(e.target).closest(".togetherjs-window, .togetherjs-modal, .togetherjs-notification");return s.hide(n),e.stopPropagation(),!1})}(e)}),s}),t("templating",["jquery","util","peers","windowing","session"],function(e,t,n,o,r){var i=t.assert,s=t.Module("templating");return s.clone=function(t){var n=e(t="#togetherjs-template-"+t);return i(n.length,"No template found with id:",t),(n=n.clone()).attr("id",null),n},s.sub=function(n,o){var a=s.clone(n);if(o=o||{},t.forEachAttr(o,function(t,n){var o=a.find(".togetherjs-sub-"+n).removeClass("togetherjs-sub-"+n);o.length&&("string"==typeof t?o.text(t):t instanceof e?o.append(t):i(!1,"Unknown variable value type:",n,"=",t));var r=a.find(".togetherjs-if-"+n).removeClass("togetherjs-sub-"+n);t||r.hide(),r=a.find(".togetherjs-ifnot-"+n).removeClass("togetherjs-ifnot-"+n),t&&r.hide();var s="data-togetherjs-subattr-"+n;a.find("["+s+"]").each(function(n,o){i("string"==typeof t);var r=(o=e(o)).attr(s);o.attr(s,null),o.attr(r,t)})}),o.peer&&o.peer.view.setElement(a),o.date){var l=o.date;"number"==typeof l&&(l=new Date(l));var c="AM",u=l.getHours();u>12&&(u-=12,c="PM");var h=l.getMinutes(),d=u+":";h<10&&(d+="0"),d+=h,a.find(".togetherjs-time").text(d),a.find(".togetherjs-ampm").text(c)}return r.emit("new-element",a),a},s}),t("linkify",[],function(){return function(e){return e.jquery&&(e=e[0]),e.normalize(),function e(t){for(var n=t.childNodes.length,o=0;o<n;o++)t.childNodes[o].nodeType==document.ELEMENT_NODE&&e(t.childNodes[o]);var r=[];for(o=0;o<n;o++)t.childNodes[o].nodeType==document.TEXT_NODE&&r.push(t.childNodes[o]);r.forEach(function(n){if(n.nodeType==document.ELEMENT_NODE)e(n);else if(n.nodeType==document.TEXT_NODE)for(;;){var o=n.nodeValue,r=/\bhttps?:\/\/[a-z0-9\.\-_](:\d+)?[^ \n\t<>()\[\]]*/i.exec(o);if(!r)break;var i=document.createTextNode(o.substr(0,r.index));t.replaceChild(i,n);var s=document.createElement("a");s.setAttribute("target","_blank"),s.href=r[0],s.appendChild(document.createTextNode(r[0])),t.insertBefore(s,i.nextSibling);var a=document.createTextNode(o.substr(r.index+r[0].length));t.insertBefore(a,s.nextSibling),n=a}})}(e),e}}),function(e){var n=/^[\s,#]+/,o=/\s+$/,r=0,i=Math,s=i.round,a=i.min,l=i.max,c=i.random;function u(e,t){if("object"==typeof(e=e||"")&&e.hasOwnProperty("_tc_id"))return e;var c=function(e){var t={r:255,g:255,b:255},r=1,s=!1,c=!1;"string"==typeof e&&(e=function(e){e=e.replace(n,"").replace(o,"").toLowerCase();var t,r=!1;if(p[e])e=p[e],r=!0;else if("transparent"==e)return{r:0,g:0,b:0,a:0};if(t=T.rgb.exec(e))return{r:t[1],g:t[2],b:t[3]};if(t=T.rgba.exec(e))return{r:t[1],g:t[2],b:t[3],a:t[4]};if(t=T.hsl.exec(e))return{h:t[1],s:t[2],l:t[3]};if(t=T.hsla.exec(e))return{h:t[1],s:t[2],l:t[3],a:t[4]};if(t=T.hsv.exec(e))return{h:t[1],s:t[2],v:t[3]};if(t=T.hex6.exec(e))return{r:y(t[1]),g:y(t[2]),b:y(t[3]),format:r?"name":"hex"};if(t=T.hex3.exec(e))return{r:y(t[1]+""+t[1]),g:y(t[2]+""+t[2]),b:y(t[3]+""+t[3]),format:r?"name":"hex"};return!1}(e));"object"==typeof e&&(e.hasOwnProperty("r")&&e.hasOwnProperty("g")&&e.hasOwnProperty("b")?(u=e.r,h=e.g,d=e.b,t={r:255*m(u,255),g:255*m(h,255),b:255*m(d,255)},s=!0,c="%"===String(e.r).substr(-1)?"prgb":"rgb"):e.hasOwnProperty("h")&&e.hasOwnProperty("s")&&e.hasOwnProperty("v")?(e.s=w(e.s),e.v=w(e.v),t=function(e,t,n){e=6*m(e,360),t=m(t,100),n=m(n,100);var o=i.floor(e),r=e-o,s=n*(1-t),a=n*(1-r*t),l=n*(1-(1-r)*t),c=o%6;return{r:255*[n,a,s,s,l,n][c],g:255*[l,n,n,a,s,s][c],b:255*[s,s,l,n,n,a][c]}}(e.h,e.s,e.v),s=!0,c="hsv"):e.hasOwnProperty("h")&&e.hasOwnProperty("s")&&e.hasOwnProperty("l")&&(e.s=w(e.s),e.l=w(e.l),t=function(e,t,n){var o,r,i;function s(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}if(e=m(e,360),t=m(t,100),n=m(n,100),0===t)o=r=i=n;else{var a=n<.5?n*(1+t):n+t-n*t,l=2*n-a;o=s(l,a,e+1/3),r=s(l,a,e),i=s(l,a,e-1/3)}return{r:255*o,g:255*r,b:255*i}}(e.h,e.s,e.l),s=!0,c="hsl"),e.hasOwnProperty("a")&&(r=e.a));var u,h,d;r=parseFloat(r),(isNaN(r)||r<0||r>1)&&(r=1);return{ok:s,format:e.format||c,r:a(255,l(t.r,0)),g:a(255,l(t.g,0)),b:a(255,l(t.b,0)),a:r}}(e),v=c.r,j=c.g,x=c.b,k=c.a,C=s(100*k)/100,S=c.format;return v<1&&(v=s(v)),j<1&&(j=s(j)),x<1&&(x=s(x)),{ok:c.ok,format:S,_tc_id:r++,alpha:k,toHsv:function(){var e=d(v,j,x);return{h:360*e.h,s:e.s,v:e.v,a:k}},toHsvString:function(){var e=d(v,j,x),t=s(360*e.h),n=s(100*e.s),o=s(100*e.v);return 1==k?"hsv("+t+", "+n+"%, "+o+"%)":"hsva("+t+", "+n+"%, "+o+"%, "+C+")"},toHsl:function(){var e=h(v,j,x);return{h:360*e.h,s:e.s,l:e.l,a:k}},toHslString:function(){var e=h(v,j,x),t=s(360*e.h),n=s(100*e.s),o=s(100*e.l);return 1==k?"hsl("+t+", "+n+"%, "+o+"%)":"hsla("+t+", "+n+"%, "+o+"%, "+C+")"},toHex:function(){return f(v,j,x)},toHexString:function(){return"#"+f(v,j,x)},toRgb:function(){return{r:s(v),g:s(j),b:s(x),a:k}},toRgbString:function(){return 1==k?"rgb("+s(v)+", "+s(j)+", "+s(x)+")":"rgba("+s(v)+", "+s(j)+", "+s(x)+", "+C+")"},toPercentageRgb:function(){return{r:s(100*m(v,255))+"%",g:s(100*m(j,255))+"%",b:s(100*m(x,255))+"%",a:k}},toPercentageRgbString:function(){return 1==k?"rgb("+s(100*m(v,255))+"%, "+s(100*m(j,255))+"%, "+s(100*m(x,255))+"%)":"rgba("+s(100*m(v,255))+"%, "+s(100*m(j,255))+"%, "+s(100*m(x,255))+"%, "+C+")"},toName:function(){return g[f(v,j,x)]||!1},toFilter:function(){var e=f(v,j,x),n=e,o=Math.round(255*parseFloat(k)).toString(16),r=o,i=t&&t.gradientType?"GradientType = 1, ":"";if(secondColor){var s=u(secondColor);n=s.toHex(),r=Math.round(255*parseFloat(s.alpha)).toString(16)}return"progid:DXImageTransform.Microsoft.gradient("+i+"startColorstr=#"+b(o)+e+",endColorstr=#"+b(r)+n+")"},toString:function(e){var t=!1;return"rgb"===(e=e||this.format)&&(t=this.toRgbString()),"prgb"===e&&(t=this.toPercentageRgbString()),"hex"===e&&(t=this.toHexString()),"name"===e&&(t=this.toName()),"hsl"===e&&(t=this.toHslString()),"hsv"===e&&(t=this.toHsvString()),t||this.toHexString()}}}function h(e,t,n){e=m(e,255),t=m(t,255),n=m(n,255);var o,r,i=l(e,t,n),s=a(e,t,n),c=(i+s)/2;if(i==s)o=r=0;else{var u=i-s;switch(r=c>.5?u/(2-i-s):u/(i+s),i){case e:o=(t-n)/u+(t<n?6:0);break;case t:o=(n-e)/u+2;break;case n:o=(e-t)/u+4}o/=6}return{h:o,s:r,l:c}}function d(e,t,n){e=m(e,255),t=m(t,255),n=m(n,255);var o,r,i=l(e,t,n),s=a(e,t,n),c=i,u=i-s;if(r=0===i?0:u/i,i==s)o=0;else{switch(i){case e:o=(t-n)/u+(t<n?6:0);break;case t:o=(n-e)/u+2;break;case n:o=(e-t)/u+4}o/=6}return{h:o,s:r,v:c}}function f(e,t,n){var o=[b(s(e).toString(16)),b(s(t).toString(16)),b(s(n).toString(16))];return o[0].charAt(0)==o[0].charAt(1)&&o[1].charAt(0)==o[1].charAt(1)&&o[2].charAt(0)==o[2].charAt(1)?o[0].charAt(0)+o[1].charAt(0)+o[2].charAt(0):o.join("")}u.fromRatio=function(e){if("object"==typeof e){var t={};for(var n in e)t[n]=w(e[n]);e=t}return u(e)},u.equals=function(e,t){return!(!e||!t)&&u(e).toRgbString()==u(t).toRgbString()},u.random=function(){return u.fromRatio({r:c(),g:c(),b:c()})},u.desaturate=function(e,t){var n=u(e).toHsl();return n.s-=(t||10)/100,n.s=v(n.s),u(n)},u.saturate=function(e,t){var n=u(e).toHsl();return n.s+=(t||10)/100,n.s=v(n.s),u(n)},u.greyscale=function(e){return u.desaturate(e,100)},u.lighten=function(e,t){var n=u(e).toHsl();return n.l+=(t||10)/100,n.l=v(n.l),u(n)},u.darken=function(e,t){var n=u(e).toHsl();return n.l-=(t||10)/100,n.l=v(n.l),u(n)},u.complement=function(e){var t=u(e).toHsl();return t.h=(t.h+180)%360,u(t)},u.triad=function(e){var t=u(e).toHsl(),n=t.h;return[u(e),u({h:(n+120)%360,s:t.s,l:t.l}),u({h:(n+240)%360,s:t.s,l:t.l})]},u.tetrad=function(e){var t=u(e).toHsl(),n=t.h;return[u(e),u({h:(n+90)%360,s:t.s,l:t.l}),u({h:(n+180)%360,s:t.s,l:t.l}),u({h:(n+270)%360,s:t.s,l:t.l})]},u.splitcomplement=function(e){var t=u(e).toHsl(),n=t.h;return[u(e),u({h:(n+72)%360,s:t.s,l:t.l}),u({h:(n+216)%360,s:t.s,l:t.l})]},u.analogous=function(e,t,n){t=t||6,n=n||30;var o=u(e).toHsl(),r=360/n,i=[u(e)];for(o.h=(o.h-(r*t>>1)+720)%360;--t;)o.h=(o.h+r)%360,i.push(u(o));return i},u.monochromatic=function(e,t){t=t||6;for(var n=u(e).toHsv(),o=n.h,r=n.s,i=n.v,s=[],a=1/t;t--;)s.push(u({h:o,s:r,v:i})),i=(i+a)%1;return s},u.readability=function(e,t){var n=u(e).toRgb(),o=u(t).toRgb(),r=(299*n.r+587*n.g+114*n.b)/1e3,i=(299*o.r+587*o.g+114*o.b)/1e3,s=Math.max(n.r,o.r)-Math.min(n.r,o.r)+Math.max(n.g,o.g)-Math.min(n.g,o.g)+Math.max(n.b,o.b)-Math.min(n.b,o.b);return{brightness:Math.abs(r-i),color:s}},u.readable=function(e,t){var n=u.readability(e,t);return n.brightness>125&&n.color>500},u.mostReadable=function(e,t){for(var n,o=0,r=!1,i=0;i<t.length;i++){var s=u.readability(e,t[i]),a=s.brightness>125&&s.color>500,l=s.brightness/125*3+s.color/500;(a&&!r||a&&r&&l>o||!a&&!r&&l>o)&&(r=a,o=l,n=t[i])}return n};var p=u.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},g=u.hexNames=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[e[n]]=n);return t}(p);function m(e,t){(function(e){return"string"==typeof e&&-1!=e.indexOf(".")&&1===parseFloat(e)})(e)&&(e="100%");var n=function(e){return"string"==typeof e&&-1!=e.indexOf("%")}(e);return e=a(t,l(0,parseFloat(e))),n&&(e=parseInt(e*t,10)/100),i.abs(e-t)<1e-6?1:e%t/parseFloat(t)}function v(e){return a(1,l(0,e))}function y(e){return parseInt(e,16)}function b(e){return 1==e.length?"0"+e:""+e}function w(e){return e<=1&&(e=100*e+"%"),e}var j,x,k,T=(x="[\\s|\\(]+("+(j="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+j+")[,|\\s]+("+j+")\\s*\\)?",k="[\\s|\\(]+("+j+")[,|\\s]+("+j+")[,|\\s]+("+j+")[,|\\s]+("+j+")\\s*\\)?",{rgb:new RegExp("rgb"+x),rgba:new RegExp("rgba"+k),hsl:new RegExp("hsl"+x),hsla:new RegExp("hsla"+k),hsv:new RegExp("hsv"+x),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});"undefined"!=typeof module&&module.exports?module.exports=u:void 0!==t?t("tinycolor",[],function(){return u}):e.tinycolor=u}(this),t("elementFinder",["util","jquery"],function(e,t){var n=e.Module("elementFinder"),o=e.assert;return n.ignoreElement=function(e){for(e instanceof t&&(e=e[0]);e;){if(t(e).hasClass("togetherjs"))return!0;e=e.parentNode}return!1},n.elementLocation=function e(n){if(o(null!==n,"Got null element"),n instanceof t&&(n=n[0]),n[0]&&n.attr&&1==n[0].nodeType&&(n=n[0]),n.id)return"#"+n.id;if("BODY"==n.tagName)return"body";if("HEAD"==n.tagName)return"head";if(n===document)return"document";var r=n.parentNode;if(!r||r==n)throw console.warn("elementLocation(",n,") has null parent"),new Error("No locatable parent found");for(var i=e(r),s=r.childNodes,a=s.length,l=0,c=0;c<a&&s[c]!=n;c++)if(s[c].nodeType==document.ELEMENT_NODE){if(s[c].className.indexOf&&-1!=s[c].className.indexOf("togetherjs"))continue;l++}return i+":nth-child("+(l+1)+")"},n.CannotFind=e.Class({constructor:function(e,t,n){this.prefix="",this.location=e,this.reason=t,this.context=n},toString:function(){var e;try{e=n.elementLocation(this.context)}catch(t){e=this.context}return"[CannotFind "+this.prefix+"("+this.location+"): "+this.reason+" in "+e+"]"}}),n.findElement=function e(t,o){var r,i;if(o=o||document,"body"===t)return document.body;if("head"===t)return document.head;if("document"===t)return document;if(0===t.indexOf("body")){r=document.body;try{return e(t.substr("body".length),r)}catch(e){throw e instanceof n.CannotFind&&(e.prefix="body"+e.prefix),e}}else if(0===t.indexOf("head")){r=document.head;try{return e(t.substr("head".length),r)}catch(e){throw e instanceof n.CannotFind&&(e.prefix="head"+e.prefix),e}}else if(0===t.indexOf("#")){var s;if(-1===(t=t.substr(1)).indexOf(":")?(s=t,i=""):(s=t.substr(0,t.indexOf(":")),i=t.substr(t.indexOf(":"))),!(r=document.getElementById(s)))throw n.CannotFind("#"+s,"No element by that id",o);if(!i)return r;try{return e(i,r)}catch(e){throw e instanceof n.CannotFind&&(e.prefix="#"+s+e.prefix),e}}else{if(0!==t.indexOf(":nth-child("))throw n.CannotFind(t,"Malformed location",o);if(-1==(t=t.substr(":nth-child(".length)).indexOf(")"))throw"Invalid location, missing ): "+t;var a=t.substr(0,t.indexOf(")")),l=a=parseInt(a,10);t=t.substr(t.indexOf(")")+1);var c=o.childNodes;r=null;for(var u=0;u<c.length;u++){var h=c[u];if(h.nodeType==document.ELEMENT_NODE){if(c[u].className.indexOf&&-1!=c[u].className.indexOf("togetherjs"))continue;if(0===--l){r=h;break}}}if(!r)throw n.CannotFind(":nth-child("+a+")","container only has "+(a-l)+" elements",o);if(!t)return r;try{return n.findElement(t,r)}catch(e){throw e instanceof n.CannotFind&&(e.prefix=":nth-child("+a+")"+e.prefix),e}}},n.elementByPixel=function(e){return function e(o,r){var i=null,s=o.children();return s.each(function(){var e=t(this);if(!e.hasClass("togetherjs")&&"fixed"!=e.css("position")&&e.is(":visible"))return!(e.offset().top>r)&&void(i=e)}),s.length&&i?e(i,r):{location:n.elementLocation(o[0]),offset:r-o.offset().top,absoluteTop:r,documentHeight:t(document).height()}}(t(document.body),e)},n.pixelForPosition=function(e){if("body"==e.location)return e.offset;var o;try{o=n.findElement(e.location)}catch(o){if(o instanceof n.CannotFind&&e.absoluteTop){var r=e.absoluteTop/e.documentHeight;return t(document).height()*r}throw o}return t(o).offset().top+e.offset},n}),t("visibilityApi",["util","session"],function(e,t){var n,o,r=e.Module("visibilityApi");function i(){t.emit("visibility-change",document[n])}return void 0!==document.hidden?(n="hidden",o="visibilitychange"):void 0!==document.mozHidden?(n="mozHidden",o="mozvisibilitychange"):void 0!==document.msHidden?(n="msHidden",o="msvisibilitychange"):void 0!==document.webkitHidden&&(n="webkitHidden",o="webkitvisibilitychange"),t.on("start",function(){document.addEventListener(o,i,!1)}),t.on("close",function(){document.removeEventListener(o,i,!1)}),r.hidden=function(){return document[n]},r}),t("ui",["require","jquery","util","session","templates","templating","linkify","peers","windowing","tinycolor","elementFinder","visibilityApi","storage"],function(e,t,n,o,r,i,s,a,l,c,u,h,d){var f,p=n.Module("ui"),g=n.assert,m=n.AssertionError,v=t(window),y=null,b=["#8A2BE2","#7FFF00","#DC143C","#00FFFF","#8FBC8F","#FF8C00","#FF00FF","#FFD700","#F08080","#90EE90","#FF6347"];e(["chat"],function(e){f=e}),p.displayToggle=function(e){e=t(e),g(e.length,"No element",arguments[0]);var n=t(e.attr("data-toggles"));g(n.length,"Cannot toggle",e[0],"selector",n.selector),n.hide(),e.show()},p.panelPosition=function(){var e=t("#togetherjs-dock");if(e.hasClass("togetherjs-dock-right"))return"right";if(e.hasClass("togetherjs-dock-left"))return"left";if(e.hasClass("togetherjs-dock-top"))return"top";if(e.hasClass("togetherjs-dock-bottom"))return"bottom";throw new m("#togetherjs-dock doesn't have positioning class")},p.container=null;var w=null;function j(e){return function(){p.container&&e.apply(this,arguments);var t=this,n=Array.prototype.slice.call(arguments);o.once("ui-ready",function(){e.apply(t,n)})}}function x(){var e=t("#togetherjs-menu:visible");if(e.length){const r=p.panelPosition();var n=t("#togetherjs-profile-button"),o=n.offset();e.css("bottom"==r?{left:o.left+10-v.scrollLeft()+"px",top:"",bottom:n.height()+5+"px"}:{left:"right"==r?o.left+n.width()-10-e.width()-v.scrollLeft()+"px":o.left+10-v.scrollLeft()+"px",top:o.top+n.height()-v.scrollTop()+"px",bottom:""}),parseInt(e.css("bottom"))<5&&e.css({left:"right"==r?o.left-e.width()-v.scrollLeft()+"px":o.left+n.width()-v.scrollLeft()+"px",top:"",bottom:"5px"})}}function k(){var e=t("#togetherjs-pick-color:visible");if(e.length){var n=t("#togetherjs-menu-update-color"),o=n.offset();e.css({top:o.top+n.height(),left:o.left})}}function T(){t("#togetherjs-menu").hide(),t(document).unbind("click",C),p.displayToggle("#togetherjs-self-name-display"),t("#togetherjs-pick-color").hide()}function C(e){for(var t=e.target;t;){if("togetherjs-menu"==t.id)return;t=t.parentNode}T()}function S(){const e=t("#togetherjs-dock"),n=parseInt(e.css("right")),o=parseInt(e.css("bottom"));n<5?e.css("left",parseInt(e.css("left"))-5+n+"px"):o<5?e.css("top",parseInt(e.css("top"))-5+o+"px"):d.settings.get("dockConfig").then(t=>e.css(t?t.pos:{right:"5px",top:"5px"}));const r=t("#togetherjs-buttons");t("#togetherjs-dock-participants").children().length?r.removeClass("on"):r.addClass("on")}function E(){var e=t("input.togetherjs-share-link"),n=t("a.togetherjs-share-link"),r=t("#togetherjs-session-id");o.shareId?(e.val(o.shareUrl()),n.attr("href",o.shareUrl()),r.text(o.shareId)):(e.val(""),n.attr("href","#"),r.text("(none)"))}function A(){var e=TogetherJS.config.get("inviteFromRoom");return g(e),n.makeUrlAbsolute(e,o.hubUrl())}p.prepareUI=function(){if("complete"!=document.readyState&&"interactive"!=document.readyState)return w="deferring",void document.addEventListener("DOMContentLoaded",function(){var e=w;w=null,p.prepareUI(),"activate"==e&&p.activateUI()});var e=p.container=t(r.interface);g(e.length),t("body").append(e);const n=e.find("#togetherjs-dock");if(n.css("visibility","hidden"),d.settings.get("dockConfig").then(e=>{e?(e.pos.visibility="",n.addClass(e.class),n.css(e.pos)):(n.addClass("togetherjs-dock-right"),n.css({right:"5px",top:"5px",visibility:""}))}),t("#togetherjs-buttons").addClass("on"),function(e){e.find(".togetherjs-person").each(function(){var e=t(this),n=e.find(".togetherjs-person-avatar-swatch");n.length||e.append('<div class="togetherjs-person-avatar-swatch"></div>')})}(e),o.firstRun&&TogetherJS.startTarget){y=Date.now()+300+50,setTimeout(function(){y=Date.now()+300+40;var e=n.offset(),o=t(TogetherJS.startTarget).offset();o.top=Math.floor(o.top-e.top),o.left=Math.floor(o.left-e.left);var r="translate("+o.left+"px, "+o.top+"px)";n.css({MozTransform:r,WebkitTransform:r,transform:r,opacity:"0.0"}),setTimeout(function(){y=Date.now()+300+20;var e="transform 0.3s ease-out, ";e+="opacity 0.3s ease-out",n.css({opacity:"1.0",MozTransition:"-moz-"+e,MozTransform:"translate(0, 0)",WebkitTransition:"-webkit-"+e,WebkitTransform:"translate(0, 0)",transition:e,transform:"translate(0, 0)"}),setTimeout(function(){y=null,n.attr("style","")},510)},5)},5)}if(TogetherJS.startTarget){var i=t(TogetherJS.startTarget),s=i.text().toLowerCase().replace(/\s+/g," ");"start togetherjs"==(s=s.replace(/^\s*/,"").replace(/\s*$/,""))&&i.attr("data-end-togetherjs-html","End TogetherJS"),i.attr("data-end-togetherjs-html")&&(i.attr("data-start-togetherjs-html",i.html()),i.html(i.attr("data-end-togetherjs-html"))),i.addClass("togetherjs-started")}p.container.find(".togetherjs-window > header, .togetherjs-modal > header").each(function(){t(this).append(t('<button class="togetherjs-close"></button>'))}),TogetherJS.config.track("disableWebRTC",function(e,t){e&&!t?(p.container.find("#togetherjs-audio-button").hide(),S()):!e&&t&&(p.container.find("#togetherjs-audio-button").show(),S())})},p.activateUI=function(){if(w)return console.warn("ui.activateUI called before document is ready; waiting..."),void(w="activate");p.container||p.prepareUI();var r=p.container;t.browser.mobile,p.prepareShareLink(r),r.find("input.togetherjs-share-link").on("keydown",function(e){if(27==e.which)return l.hide("#togetherjs-share"),!1}),o.on("shareId",E);var s=r.find("#togetherjs-chat-input");function u(){var e=s.val();t.trim(e)&&(s.val(""),s.trigger("input").trigger("propertychange"),f.submit(e))}s.bind("keydown",function(e){return 13!=e.which||e.shiftKey?27==e.which?(l.hide("#togetherjs-chat"),!1):void 0:(u(),!1)}),s.on("input propertychange",function(){var e=t(this),n=e.height();e.height(20),this.scrollTop=0,this.scrollTop=9999;var o=this.scrollTop+e.height();o>100?(o=100,this.style.overflowY="scroll"):this.style.overflowY="hidden",this.style.height=o+"px";var r=o-n;return t("#togetherjs-chat-input-box").height(t("#togetherjs-chat-input-box").height()+r),t("#togetherjs-chat-messages").height(t("#togetherjs-chat-messages").height()-r),!1}),n.testExpose({submitChat:u});var h=r.find("#togetherjs-dock-anchor");if(g(h.length),h.mousedown(function(e){const n=t("#togetherjs-dock"),o=parseInt(n.css("left")),r=parseInt(n.css("top"));function i(){return!1}function s(t){let i,s,a=o+t.screenX-e.screenX,l=r+t.screenY-e.screenY;n.css({right:"",bottom:""}),n.lockedHor?a<5?(a="5px",i=""):(n.css("left",a+"px"),parseInt(n.css("right"))<5&&(a="",i="5px")):a<50?(n.lockedVert=!0,a="5px",i=""):(n.css("left",a+"px"),parseInt(n.css("right"))<50?(n.lockedVert=!0,a="",i="5px"):n.lockedVert=!1),n.lockedVert?l<5?(l="5px",s=""):(n.css("top",l+"px"),parseInt(n.css("bottom"))<5&&(l="",s="5px")):l<50?(n.lockedHor=!0,l="5px",s=""):(n.css("top",l+"px"),n.threshold&&l>n.threshold||!n.threshold&&parseInt(n.css("bottom"))<50?(n.lockedHor=!0,l="",s="5px"):(n.lockedHor=!1,delete n.threshold)),n.css({left:a,right:i,top:l,bottom:s}),n.lockedHor?"5px"==n.css("bottom")?(n.threshold||(n.threshold=parseInt(n.css("top"))-50),n.removeClass("togetherjs-dock-left togetherjs-dock-right togetherjs-dock-top"),n.addClass("togetherjs-dock-bottom")):(n.removeClass("togetherjs-dock-left togetherjs-dock-right togetherjs-dock-bottom"),n.addClass("togetherjs-dock-top")):parseInt(n.css("right"))<330?(n.removeClass("togetherjs-dock-left togetherjs-dock-top togetherjs-dock-bottom"),n.addClass("togetherjs-dock-right")):(n.removeClass("togetherjs-dock-right togetherjs-dock-top togetherjs-dock-bottom"),n.addClass("togetherjs-dock-left"))}return t("#togetherjs-menu").hide(),l.hide(),t(document).bind("mousemove",s),t(document).bind("selectstart",i),t(document).one("mouseup",function(){const e=n[0].style,o={};e.left?o.left=e.left:o.right=e.right,e.top?o.top=e.top:o.bottom=e.bottom,d.settings.set("dockConfig",{pos:o,class:n.hasClass("togetherjs-dock-right")?"togetherjs-dock-right":n.hasClass("togetherjs-dock-top")?"togetherjs-dock-top":n.hasClass("togetherjs-dock-bottom")?"togetherjs-dock-bottom":"togetherjs-dock-left"}),t(document).unbind("mousemove",s),t(document).unbind("selectstart",i)}),!1}),t.browser.mobile){t("#togetherjs-audio-button").click(function(){l.toggle("#togetherjs-rtc-not-supported")}),t("#togetherjs-profile-button").click(function(){l.toggle("#togetherjs-menu-window")});t("#togetherjs-dock-anchor #togetherjs-dock-anchor-horizontal img").attr("src","/togetherjs/images/togetherjs-logo-close.png"),t("#togetherjs-dock-anchor").toggle(function(){t("body").css({position:"",top:"",left:""}),t("#togetherjs-dock-anchor #togetherjs-dock-anchor-horizontal img").attr("src","/togetherjs/images/togetherjs-logo-open.png"),t(".togetherjs-window").animate({opacity:0}),t("#togetherjs-dock-participants").animate({opacity:0}),t("#togetherjs-dock #togetherjs-buttons").animate({opacity:0}),t(".togetherjs-dock-right").animate({width:"40px"},{duration:60,easing:"linear"})},function(){t(".togetherjs-window").animate({opacity:1}),t("#togetherjs-dock-participants").animate({opacity:1}),t("#togetherjs-dock #togetherjs-buttons").animate({opacity:1}),t(window).width()<480?t(".togetherjs-dock-right").animate({width:"204px"},{duration:60,easing:"linear"}):t(".togetherjs-dock-right").animate({width:"27%"},{duration:60,easing:"linear"}),t("#togetherjs-dock-anchor #togetherjs-dock-anchor-horizontal img").attr("src","/togetherjs/images/togetherjs-logo-close.png")})}t("#togetherjs-share-button").click(function(){l.toggle("#togetherjs-share")}),t("#togetherjs-profile-button").click(function(e){return t.browser.mobile?(l.show("#togetherjs-menu-window"),!1):(t("#togetherjs-menu").is(":visible")?T():(n=t("#togetherjs-menu"),g(n.length),n.show(),x(),t(document).bind("click",C)),e.stopPropagation(),!1);var n}),t("#togetherjs-menu-feedback, #togetherjs-menu-feedback-button").click(function(){l.hide(),T(),l.show("#togetherjs-feedback-form")}),t("#togetherjs-menu-help, #togetherjs-menu-help-button").click(function(){l.hide(),T(),e(["walkthrough"],function(e){l.hide(),e.start(!1)})}),t("#togetherjs-menu-update-name").click(function(){t("#togetherjs-menu .togetherjs-self-name").css({width:t("#togetherjs-menu").width()-32+"px"}),p.displayToggle("#togetherjs-menu .togetherjs-self-name"),t("#togetherjs-menu .togetherjs-self-name").focus()}),t("#togetherjs-menu-update-name-button").click(function(){l.show("#togetherjs-edit-name-window"),t("#togetherjs-edit-name-window input").focus()}),t("#togetherjs-menu .togetherjs-self-name").bind("keyup change",function(e){if(13!=e.which){var n=t("#togetherjs-menu .togetherjs-self-name").val();n&&a.Self.update({name:n})}else p.displayToggle("#togetherjs-self-name-display")}),t("#togetherjs-menu-update-avatar, #togetherjs-menu-update-avatar-button").click(function(){T(),l.show("#togetherjs-avatar-edit")}),t("#togetherjs-menu-end, #togetherjs-menu-end-button").click(function(){T(),l.show("#togetherjs-confirm-end")}),t("#togetherjs-end-session").click(function(){o.close()}),t("#togetherjs-menu-update-color").click(function(){var e=t("#togetherjs-pick-color");e.is(":visible")?e.hide():(e.show(),k(),e.find(".togetherjs-swatch-active").removeClass("togetherjs-swatch-active"),e.find('.togetherjs-swatch[data-color="'+a.Self.color+'"]').addClass("togetherjs-swatch-active"))}),t("#togetherjs-pick-color").click(".togetherjs-swatch",function(e){var n=t(e.target).attr("data-color");return a.Self.update({color:n}),e.stopPropagation(),!1}),t("#togetherjs-pick-color").click(function(e){return t("#togetherjs-pick-color").hide(),e.stopPropagation(),!1}),b.forEach(function(e){var n=i.sub("swatch");n.attr("data-color",e);var o=c.darken(e);n.css({backgroundColor:e,borderColor:o}),t("#togetherjs-pick-color").append(n)}),t("#togetherjs-chat-button").click(function(){l.toggle("#togetherjs-chat")}),o.on("display-window",function(e,n){if("togetherjs-chat"==e)t.browser.mobile||t("#togetherjs-chat-input").focus();else if("togetherjs-share"==e){var o=n.find("input.togetherjs-share-link");o.is(":visible")&&o.focus().select()}}),r.find("#togetherjs-chat-notifier").click(function(e){t(e.target).is("a")||r.is(".togetherjs-close")||l.show("#togetherjs-chat")}),t(".togetherjs header.togetherjs-title").each(function(e,n){var o=t('<button class="togetherjs-minimize"></button>');o.click(function(e){var t=o.closest(".togetherjs-window");l.hide(t)}),t(n).append(o)}),t("#togetherjs-avatar-done").click(function(){p.displayToggle("#togetherjs-no-avatar-edit")}),t("#togetherjs-self-color").css({backgroundColor:a.Self.color});var m=a.Self.avatar;m&&t("#togetherjs-self-avatar").attr("src",m);var v=t("#togetherjs-starter button");v.click(function(){l.show("#togetherjs-about")}).addClass("togetherjs-running"),"Start TogetherJS"==v.text()&&(v.attr("data-start-text",v.text()),v.text("End TogetherJS Session")),p.activateAvatarEdit(r,{onSave:function(){l.hide("#togetherjs-avatar-edit")}}),TogetherJS.config.track("inviteFromRoom",function(e,t){e?r.find("#togetherjs-invite").show():r.find("#togetherjs-invite").hide()}),r.find("#togetherjs-menu-refresh-invite").click(N),r.find("#togetherjs-menu-invite-anyone").click(function(){_(null)}),o.emit("new-element",p.container),y&&y>Date.now()?setTimeout(function(){y=null,o.emit("ui-ready",p)},y-Date.now()):o.emit("ui-ready",p)},p.activateAvatarEdit=function(e,r){r=r||{};var i=null;e.find(".togetherjs-avatar-save").prop("disabled",!0),e.find(".togetherjs-avatar-save").click(function(){i&&(a.Self.update({avatar:i}),e.find(".togetherjs-avatar-save").prop("disabled",!0),r.onSave&&r.onSave())}),e.find(".togetherjs-upload-avatar").on("change",function(){n.readFileImage(this).then(function(s){var a;(a=s,n.Deferred(function(e){var n=t("<canvas>");n[0].height=o.AVATAR_SIZE,n[0].width=o.AVATAR_SIZE;var r=n[0].getContext("2d"),i=new Image;i.src=a,setTimeout(function(){var t=i.naturalWidth||i.width,s=i.naturalHeight||i.height;t*=o.AVATAR_SIZE/s,s=o.AVATAR_SIZE,r.drawImage(i,0,0,t,s),e.resolve(n[0].toDataURL("image/png"))})})).then(function(t){i=t,e.find(".togetherjs-avatar-preview").css({backgroundImage:"url("+i+")"}),e.find(".togetherjs-avatar-save").prop("disabled",!1),r.onPending&&r.onPending()})})})},p.prepareShareLink=function(e){e.find("input.togetherjs-share-link").click(function(){t(this).select()}).change(function(){E()}),e.find("a.togetherjs-share-link").click(function(){return!1}),E()},o.on("resize",function(){x(),k()}),o.on("close",function(){t.browser.mobile&&t("body").css({position:"",top:"",left:""}),p.container&&(p.container.remove(),p.container=null),t(".togetherjs").remove();var e=t("#togetherjs-starter button");if(e.removeClass("togetherjs-running"),e.attr("data-start-text")&&(e.text(e.attr("data-start-text")),e.attr("data-start-text","")),TogetherJS.startTarget){var n=t(TogetherJS.startTarget);n.attr("data-start-togetherjs-html")&&n.html(n.attr("data-start-togetherjs-html")),n.removeClass("togetherjs-started")}}),p.chat={text:function(e){g("string"==typeof e.text),g(e.peer),g(e.messageId);var n=e.date||Date.now(),o=p.container.find("#togetherjs-chat .togetherjs-chat-message");o.length&&(o=t(o[o.length-1]));var r=null;if(o&&(r=parseInt(o.attr("data-date"),10)),o&&o.attr("data-person")==e.peer.id&&r&&n<r+5e3){o.attr("data-date",n);var a=o.find(".togetherjs-chat-content");g(a.length),e.text=a.text()+"\n"+e.text,e.messageId=o.attr("data-message-id"),o.remove()}var l=i.sub("chat-message",{peer:e.peer,content:e.text,date:n});s(l.find(".togetherjs-chat-content")),l.attr("data-person",e.peer.id).attr("data-date",n).attr("data-message-id",e.messageId),p.chat.add(l,e.messageId,e.notify)},joinedSession:function(e){g(e.peer);var t=e.date||Date.now(),n=i.sub("chat-joined",{peer:e.peer,date:t});p.chat.add(n,e.peer.className("join-message-"),4e3)},leftSession:function(e){g(e.peer);var t=e.date||Date.now(),n=i.sub("chat-left",{peer:e.peer,date:t,declinedJoin:e.declinedJoin});p.chat.add(n,e.peer.className("join-message-"),4e3)},system:function(e){g(!e.peer),g("string"==typeof e.text);var t=e.date||Date.now(),n=i.sub("chat-system",{content:e.text,date:t});p.chat.add(n,void 0,!0)},clear:j(function(){p.container.find("#togetherjs-chat-messages").empty()}),urlChange:function(e){g(e.peer),g("string"==typeof e.url),g("boolean"==typeof e.sameUrl);var n,o=e.peer.className("url-change-"),r="togetherjs-chat-"+o,s=e.date||Date.now();n=e.title?e.title+" ("+e.url+")":e.url;var a=i.sub("url-change",{peer:e.peer,date:s,href:e.url,title:n,sameUrl:e.sameUrl});a.find(".togetherjs-nudge").click(function(){return e.peer.nudge(),!1}),a.find(".togetherjs-follow").click(function(){var t=e.peer.url;e.peer.urlHash&&(t+=e.peer.urlHash),location.href=t});var l=!e.sameUrl;e.sameUrl&&!t("#"+r).length||p.chat.add(a,o,l)},invite:function(e){g(e.peer),g("string"==typeof e.url);var t=e.peer.className("invite-"),n=e.date||Date.now(),o=e.url.replace(/\#?&togetherjs=.*/,"").replace(/^\w+:\/\//,""),r=i.sub("invite",{peer:e.peer,date:n,href:e.url,hrefTitle:o,forEveryone:e.forEveryone});e.forEveryone&&r.find("a").click(function(){f.submit("Followed link to "+e.url)}),p.chat.add(r,t,!0)},hideTimeout:null,add:j(function(e,t,o){t&&e.attr("id","togetherjs-chat-"+n.safeClassName(t));var r=p.container.find("#togetherjs-chat-messages");g(r.length);var i=p.container.find("#togetherjs-chat-notifier");r.append(e),p.chat.scroll();var s=!!o,a=i.find("#togetherjs-chat-notifier-message");o&&h.hidden()&&p.container.find("#togetherjs-notification")[0].play(),t&&a.data("message-id")==t&&(s=!0),r.is(":visible")&&(s=!1),s&&(a.empty(),a.append(e.clone(!0,!0)),a.data("message-id")!=t?(a.data("message-id",t||""),l.show(i)):i.is(":visible")||l.show(i),"number"==typeof o&&(this.hideTimeout&&(clearTimeout(this.hideTimeout),this.hideTimeout=null),this.hideTimeout=setTimeout(function(){l.hide(i),this.hideTimeout=null}.bind(this),o)))}),scroll:j(function(){var e=p.container.find("#togetherjs-chat-messages")[0];e.scrollTop=e.scrollHeight})},o.on("display-window",function(e,n){"togetherjs-chat"==e&&(p.chat.scroll(),l.hide("#togetherjs-chat-notifier"),t("#togetherjs-window-pointer").show())}),p.PeerView=n.Class({constructor:function(e){g(void 0!==e.isSelf,"PeerView instantiated with non-Peer object"),this.peer=e,this.dockClick=this.dockClick.bind(this)},setElement:function(e){var t=0;["togetherjs-person","togetherjs-person-status","togetherjs-person-name","togetherjs-person-name-abbrev","togetherjs-person-bgcolor","togetherjs-person-swatch","togetherjs-person-status","togetherjs-person-role","togetherjs-person-url","togetherjs-person-url-title","togetherjs-person-bordercolor"].forEach(function(n){var o=e.find("."+n);o.addClass(this.peer.className(n+"-")),t+=o.length},this),t||console.warn("setElement(",e,") doesn't contain any person items"),this.updateDisplay(e)},updateDisplay:j(function(e){e=e||p.container;var r=this.peer.name;this.peer.isSelf&&(r="me"),e.find("."+this.peer.className("togetherjs-person-name-")).text(this.peer.name||""),e.find("."+this.peer.className("togetherjs-person-name-abbrev-")).text(r);var i=e.find("."+this.peer.className("togetherjs-person-"));if(this.peer.avatar&&(n.assertValidUrl(this.peer.avatar),i.css({backgroundImage:"url("+this.peer.avatar+")"})),"inactive"==this.peer.idle?i.addClass("togetherjs-person-inactive"):i.removeClass("togetherjs-person-inactive"),i.attr("title",this.peer.name),this.peer.color&&(i.css({borderColor:this.peer.color}),i.find(".togetherjs-person-avatar-swatch").css({borderTopColor:this.peer.color,borderRightColor:this.peer.color})),this.peer.color){var s=e.find("."+this.peer.className("togetherjs-person-bgcolor-"));s.css({backgroundColor:this.peer.color}),(s=e.find("."+this.peer.className("togetherjs-person-bordercolor-"))).css({borderColor:this.peer.color})}e.find("."+this.peer.className("togetherjs-person-role-")).text(this.peer.isCreator?"Creator":"Participant");var l=this.peer.title||"";this.peer.title&&(l+=" ("),l+=n.truncateCommonDomain(this.peer.url,location.href),this.peer.title&&(l+=")"),e.find("."+this.peer.className("togetherjs-person-url-title-")).text(l);var c,u=this.peer.url;(this.peer.urlHash&&(u+=this.peer.urlHash),e.find("."+this.peer.className("togetherjs-person-url-")).attr("href",u),e.find("."+this.peer.className("togetherjs-person-status-")).text("active"==this.peer.idle?"Active":"Inactive"),this.peer.isSelf)&&(t(".togetherjs-self-name").each(function(e,n){(n=t(n)).val()!=this.peer.name&&n.val(this.peer.name)}.bind(this)),t("#togetherjs-menu-avatar").attr("src",this.peer.avatar),this.peer.name||t("#togetherjs-menu .togetherjs-person-name-self").text(this.peer.defaultName));this.peer.url!=o.currentUrl()?e.find("."+this.peer.className("togetherjs-person-")).addClass("togetherjs-person-other-url"):e.find("."+this.peer.className("togetherjs-person-")).removeClass("togetherjs-person-other-url"),this.peer.following?this.followCheckbox&&this.followCheckbox.prop("checked",!0):this.followCheckbox&&this.followCheckbox.prop("checked",!1),(c=a.getAllPeers(!0)).length?(p.displayToggle("#togetherjs-chat-participants"),t("#togetherjs-chat-participant-list").text(c.map(function(e){return e.name}).join(", "))):p.displayToggle("#togetherjs-chat-no-participants"),this.updateFollow()}),update:function(){this.peer.isSelf||("live"==this.peer.status?this.dock():this.undock()),this.updateDisplay(),this.updateUrlDisplay()},updateUrlDisplay:function(e){var t=this.peer.url;if(t&&(t!=this._lastUpdateUrlDisplay||e)){this._lastUpdateUrlDisplay=t;var n=t==o.currentUrl();p.chat.urlChange({peer:this.peer,url:this.peer.url,title:this.peer.title,sameUrl:n})}},urlNudge:function(){this.updateUrlDisplay(!0)},notifyJoined:function(){p.chat.joinedSession({peer:this.peer})},dock:j(function(){if(this.dockElement)return;this.dockElement=i.sub("dock-person",{peer:this.peer}),this.dockElement.attr("id",this.peer.className("togetherjs-dock-element-")),p.container.find("#togetherjs-dock-participants").append(this.dockElement),this.dockElement.find(".togetherjs-person").animateDockEntry();const e=a.getAllPeers(!0).length;if(e>4){t("#togetherjs-dock-participants .togetherjs-dock-person:not(:first-of-type").each(function(){this.style.setProperty("--offset",-61*(e-4)/(e-1)+"px")});const n=t("#togetherjs-dock-participants");n[0].hasListener||(n.mouseenter(S),n.mouseleave(S),n[0].hasListener=!0)}S(),this.detailElement=i.sub("participant-window",{peer:this.peer});var n=this.peer.className("togetherjs-person-status-follow-");this.detailElement.find('[for="togetherjs-person-status-follow"]').attr("for",n),this.detailElement.find("#togetherjs-person-status-follow").attr("id",n),this.detailElement.find(".togetherjs-follow").click(function(){location.href=t(this).attr("href")}),this.detailElement.find(".togetherjs-nudge").click(function(){this.peer.nudge()}.bind(this)),this.followCheckbox=this.detailElement.find("#"+n),this.followCheckbox.change(function(){this.checked||this.peer.unfollow()}),this.maybeHideDetailWindow=this.maybeHideDetailWindow.bind(this),o.on("hide-window",this.maybeHideDetailWindow),t("#togetherjs-feedback-form").after(this.detailElement),this.dockElement.click(function(){this.detailElement.is(":visible")?l.hide(this.detailElement):(l.show(this.detailElement,{bind:this.dockElement}),this.scrollTo(),this.cursor().element.animate({opacity:.3}).animate({opacity:1}).animate({opacity:.3}).animate({opacity:1}))}.bind(this)),this.updateFollow()}),undock:function(){if(this.dockElement){if(a.getAllPeers(!0).length<=4){t("#togetherjs-dock-participants .togetherjs-dock-person:not(:first-of-type").each(function(){this.style.removeProperty("--offset")});const e=t("#togetherjs-dock-participants");e[0].hasListener&&(e.off("mouseenter"),e.off("mouseleave"),delete e[0].hasListener)}this.dockElement.find(".togetherjs-person").animateDockExit().promise().then(function(){this.dockElement.remove(),this.dockElement=null,this.detailElement.remove(),this.detailElement=null,S()}.bind(this))}},scrollTo:function(){if(this.peer.url==o.currentUrl()){var e=this.peer.scrollPosition;e?(e=u.pixelForPosition(e),t("html, body").easeTo(e)):console.warn("Peer has no scroll position:",this.peer)}},updateFollow:function(){if(this.peer.url&&this.detailElement){var e=this.detailElement.find(".togetherjs-same-url"),t=this.detailElement.find(".togetherjs-different-url");this.peer.url==o.currentUrl()?(e.show(),t.hide()):(e.hide(),t.show())}},maybeHideDetailWindow:function(e){this.detailElement&&e[0]&&e[0][0]===this.detailElement[0]&&(this.followCheckbox[0].checked?this.peer.follow():this.peer.unfollow())},dockClick:function(){},cursor:function(){return e("cursor").getClient(this.peer.id)},destroy:function(){o.off("hide-window",this.maybeHideDetailWindow)}});var I=!1;function N(){I||(I=!0,e(["who"],function(e){var n=e.getList(A());function o(e,n){var o=i.sub("invite-user-item",{peer:e});o.attr("data-clientid",e.id),n?o.insertBefore(n):t("#togetherjs-invite-users").append(o),o.click(function(){_(e.clientId)})}function r(e,n){var r=[];for(var i in e)e.hasOwnProperty(i)&&r.push(e[i]);r.sort(function(e,t){return e.name<t.name?-1:1});var s=0;p.container.find("#togetherjs-invite-users .togetherjs-menu-item").each(function(){var i=t(this);if(!n||e[i.attr("data-clientid")]){if(!(s>=r.length)){for(;s<r.length&&i.attr("data-clientid")!==r[s].id;)o(r[s],i),s++;for(;s<r.length&&i.attr("data-clientid")==r[s].id;)s++}}else i.remove()});for(var a=s;a<r.length;a++)o(r[s])}n.then(function(e){r(e,!0),I=!1}),n.progress(r)}))}function _(t){e(["who"],function(e){e.invite(A(),t).then(function(){T()})})}o.hub.on("invite",function(t){t.forClientId&&t.clientId!=a.Self.id||e(["who"],function(e){var n=e.ExternalPeer(t.userInfo.clientId,t.userInfo);p.chat.invite({peer:n,url:t.url,forEveryone:!t.forClientId})})}),p.showUrlChangeMessage=j(function(e,t){var n=i.sub("url-change",{peer:e});p.container.append(n),l.show(n)}),o.hub.on("url-change-nudge",function(e){e.to&&e.to!=o.clientId||e.peer.urlNudge()}),o.on("new-element",function(e){TogetherJS.config.get("toolName")&&p.updateToolName(e)});var D=!1;return p.updateToolName=function(e){e=e||t(document.body);var n=TogetherJS.config.get("toolName");D&&!n&&(n="TogetherJS"),n&&(e.find(".togetherjs-tool-name").text(n),D=!0)},TogetherJS.config.track("toolName",function(e){p.updateToolName(p.container)}),p}),t("playback",["jquery","util","session","storage","require"],function(e,t,n,o,r){var i=t.Module("playback"),s=(t.assert,{"cursor-update":!0,"scroll-update":!0});function a(e){e=(e=e.replace(/\r\n/g,"\n")).split(/\n/g);for(var t=[],n=0;n<e.length;n++){var o=e[n];if(0===(o=o.replace(/^\s+/,"").replace(/\s+$/,"")).search(/\/\*/)){var r=o.search(/\*\//);if(-1==r){console.warn("bad line:",o);continue}o=o.substr(r+2)}(o=o.replace(/^\s+/,""))&&(o=JSON.parse(o),t.push(o))}return l(t)}i.getLogs=function(t){return 0===t.search(/^local:/)?e.Deferred(function(e){o.get("recording."+t.substr("local:".length)).then(function(t){t?(t=a(t),e.resolve(t)):e.resolve(null)},function(t){e.reject(t)})}):e.Deferred(function(n){e.ajax({url:t,dataType:"text"}).then(function(e){e=a(e),n.resolve(e)},function(e){n.reject(e)})})};var l=t.Class({constructor:function(e,t){this.logs=e,this.fromStorage=t,this.pos=0},play:function(){if(this.start=Date.now(),this.pos>=this.logs.length)this.unload();else{if(0!==this.pos){for(var e=[],t=!1,n=this.pos-1;n>=0;n--){var o=this.logs[n];if(s[o.type]&&e.push(o),"hello"==o.type||"hello-back"==o.type){this.playItem(o),t=!0;break}}for(t||console.warn("No hello message found before position",this.pos),e.reverse(),n=0;n<e.length;n++)this.playItem(e[n])}this.playOne()}},cancel:function(){this.playTimer&&(clearTimeout(this.playTimer),this.playTimer=null),this.start=null,this.pos=0,this.unload()},pause:function(){this.playTimer&&(clearTimeout(this.playTimer),this.playTimer=null)},playOne:function(){if(this.playTimer=null,this.pos>=this.logs.length)this.unload();else{var e=this.logs[this.pos];if(this.playItem(e),this.pos++,this.pos>=this.logs.length)this.unload();else{var t=this.logs[this.pos].date-e.date;this.playTimer=setTimeout(this.playOne.bind(this),t),this.fromStorage&&this.savePos()}}},playItem:function(e){"hello"==e.type&&e.url!=(location.href+"").replace(/\#.*/,"")&&this.pause();try{n._getChannel().onmessage(e)}catch(t){console.warn("Could not play back message:",e,"error:",t)}},save:function(){this.fromStorage=!0,o.set("playback.logs",this.logs),this.savePos()},savePos:function(){o.set("playback.pos",this.pos)},unload:function(){this.fromStorage&&(o.set("playback.logs",void 0),o.set("playback.pos",void 0))}});return i.getRunningLogs=function(){return o.get("playback.logs").then(function(e){if(!e)return null;var t=l(e,!0);return o.get("playback.pos").then(function(e){return e=e||0,t.pos=e,t})})},i}),t("chat",["require","jquery","util","session","ui","templates","playback","storage","peers","windowing"],function(e,t,n,o,r,i,s,a,l,c){var u,h=n.Module("chat"),d=n.assert;o.hub.on("chat",function(e){r.chat.text({text:e.text,peer:e.peer,messageId:e.messageId,notify:!0}),m({text:e.text,date:Date.now(),peerId:e.peer.id,messageId:e.messageId})}),o.hub.on("bye",function(e){r.chat.leftSession({peer:e.peer,declinedJoin:"declined-join"==e.reason})}),h.submit=function(e){var t=e.split(/ /);if("/"==t[0].charAt(0)){var n=t[0].substr(1).toLowerCase(),i=f["command_"+n];if(i)return void i.apply(null,t.slice(1))}var s=o.clientId+"-"+Date.now();o.send({type:"chat",text:e,messageId:s}),r.chat.text({text:e,peer:l.Self,messageId:s,notify:!1}),m({text:e,date:Date.now(),peerId:l.Self.id,messageId:s})};var f={command_help:function(){var e=n.trim(i.help);r.chat.system({text:e})},command_test:function(o){if(u){if(""!==(o=n.trim(o||"").split(/\s+/g))[0]&&o.length||(o=this._testCancel?["cancel"]:["start"]),"cancel"==o[0])return r.chat.system({text:"Aborting test"}),this._testCancel(),void(this._testCancel=null);if("start"==o[0]){var s=parseInt(o[1],10);!isNaN(s)&&s||(s=100),r.chat.system({text:"Testing with walkabout.js"});var a=t(i.walkabout),l=r.container.find(".togetherjs-test-container");l.empty(),l.append(a),l.show();var c=l.find(".togetherjs-status");return c.text("starting..."),void(this._testCancel=u.runManyActions({ondone:function(){c.text("done"),c.one("click",function(){l.hide()}),this._testCancel=null},onstatus:function(e){var t="actions: "+e.actions.length+" running: "+(e.times-e.remaining)+" / "+e.times;c.text(t)}}))}if("show"!=o[0])"describe"!=o[0]?r.chat.system({text:"Did not understand: "+o.join(" ")}):u.findActions().forEach(function(e){r.chat.system({text:e.description()})},this);else this._testShow.length?(this._testShow.forEach(function(e){e&&e.remove()},this),this._testShow=[]):u.findActions().forEach(function(e){this._testShow.push(e.show())},this)}else e(["walkabout"],function(e){u=e,this.command_test(o)}.bind(this))},_testCancel:null,_testShow:[],command_clear:function(){r.chat.clear()},command_exec:function(){var e,t=Array.prototype.slice.call(arguments).join(" "),n=eval;try{e=n(t)}catch(e){r.chat.system({text:"Error: "+e})}void 0!==e&&r.chat.system({text:""+e})},command_record:function(){r.chat.system({text:"When you see the robot appear, the recording will have started"}),window.open(o.recordUrl(),"_blank","left,width="+t(window).width()/2)},playing:null,command_playback:function(e){if(this.playing)return this.playing.cancel(),this.playing.unload(),this.playing=null,void r.chat.system({text:"playback cancelled"});e?(s.getLogs(e).then(function(e){e?(e.save(),this.playing=e,e.play()):r.chat.system({text:"No logs found."})}.bind(this),function(t){r.chat.system({text:"Error fetching "+e+":\n"+JSON.stringify(t,null,"  ")})}),c.hide("#togetherjs-chat")):r.chat.system({text:"Nothing is playing"})},command_savelogs:function(e){o.send({type:"get-logs",forClient:o.clientId,saveAs:e}),o.hub.on("logs",function t(n){n.request.forClient==o.clientId&&n.request.saveAs==e&&a.set("recording."+e,n.logs).then(function(){o.hub.off("logs",t),r.chat.system({text:"Saved as local:"+e})})})},command_baseurl:function(e){e?(e=e.replace(/\/*$/,""),r.chat.system({text:"If this goes wrong, do this in the console to reset:\n  localStorage.setItem('togetherjs.baseUrlOverride', null)"}),a.set("baseUrlOverride",{baseUrl:e,expiresAt:Date.now()+864e5}).then(function(){r.chat.system({text:"baseUrl overridden (to "+e+"), will last for one day."})})):a.get("baseUrlOverride").then(function(e){e?r.chat.system({text:"Set to: "+e.baseUrl}):r.chat.system({text:"No baseUrl override set"})})},command_config:function(e,t){if(e||t){if("clear"==e)return a.set("configOverride",void 0),void r.chat.system({text:"Clearing all overridden configuration"});if(e&&t){try{t=JSON.parse(t)}catch(e){return void r.chat.system({text:"Error: value ("+t+") could not be parsed: "+e})}TogetherJS._defaultConfiguration.hasOwnProperty(e)||r.chat.system({text:"Warning: variable "+e+" is unknown"}),a.get("configOverride").then(function(n){(n=n||{})[e]=t,n.expiresAt=Date.now()+864e5,a.set("configOverride",n).then(function(){r.chat.system({text:"Variable "+e+" = "+JSON.stringify(t)+"\nValue will be set for one day."})})})}else r.chat.system({text:"Error: must provide /config VAR VALUE"})}else a.get("configOverride").then(function(e){e?(n.forEachAttr(e,function(e,t){"expiresAt"!=t&&r.chat.system({text:"  "+t+" = "+JSON.stringify(e)})}),r.chat.system({text:"Config expires at "+new Date(e.expiresAt)})):r.chat.system({text:"No config override"})})}},p="chatlog",g=100;function m(e){d(e.peerId),d(e.messageId),d(e.date),d("string"==typeof e.text),v().then(function(t){for(var n=t.length-1;n>=0;n--)if(t[n].messageId===e.messageId)return;t.push(e),t.length>g&&t.splice(0,t.length-g),a.tab.set(p,t)})}function v(){return a.tab.get(p,[])}return o.once("ui-ready",function(){v().then(function(e){if(e)for(var t=0;t<e.length;t++){var n=l.getPeer(e[t].peerId);r.chat.text({text:e[t].text,date:e[t].date,peer:n,messageId:e[t].messageId})}})}),o.on("close",function(){a.tab.set(p,void 0)}),h}),t("console",["util"],function(e){var t=window.console||{log:function(){}},n=e.Class({constructor:function(){this.messages=[],this.level=this.levels.log},messageLimit:100,levels:{debug:1,log:2,info:3,notify:4,warn:5,error:6,fatal:7},maxLevel:0,consoleLevels:[[],t.debug||[],t.log||[],t.info||[],t.notify||[],t.warn||[],t.error||[],t.fatal||[]],levelNames:{},setLevel:function(e){var t;if("string"==typeof e){if(void 0===(t=this.levels[e]))throw new Error("Tried to set Console level to unknown level string: "+e);e=t}if("function"==typeof e){if(-1==(t=this.consoleLevels.indexOf(e)))throw new Error("Tried to set Console level based on unknown console function: "+e);e=t}if("number"==typeof e){if(e<0)throw new Error("Console level must be 0 or larger: "+e);if(e>this.maxLevel)throw new Error("Console level must be "+this.maxLevel+" or smaller: "+e)}this.level=e},write:function(e){try{this.messages.push([Date.now(),e,this._stringify(Array.prototype.slice.call(arguments,1))])}catch(e){t.warn("Error stringifying argument:",e)}if("suppress"!=e&&this.level<=e){var n=t[this.levelNames[e]];n||(n=t.log),n.apply(t,Array.prototype.slice.call(arguments,1))}},suppressedWrite:function(){this.write.apply(this,["suppress"].concat(Array.prototype.slice.call(arguments)))},trace:function(e){e=e||"log",t.trace&&(e="suppressedWrite");try{throw new Error}catch(t){var n=t.stack;n=n.replace(/^[^\n]*\n/,""),this[e](n)}t.trace&&t.trace()},_browserInfo:function(){return["TogetherJS base URL: "+TogetherJS.baseUrl,"User Agent: "+navigator.userAgent,"Page loaded: "+this._formatDate(TogetherJS.pageLoaded),"Age: "+this._formatMinutes(Date.now()-TogetherJS.pageLoaded)+" minutes","URL: "+location.href,"------+------+----------------------------------------------"]},_stringify:function(e){for(var t="",n=0;n<e.length;n++)t&&(t+=" "),t+=this._stringifyItem(e[n]);return t},_stringifyItem:function(e){if("string"==typeof e)return""===e?'""':e;if("object"==typeof e&&e.repr)try{return e.repr()}catch(n){t.warn("Error getting object repr:",e,n)}return null!==e&&"object"==typeof e&&(e=JSON.stringify(e)),e.toString()},_formatDate:function(e){return new Date(e).toISOString()},_formatTime:function(e){return((e-TogetherJS.pageLoaded)/1e3).toFixed(2)},_formatMinutes:function(e){var t=Math.floor(e/1e3/60),n=e-1e3*t*60;if(t>10)return t;var r=Math.floor(n/1e3)+"";return t+=":","0:00"==(t+=r=o(r,2,"0"))&&(t+=((n/1e3).toFixed(3)+"").substr(1)),t},_formatLevel:function(e){return"suppress"===e?"":this.levelNames[e]},toString:function(){try{var e=this._browserInfo();return this.messages.forEach(function(t){e.push(o(this._formatTime(t[0]),6)+" "+function(e,t,n){e+="",n=n||" ";for(;e.length<t;)e+=n;return e}(this._formatLevel(t[1]),6)+" "+function(e,t,n){var o;if(-1==(e+="").indexOf("\n"))return e;n=n||" ";var r="";for(o=0;o<t;o++)r+=n;for(e=e.split(/\n/g),o=1;o<e.length;o++)e[o]=r+e[o];return e.join("\n")}(t[2],14))},this),e.join("\n")}catch(e){throw t.warn("Error running console.toString():",e),e}},submit:function(t){return e.Deferred(function(e){var n=(t=t||{}).site||TogetherJS.config.get("pasteSite")||"https://www.friendpaste.com/",o=new XMLHttpRequest;o.open("POST",n),o.setRequestHeader("Content-Type","application/json"),o.send(JSON.stringify({title:t.title||"TogetherJS log file",snippet:this.toString(),language:"text"})),o.onreadystatechange=function(){if(4===o.readyState)JSON.parse(o.responseText)}})}});function o(e,t,n){for(e+="",n=n||" ";e.length<t;)e=n+e;return e}e.forEachAttr(n.prototype.levels,function(e,t){var o;n.prototype[t]=(o=e,function(){this.write.apply(this,[o].concat(Array.prototype.slice.call(arguments)))}),n.prototype.maxLevel=Math.max(n.prototype.maxLevel,e)}),e.forEachAttr(n.prototype.levels,function(e,t){n.prototype.levelNames[e]=t});var r=n();return r.ConsoleClass=n,r}),t("eventMaker",["jquery","util"],function(e,t){var n=t.Module("eventMaker");return n.performClick=function(t){var n=document.createEvent("MouseEvents");if(n.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),n.togetherjsInternal=!0,!(t=e(t)[0]).dispatchEvent(n)&&"A"==t.tagName){var o=t.href;if(o)return void(location.href=o)}},n.fireChange=function(t){t=e(t)[0];var n=document.createEvent("HTMLEvents");n.initEvent("change",!0,!0),t.dispatchEvent(n)},n}),t("cursor",["jquery","ui","util","session","elementFinder","tinycolor","eventMaker","peers","templating"],function(e,t,n,o,r,i,s,a,l){var c=n.assert,u=n.Module("cursor"),h=["#111","#eee"],d=50,f=35/180*Math.PI,p=Math.ceil(Math.sin(f)*d);o.hub.on("cursor-update",function(e){e.sameUrl?g.getClient(e.clientId).updatePosition(e):g.getClient(e.clientId).hideOtherUrl()});var g=n.Class({constructor:function(t){this.clientId=t,this.element=l.clone("cursor"),this.elementClass="togetherjs-scrolled-normal",this.element.addClass(this.elementClass),this.updatePeer(a.getPeer(t)),this.lastTop=this.lastLeft=null,e(document.body).append(this.element),this.element.animateCursorEntry(),this.keydownTimeout=null,this.clearKeydown=this.clearKeydown.bind(this),this.atOtherUrl=!1},KEYDOWN_WAIT_TIME:2e3,updatePeer:function(t){this.element.css({color:t.color}),this.element.find("img.togetherjs-cursor-img").attr("src",function(t){var n=e("<canvas></canvas>");n.attr("height",d),n.attr("width",p);var o=n[0].getContext("2d");return o.fillStyle=t,o.moveTo(0,0),o.beginPath(),o.lineTo(0,d/1.2),o.lineTo(Math.sin(f/2)*d/1.5,Math.cos(f/2)*d/1.5),o.lineTo(Math.sin(f)*d/1.2,Math.cos(f)*d/1.2),o.lineTo(0,0),o.shadowColor="rgba(0,0,0,0.3)",o.shadowBlur=2,o.shadowOffsetX=1,o.shadowOffsetY=2,o.strokeStyle="#ffffff",o.stroke(),o.fill(),n[0].toDataURL("image/png")}(t.color));var n=this.element.find(".togetherjs-cursor-name"),o=this.element.find(".togetherjs-cursor-container");c(n.length),n.text(t.name),o.css({backgroundColor:t.color,color:i.mostReadable(t.color,h)}),this.element.find("svg path").attr("fill",t.color),"live"!=t.status?(this.element.find("svg").animate({opacity:0},350),this.element.find(".togetherjs-cursor-container").animate({width:34,height:20,padding:12,margin:0},200).animate({width:0,height:0,padding:0,opacity:0},200)):this.element.animate({opacity:.3}).animate({opacity:1})},setClass:function(e){e!=this.elementClass&&(this.element.removeClass(this.elementClass).addClass(e),this.elementClass=e)},updatePosition:function(t){var n,o;if(this.atOtherUrl&&(this.element.show(),this.atOtherUrl=!1),t.element)try{var i=e(r.findElement(t.element)).offset();n=i.top+t.offsetY,o=i.left+t.offsetX}catch(e){if(!(e instanceof r.CannotFind))throw e;n=t.top,o=t.left}else n=t.top,o=t.left;this.lastTop=n,this.lastLeft=o,this.setPosition(n,o)},hideOtherUrl:function(){this.atOtherUrl||(this.atOtherUrl=!0,this.element.hide())},rotateCursorDown:function(){var t=e(this.element).find("svg");t.animate({borderSpacing:-150,opacity:1},{step:function(e,n){"borderSpacing"==n.prop?t.css("-webkit-transform","rotate("+e+"deg)").css("-moz-transform","rotate("+e+"deg)").css("-ms-transform","rotate("+e+"deg)").css("-o-transform","rotate("+e+"deg)").css("transform","rotate("+e+"deg)"):t.css(n.prop,e)},duration:500},"linear").promise().then(function(){t.css("-webkit-transform","").css("-moz-transform","").css("-ms-transform","").css("-o-transform","").css("transform","").css("opacity","")})},setPosition:function(t,n){var o=e(window).scrollTop(),r=e(window).height();t<o?(t=25,this.setClass("togetherjs-scrolled-above")):t>o+r-d?(t=r-d-5,this.setClass("togetherjs-scrolled-below")):this.setClass("togetherjs-scrolled-normal"),this.element.css({top:t,left:n})},refresh:function(){null!==this.lastTop&&this.setPosition(this.lastTop,this.lastLeft)},setKeydown:function(){this.keydownTimeout?clearTimeout(this.keydownTimeout):this.element.find(".togetherjs-cursor-typing").show().animateKeyboard(),this.keydownTimeout=setTimeout(this.clearKeydown,this.KEYDOWN_WAIT_TIME)},clearKeydown:function(){this.keydownTimeout=null,this.element.find(".togetherjs-cursor-typing").hide().stopKeyboardAnimation()},_destroy:function(){this.element.remove(),this.element=null}});g._cursors={},u.getClient=g.getClient=function(e){var t=g._cursors[e];return t||(t=g._cursors[e]=g(e)),t},g.forEach=function(e,t){for(var n in t=t||null,g._cursors)g._cursors.hasOwnProperty(n)&&e.call(t,g._cursors[n],n)},g.destroy=function(e){g._cursors[e]._destroy(),delete g._cursors[e]},a.on("new-peer identity-updated status-updated",function(e){g.getClient(e.id).updatePeer(e)});var m=0,v=100,y=-1,b=-1,w=null;function j(t){var n=Date.now();if(!(n-m<v)){m=n;var i=t.pageX,s=t.pageY;if(!(Math.abs(y-i)<3&&Math.abs(b-s)<3)){y=i,b=s;var a=t.target,l=e(a).closest(".togetherjs-window, .togetherjs-popup, #togetherjs-dock");if(l.length?a=l[0]:r.ignoreElement(a)&&(a=null),!a||a==document.documentElement||a==document.body)return w={type:"cursor-update",top:s,left:i},void o.send(w);var c=(a=e(a)).offset();if(c){var u=i-c.left,h=s-c.top;w={type:"cursor-update",top:s,left:i,element:r.elementLocation(a),offsetX:Math.floor(u),offsetY:Math.floor(h)},o.send(w)}else console.warn("Could not get offset of element:",a[0])}}}var x=null,k=0,T=75,C=300;function S(){var e=Date.now();if(x){if(!(e-k<C))return;clearTimeout(x)}x=setTimeout(A,T),k||(k=e)}var E=null;function A(){x=null,k=0,g.forEach(function(e){e.refresh()}),E={type:"scroll-update",position:r.elementByPixel(e(window).scrollTop())},o.send(E)}o.on("prepare-hello",function(e){E&&(e.scrollPosition=E.position)}),o.hub.on("scroll-update",function(e){e.peer.scrollPosition=e.position,e.peer.following&&e.peer.view.scrollTo()});var I=!1;function N(t){t.togetherjsInternal||setTimeout(function(){if(TogetherJS.running){var i=t.target;if(i==document.documentElement&&(i=document.body),!r.ignoreElement(i)&&"video"!==i.nodeName.toLowerCase()){var s=TogetherJS.config.get("dontShowClicks"),l=TogetherJS.config.get("cloneClicks");if(n.matchElement(i,l)||!n.matchElement(i,s)){var c=r.elementLocation(i),u=e(i).offset(),h=t.pageX-u.left,d=t.pageY-u.top;o.send({type:"cursor-click",element:c,offsetX:h,offsetY:d}),n.matchElement(i,s)||D({top:t.pageY,left:t.pageX},a.Self.color)}}}})}o.hub.on("hello-back hello",function(e){"hello"==e.type&&(I=!0),e.scrollPosition&&(e.peer.scrollPosition=e.scrollPosition,!I&&e.sameUrl&&Date.now()-o.timeHelloSent<2e3&&(I=!0,e.peer.view.scrollTo()))}),o.on("ui-ready",function(){e(document).mousemove(j),document.addEventListener("click",N,!0),document.addEventListener("keydown",R,!0),e(window).scroll(S),S()}),o.on("close",function(){g.forEach(function(e,t){g.destroy(t)}),e(document).unbind("mousemove",j),document.removeEventListener("click",N,!0),document.removeEventListener("keydown",R,!0),e(window).unbind("scroll",S)}),o.hub.on("hello",function(e){w&&o.send(w),E&&o.send(E)});var _=3e3;function D(t,n){var o=l.clone("click");e(document.body).append(o),o.css({top:t.top,left:t.left,borderColor:n}),setTimeout(function(){o.addClass("togetherjs-clicking")},100),setTimeout(function(){o.remove()},_)}o.hub.on("cursor-click",function(t){if(t.sameUrl){g.getClient(t.clientId).updatePosition(t);var o=e(r.findElement(t.element)),i=o.offset(),a=i.top+t.offsetY,l=i.left+t.offsetX,c=TogetherJS.config.get("cloneClicks");n.matchElement(o,c)&&s.performClick(o);var u=TogetherJS.config.get("dontShowClicks");n.matchElement(o,u)||D({top:a,left:l},t.peer.color)}});var L=0,M=500;function R(e){setTimeout(function(){var e=Date.now();e-L<M||(L=e,o.send({type:"keydown"}))})}return o.hub.on("keydown",function(e){g.getClient(e.clientId).setKeydown()}),n.testExpose({Cursor:g}),u}),t("ot",["util"],function(e){var t=e.Module("ot"),n=e.assert,o=e.Class({constructor:function(){this._items={},this._count=0},contains:function(e){return n("string"==typeof e),this._items.hasOwnProperty(e)},add:function(e){n("string"==typeof e),this.contains(e)||(this._items[e]=null,this._count++)},remove:function(e){n("string"==typeof e),this.contains(e)&&(delete this._items[e],this._count++)},isEmpty:function(){return!this._count}}),r=e.Class({constructor:function(e){this._q=[],this._size=e,this._deleted=0},_trim:function(){this._size&&this._q.length>this._size&&(this._q.splice(0,this._q.length-this._size),this._deleted+=this._q.length-this._size)},push:function(e){this._q.push(e),this._trim()},last:function(){return this._q[this._q.length-1]},walkBack:function(e,t){for(var n=!0,o=this._q.length-1;o>=0;o--){var r=this._q[o];if(!1===(n=e.call(t,r,o+this._deleted)))return n;n||(n=!0)}return n},walkForward:function(e,t,n){for(var o=!0,r=e;r<this._q.length;r++){var i=this._q[r-this._deleted];if(!1===(o=t.call(n,i,r)))return o;o||(o=!0)}return o},insert:function(e,t){this._q.splice(e-this._deleted,0,t)}}),i=e.Class({constructor:function(e,t,o,r,i){this.version=e,this.clientId=t,this.delta=o,this.known=r,this.outOfOrder=!!i,n("number"==typeof e&&"string"==typeof t,"Bad Change():",e,t)},toString:function(){var e="[Change "+this.version+"."+this.clientId+": ";e+=this.delta+" ",this.outOfOrder&&(e+="(out of order) ");var t=[];for(var n in this.known)this.known.hasOwnProperty(n)&&t.push(n);return t.sort(),e+="{",t.length?t.forEach(function(t,n){n&&(e+=";"),e+=t+":"+this.known[t]},this):e+="nothing known",e+"}]"},clone:function(){return i(this.version,this.clientId,this.delta.clone(),e.extend(this.known),this.outOfOrder)},isBefore:function(e){return n(e!==this,"Tried to compare a change to itself",this),e.version>this.version||e.version==this.version&&e.clientId>this.clientId},knowsAboutAll:function(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t]&&(!this.known[t]||this.known[t]<e[t]))return!1;return!0},knowsAboutChange:function(e){return e.clientId==this.clientId||this.known[e.clientId]&&this.known[e.clientId]>=e.version},knowsAboutVersion:function(e,t){return!e||t==this.clientId||this.known[t]&&this.known[t]>=e},maybeMissingChanges:function(e,t){return!!e&&(!this.known[t]||!(this.known[t]>=e)&&!(t>this.clientId&&this.known[t]>=this.version-1||t<this.clientId&&this.known[t]==this.version))}});return t.SimpleHistory=e.Class({constructor:function(e,t,n){this.clientId=e,this.committed=t,this.current=t,this.basis=n,this.queue=[],this.deltaId=1,this.selection=null},setSelection:function(e){this.selection=e?t.TextReplace(e[0],e[1]-e[0],"@"):null},getSelection:function(){return this.selection?[this.selection.start,this.selection.start+this.selection.del]:null},add:function(e){var t={id:this.clientId+"."+this.deltaId++,delta:e};return this.queue.length||(t.basis=this.basis),this.queue.push(t),this.current=e.apply(this.current),!!t.basis},commit:function(e){if(e.basis!==this.basis)return!1;if(this.queue.length&&this.queue[0].id===e.id)return n(e.basis===this.queue[0].basis),this.committed=this.queue.shift().delta.apply(this.committed),this.basis++,this.queue.length&&(this.queue[0].basis=this.basis),!1;var t=e.delta;return this.queue=this.queue.map(function(e){var n=e.delta.transpose(t);return t=n[1],{id:e.id,delta:n[0]}}),this.selection&&(this.selection=this.selection.transpose(t)[0]),this.committed=e.delta.apply(this.committed),this.basis++,this.queue.length&&(this.queue[0].basis=this.basis),this.current=this.committed,this.queue.forEach(function(e){this.current=e.delta.apply(this.current)}.bind(this)),!0},getNextToSend:function(){var e=this.queue[0];return e?e.sent?null:(n(e.basis),e.sent=!0,e):null}}),t.History=e.Class({constructor:function(e,t){this._history=r(),this._history.push({clientId:"init",state:t}),this.clientId=e,this.known={},this.mostRecentLocalChange=null},add:function(e){if(e.clientId==this.clientId)return this._history.push(e),this.mostRecentLocalChange=e.version,e.delta;n(!this.known[e.clientId]||this.known[e.clientId]<e.version,"Got a change",e,"that appears older (or same as) a known change",this.known[e.clientId]);var t=this._history.last();if(("init"==t.clientId||t.isBefore(e))&&e.knowsAboutAll(this.known)&&e.knowsAboutVersion(this.mostRecentLocalChange,this.clientId))return this._history.push(e),this.known[e.clientId]=e.version,e.delta;this.logHistory("//");var r=o();for(var i in this.known)this.known.hasOwnProperty(i)&&e.maybeMissingChanges(this.known[i],i)&&r.add(i);if(e.maybeMissingChanges(this.mostRecentLocalChange,this.clientId)&&r.add(this.clientId),!r.isEmpty()){var s=null;this._history.walkBack(function(t,n){return s=n,"init"!=t.clientId&&!(r.contains(t.clientId)&&!e.maybeMissingChanges(t.version,t.clientId)&&(r.remove(t.clientId),r.isEmpty()))},this),this._history.walkForward(s,function(t,n){if("init"==t.clientId)return!0;if(e.isBefore(t))return!1;if(!e.knowsAboutChange(t)){var o=this.promoteDelta(t.delta,n,e);o.equals(t.delta),this.logChange("->rebase",e,function(){var n=e.delta.transpose(o);e.delta=n[0],e.known[t.clientId]=t.version},"with:",t)}return!0},this)}var a=null;this._history.walkBack(function(t,n){return"init"!=t.clientId&&!t.isBefore(e)||(a=n+1,!1)},this),n(a),this._history.insert(a,e);var l=e.delta;return this._history.walkForward(a+1,function(t,o){if(!t.knowsAboutChange(e)){t.clone();this.logChange("^^fix",t,function(){var n=t.delta.transpose(l),o=t.delta.transpose(l);t.delta=o[0],t.known[e.clientId]=e.version,l=n[1]},"clone:",e.delta+""),n(t.knowsAboutChange(e))}},this),this.logHistory("!!"),l},promoteDelta:function(e,t,n){return this._history.walkForward(t+1,function(t,o){if(n.isBefore(t))return!1;if(n.knowsAboutChange(t)){var r=t.delta.transpose(e);e=r[1]}return!0}),e},logHistory:function(e){e=e||"";var t,o=Array.prototype.slice.call(arguments,1);console.log.apply(console,[e+"history",this.clientId,":"].concat(o)),console.log(e+" state:",JSON.stringify(this.getStateSafe())),this._history.walkForward(0,function(o,r){if(r){try{t=o.delta.apply(t)}catch(e){t="Error: "+e}console.log(e+"  ",r,o+"",JSON.stringify(t))}else n("init"==o.clientId),console.log(e+" init:",JSON.stringify(o.state)),t=o.state})},logChange:function(e,t,n){e=e||"before";var o=Array.prototype.slice.call(arguments,3);console.log.apply(console,[e,this.clientId,":",t+""].concat(o).concat([JSON.stringify(this.getStateSafe(!0))]));try{n()}finally{console.log(e+" after:",t+"",JSON.stringify(this.getStateSafe()))}},addDelta:function(t){var n=this._createVersion(),o=i(n,this.clientId,t,e.extend(this.knownVersions));return this.add(o),o},_createVersion:function(){var e=1;for(var t in this.knownVersions)e=Math.max(e,this.knownVersions[t]);return(e=Math.max(e,this.mostRecentLocalChange))+1},fault:function(e){throw new Error("Fault")},getState:function(){var e;return this._history.walkForward(0,function(t){e="init"==t.clientId?t.state:t.delta.apply(e)},this),e},getStateSafe:function(){try{return this.getState()}catch(e){return"Error: "+e}}}),t.TextReplace=e.Class({constructor:function(e,t,o){n("number"==typeof e&&"number"==typeof t&&"string"==typeof o,e,t,o),n(e>=0&&t>=0,e,t),this.start=e,this.del=t,this.text=o},toString:function(){return this.empty()?"[no-op]":this.del?this.text?"[replace "+this.del+" chars with "+JSON.stringify(this.text)+" @"+this.start+"]":"[delete "+this.del+" chars @"+this.start+"]":"[insert "+JSON.stringify(this.text)+" @"+this.start+"]"},equals:function(e){return e.constructor===this.constructor&&e.del===this.del&&e.start===this.start&&e.text===this.text},clone:function(e,n,o){return void 0===e&&(e=this.start),void 0===n&&(n=this.del),void 0===o&&(o=this.text),t.TextReplace(e,n,o)},empty:function(){return!this.del&&!this.text},apply:function(t){if(this.empty())return t;if(this.start>t.length)throw console.trace(),new e.AssertionError("Start after end of text ("+JSON.stringify(t)+"/"+t.length+"): "+this);if(this.start+this.del>t.length)throw new e.AssertionError("Start+del after end of text ("+JSON.stringify(t)+"/"+t.length+"): "+this);return t.substr(0,this.start)+this.text+t.substr(this.start+this.del)},transpose:function(e){var o;return n(e instanceof t.TextReplace,"Transposing with non-TextReplace:",e),this.empty()?[this.clone(),e.clone()]:e.empty()?[this.clone(),e.clone()]:e.before(this)?[this.clone(this.start+e.text.length-e.del),e.clone()]:this.before(e)?[this.clone(),e.clone(e.start+this.text.length-this.del)]:e.sameRange(this)?[this.clone(this.start+e.text.length,0),e.clone(void 0,0)]:e.contains(this)?[this.clone(e.start+e.text.length,0,this.text),e.clone(void 0,e.del-this.del+this.text.length,e.text+this.text)]:this.contains(e)?[this.clone(void 0,this.del-e.del+e.text.length,e.text+this.text),e.clone(this.start,0,e.text)]:this.overlapsStart(e)?(o=this.start+this.del-e.start,[this.clone(void 0,this.del-o),e.clone(this.start+this.text.length,e.del-o)]):(n(e.overlapsStart(this),e+"","does not overlap start of",this+"",e.before(this)),o=e.start+e.del-this.start,[this.clone(e.start+e.text.length,this.del-o),e.clone(void 0,e.del-o)])},before:function(e){return this.start+this.del<=e.start},contains:function(e){return e.start>=this.start&&e.start+e.del<this.start+this.del},sameRange:function(e){return e.start==this.start&&e.del==this.del},overlapsStart:function(e){return this.start<e.start&&this.start+this.del>e.start},classMethods:{fromChange:function(e,t){n("string"==typeof e),n("string"==typeof t);for(var o=0;o<t.length&&t.charAt(o)==e.charAt(o);)o++;for(var r=0;r<t.length-o&&r<e.length-o&&t.charAt(t.length-r-1)==e.charAt(e.length-r-1);)r++;var i=e.substr(o,e.length-o-r),s=t.substr(o,t.length-o-r);return i.length||s?this(o,i.length,s):null},random:function(e,t){var n,o,r,i=["ins","del","repl"];switch(e.length||(i=["ins"]),t.pick(i)){case"ins":return n=t.number(2)?t.string(t.number(3)+1):t.string(1),this(o=t.number(4)?t.number(3)?t.number(e.length):e.length-1:0,0,n);case"del":return t.number(20)?(o=t.number(e.length-1),r=t.number(2)?t.number(5)+1:1,this(o,r=Math.min(r,e.length-o),"")):this(0,e.length,"");case"repl":return o=t.number(e.length-1),r=t.number(5),this(o,r=Math.min(r,e.length-o),n=t.string(t.number(2)+1))}throw"Unreachable"}}}),t}),t("forms",["jquery","util","session","elementFinder","eventMaker","templating","ot"],function(e,t,n,o,r,i,s){var a=t.Module("forms"),l=t.assert,c=5,u=!1;function h(t){var n=TogetherJS.config.get("ignoreForms");return!0===n||e(t).is(n.join(","))}function d(e){var t=e.target.tagName;"TEXTAREA"!=t&&"INPUT"!=t||f(e)}function f(e){p({element:e.target,value:S(e.target)})}function p(t){var r=e(t.element);l(r);var i=t.tracker,a=t.value;if(!u&&!(o.ignoreElement(r)||x(r)&&!i||h(r))){var c={type:"form-update",element:o.elementLocation(r)};if(C(r)||i){var d=r.data("togetherjsHistory");if(d){if(d.current==a)return;var f=s.TextReplace.fromChange(d.current,a);return l(f),d.add(f),void I(c.element,d,i)}c.value=a,c.basis=1,r.data("togetherjsHistory",s.SimpleHistory(n.clientId,a,1))}else c.value=a;n.send(c)}}function g(t){var n=((t=e(t)).prop("type")||"text").toLowerCase();return"INPUT"==t.prop("tagName")&&-1!=["radio","checkbox"].indexOf(n)}var m={},v=[];TogetherJS.addTracker=function(e,t){l("function"==typeof e,"You must pass in a class"),l("string"==typeof e.prototype.trackerName,"Needs a .prototype.trackerName string"),"destroy update init makeInit tracked".split(/ /).forEach(function(t){l("function"==typeof e.prototype[t],"Missing required tracker method: "+t)}),"scan tracked".split(/ /).forEach(function(t){l("function"==typeof e[t],"Missing required tracker class method: "+t)}),m[e.prototype.trackerName]=e,t||D()};var y=t.Class({trackerName:"AceEditor",constructor:function(t){this.element=e(t)[0],l(e(this.element).hasClass("ace_editor")),this._change=this._change.bind(this),this._editor().document.on("change",this._change)},tracked:function(t){return this.element===e(t)[0]},destroy:function(e){this._editor().document.removeListener("change",this._change)},update:function(e){this._editor().document.setValue(e.value)},init:function(e,t){this.update(e)},makeInit:function(){return{element:this.element,tracker:this.trackerName,value:this._editor().document.getValue()}},_editor:function(){return this.element.env},_change:function(e){u||p({tracker:this.trackerName,element:this.element,value:this.getContent()})},getContent:function(){return this._editor().document.getValue()}});y.scan=function(){return e(".ace_editor")},y.tracked=function(t){return!!e(t).closest(".ace_editor").length},TogetherJS.addTracker(y,!0);var b=t.Class({trackerName:"CodeMirrorEditor",constructor:function(t){this.element=e(t)[0],l(this.element.CodeMirror),this._change=this._change.bind(this),this._editor().on("change",this._change)},tracked:function(t){return this.element===e(t)[0]},destroy:function(e){this._editor().off("change",this._change)},update:function(e){this._editor().setValue(e.value)},init:function(e){e.value&&this.update(e)},makeInit:function(){return{element:this.element,tracker:this.trackerName,value:this._editor().getValue()}},_change:function(e,t){u||p({tracker:this.trackerName,element:this.element,value:this.getContent()})},_editor:function(){return this.element.CodeMirror},getContent:function(){return this._editor().getValue()}});b.scan=function(){for(var t=[],n=document.body.getElementsByTagName("*"),o=n.length,r=0;r<o;r++){var i=n[r];i.CodeMirror&&t.push(i)}return e(t)},b.tracked=function(t){for(t=e(t)[0];t;){if(t.CodeMirror)return!0;t=t.parentNode}return!1},TogetherJS.addTracker(b,!0);var w=t.Class({trackerName:"CKEditor",constructor:function(t){this.element=e(t)[0],l(CKEDITOR),l(CKEDITOR.dom.element.get(this.element)),this._change=this._change.bind(this),this._editor().on("change",this._change)},tracked:function(t){return this.element===e(t)[0]},destroy:function(e){this._editor().removeListener("change",this._change)},update:function(e){this._editor().editable().setHtml(e.value)},init:function(e,t){this.update(e)},makeInit:function(){return{element:this.element,tracker:this.trackerName,value:this.getContent()}},_change:function(e){u||p({tracker:this.trackerName,element:this.element,value:this.getContent()})},_editor:function(){return CKEDITOR.dom.element.get(this.element).getEditor()},getContent:function(){return this._editor().getData()}});function j(){v.forEach(function(e){e.destroy()}),v=[]}function x(e){var n=!1;return t.forEachAttr(m,function(t){t.tracked(e)&&(n=!0)}),n}function k(t,n){t=e(t)[0];for(var o=0;o<v.length;o++){var r=v[o];if(r.tracked(t))return l(!n||n==r.trackerName,"Expected to map to a tracker type",n,"but got",r.trackerName),r}return null}w.scan=function(){var t=[];if("undefined"!=typeof CKEDITOR){var n;for(var o in CKEDITOR.instances)(n=document.getElementById(o)||document.getElementsByName(o)[0])&&t.push(n);return e(t)}},w.tracked=function(t){return"undefined"!=typeof CKEDITOR&&(t=e(t)[0],!(!CKEDITOR.dom.element.get(t)||!CKEDITOR.dom.element.get(t).getEditor()))},TogetherJS.addTracker(w,!0);var T="color date datetime datetime-local email tel text time week".split(/ /g);function C(t){var n=(t=e(t)).prop("tagName"),o=(t.prop("type")||"text").toLowerCase();return"TEXTAREA"==n||"INPUT"==n&&-1!=T.indexOf(o)}function S(t){return g(t=e(t))?t.prop("checked"):t.val()}function E(t){return"TEXTAREA"==(t=e(t)[0]).tagName?"textarea":"SELECT"==t.tagName?"select":"INPUT"==t.tagName?(t.getAttribute("type")||"text").toLowerCase():"?"}function A(t,n){var o=!1;g(t=e(t))?!!t.prop("checked")!=(n=!!n)&&(o=!0,t.prop("checked",n)):t.val()!=n&&(o=!0,t.val(n));o&&r.fireChange(t)}function I(e,t,o){var r=t.getNextToSend();if(r){var i={type:"form-update",element:e,"server-echo":!0,replace:{id:r.id,basis:r.basis,delta:{start:r.delta.start,del:r.delta.del,text:r.delta.text}}};o&&(i.tracker=o),n.send(i)}}n.hub.on("form-update",function(t){if(t.sameUrl){var n,r=e(o.findElement(t.element));t.tracker&&(n=k(r,t.tracker),l(n));var i,a,c,h=r[0].ownerDocument.activeElement;if(C(h)&&(i=[h.selectionStart,h.selectionEnd]),C(r)&&(a=[r[0].selectionStart,r[0].selectionEnd]),t.replace){var d=r.data("togetherjsHistory");if(!d)return void console.warn("form update received for uninitialized form element");d.setSelection(a),t.replace.delta=s.TextReplace(t.replace.delta.start,t.replace.delta.del,t.replace.delta.text);var f=d.commit(t.replace),p=null;if(void 0!==n&&(p=n.trackerName),I(t.element,d,p),!f)return;c=d.current,a=d.getSelection()}else c=t.value;u=!0;try{n?n.update({value:c}):A(r,c),C(r)&&(r[0].selectionStart=a[0],r[0].selectionEnd=a[1]),h!=r[0]&&(h.focus(),C(h)&&(h.selectionStart=i[0],h.selectionEnd=i[1]))}finally{u=!1}}});var N=!1;function _(){N=!0;var t={type:"form-init",pageAge:Date.now()-TogetherJS.pageLoaded,updates:[]};e("textarea, input, select").each(function(){if(!(o.ignoreElement(this)||x(this)||h(this))){var n=e(this),r=S(n),i={element:o.elementLocation(this),value:r,elementType:E(n)};if(C(n)){var s=n.data("togetherjsHistory");s&&(i.value=s.committed,i.basis=s.basis)}t.updates.push(i)}}),v.forEach(function(n){var r=n.makeInit();l(n.tracked(r.element));var i=e(r.element).data("togetherjsHistory");i&&(r.value=i.committed,r.basis=i.basis),r.element=o.elementLocation(e(r.element)),t.updates.push(r)}),t.updates.length&&n.send(t)}function D(){e("textarea, input, select").each(function(){if(!x(this)&&!o.ignoreElement(this)){var t=e(this),r=S(t);t.data("togetherjsHistory",s.SimpleHistory(n.clientId,r,1))}}),j(),l(!v.length),t.forEachAttr(m,function(t){var o=t.scan();o&&e.each(o,function(){var o=new t(this);e(this).data("togetherjsHistory",s.SimpleHistory(n.clientId,o.getContent(),1)),v.push(o)})})}n.on("reinitialize",D),n.on("ui-ready",D),n.on("close",j),n.hub.on("form-init",function(t){if(t.sameUrl){if(N){var r=Date.now()-TogetherJS.pageLoaded;if(t.pageAge<r)return}t.updates.forEach(function(r){var i;try{i=o.findElement(r.element)}catch(e){return void console.warn(e)}u=!0;try{if(r.tracker){var a=k(i,r.tracker);l(a),a.init(r,t)}else A(i,r.value);if(r.basis){var c=e(i).data("togetherjsHistory");c&&c.basis===r.basis&&1!==c.basis||e(i).data("togetherjsHistory",s.SimpleHistory(n.clientId,r.value,r.basis))}}finally{u=!1}})}});var L=null;function M(e){var t=e.target;o.ignoreElement(t)||x(t)?R(e):t!=L&&(L=t,n.send({type:"form-focus",element:o.elementLocation(t)}))}function R(e){e.target;L&&(L=null,n.send({type:"form-focus",element:null}))}var O={};return n.hub.on("form-focus",function(t){var n=O[t.peer.id];if(n&&(n.remove(),n=null),t.element){var r=o.findElement(t.element),s=function(t,n){var o=(n=e(n)).offset();if(!o)return console.warn("Could not get offset of element:",n[0]),null;var r=i.sub("focus",{peer:t});return(r=r.find(".togetherjs-focus")).css({top:o.top-c+"px",left:o.left-c+"px",width:n.outerWidth()+2*c+"px",height:n.outerHeight()+2*c+"px"}),e(document.body).append(r),r}(t.peer,r);s&&(O[t.peer.id]=s)}}),n.hub.on("hello",function(e){L&&setTimeout(function(){L&&n.send({type:"form-focus",element:o.elementLocation(L)})})}),n.on("ui-ready",function(){e(document).on("change",f),e(document).on("input keyup cut paste",d),e(document).on("focusin",M),e(document).on("focusout",R)}),n.on("close",function(){e(document).off("change",f),e(document).off("input keyup cut paste",d),e(document).off("focusin",M),e(document).off("focusout",R)}),n.hub.on("hello",function(e){e.sameUrl&&setTimeout(_)}),a}),t("startup",["util","require","jquery","windowing","storage"],function(e,t,n,o,r){e.assert;var i=e.Module("startup"),s=null,a=["browserBroken","browserUnsupported","sessionIntro","walkthrough","share"],l=null;i.start=function(){if(s){var e=-1;l&&(e=a.indexOf(l)),++e>=a.length?s.emit("startup-ready"):(l=a[e],c[l](i.start))}else t(["session"],function(e){s=e,i.start()})};var c={browserBroken:function(e){window.WebSocket?e():(o.show("#togetherjs-browser-broken",{onClose:function(){s.close()}}),n.browser.msie&&n("#togetherjs-browser-broken-is-ie").show())},browserUnsupported:function(e){if(n.browser.msie){var t=!0;o.show("#togetherjs-browser-unsupported",{onClose:function(){t?s.close():e()}}),n("#togetherjs-browser-unsupported-anyway").click(function(){t=!1})}else e()},sessionIntro:function(e){if(s.isClient&&s.firstRun)if(TogetherJS.config.close("suppressJoinConfirmation"),TogetherJS.config.get("suppressJoinConfirmation"))e();else{var t=!1;o.show("#togetherjs-intro",{onClose:function(){t||e()}}),n("#togetherjs-intro .togetherjs-modal-dont-join").click(function(){t=!0,o.hide(),s.close("declined-join")})}else e()},walkthrough:function(e){r.settings.get("seenIntroDialog").then(function(n){n?e():t(["walkthrough"],function(t){t.start(!0,function(){r.settings.set("seenIntroDialog",!0),e()})})})},share:function(e){TogetherJS.config.close("suppressInvite"),s.isClient||!s.firstRun||TogetherJS.config.get("suppressInvite")?e():t(["windowing"],function(e){e.show("#togetherjs-share")})}};return i}),t("videos",["jquery","util","session","elementFinder"],function(e,t,n,o){var r=[],i="timeupdate",s=["play","pause"],a=3e3;function l(){var t=e("video");!function(e){var t;s.forEach(function(n){t=c(n),e.on(n,t),r.push({name:n,listener:t})})}(t),function(t){t.each(function(t,n){var o,s=(o=0,function(e){var t=e.target.currentTime;u(t,o)&&c(i)(e),o=t});e(n).on(i,s),r.push({name:i,listener:s})})}(t)}function c(e){return function(t,r){var i=t.target;r||(r={}),r.silent||n.send({type:"video-"+e,location:o.elementLocation(i),position:i.currentTime})}}function u(e,t){return 1e3*Math.abs(e-t)>a}function h(){var t=e("video");r.forEach(function(e){t.off(e.name,e.listener)}),r=[]}function d(t){return e(o.findElement(t))}function f(e,t){e.prop("currentTime",t)}n.on("reinitialize",function(){h(),l()}),n.on("ui-ready",l),n.on("close",h),n.hub.on("video-timeupdate",function(e){var t=d(e.location);u(t.prop("currentTime"),e.position)&&f(t,e.position)}),s.forEach(function(e){n.hub.on("video-"+e,function(t){var n=d(t.location);f(n,t.position),n.trigger(e,{silent:!0})})})}),t("walkthrough",["util","ui","jquery","windowing","templates","templating","session","peers"],function(e,t,n,o,r,i,s,a){var l=e.assert,c=e.Module("walkthrough"),u=null,h=null,d=null;function f(e){d.hide(),n(d[e]).show();var t=h.find("#togetherjs-walkthrough-progress .togetherjs-walkthrough-slide-progress");t.removeClass("togetherjs-active"),n(t[e]).addClass("togetherjs-active");var o=n("#togetherjs-walkthrough-next").removeClass("togetherjs-disabled"),r=n("#togetherjs-walkthrough-previous").removeClass("togetherjs-disabled");e==d.length-1?o.addClass("togetherjs-disabled"):0===e&&r.addClass("togetherjs-disabled")}function p(){var e=m();--e<0&&(e=0),f(e)}function g(){var e=m();++e>=d.length&&(e=d.length-1),f(e)}function m(){var e=d.filter(":visible");if(!e.length)return 0;for(var t=0;t<d.length;t++)if(d[t]==e[0])return t;return 0}return c.start=function(e,c){if(!h){(h=n(r.walkthrough)).hide(),t.container.append(h),(d=h.find(".togetherjs-walkthrough-slide")).hide();var m=n("#togetherjs-walkthrough-progress");d.each(function(e){var t=i.sub("walkthrough-slide-progress");m.append(t),t.click(function(){f(e)})}),h.find("#togetherjs-walkthrough-previous").click(p),h.find("#togetherjs-walkthrough-next").click(g),t.prepareShareLink(h),h.find(".togetherjs-self-name").bind("keyup",function(e){var t=n(e.target).val();a.Self.update({name:t})}),h.find(".togetherjs-swatch").click(function(){var e=n("#togetherjs-pick-color");if(e.is(":visible"))e.hide();else{e.show(),e.find(".togetherjs-swatch-active").removeClass("togetherjs-swatch-active"),e.find('.togetherjs-swatch[data-color="'+a.Self.color+'"]').addClass("togetherjs-swatch-active");var t=h.find(".togetherjs-swatch").offset();e.css({top:t.top,left:t.left-7})}}),s.isClient?(h.find(".togetherjs-if-creator").remove(),h.find(".togetherjs-ifnot-creator").show()):(h.find(".togetherjs-if-creator").show(),h.find(".togetherjs-ifnot-creator").remove()),TogetherJS.config.track("siteName",function(e){e=e||document.title,h.find(".togetherjs-site-name").text(e)}),t.activateAvatarEdit(h,{onSave:function(){h.find("#togetherjs-avatar-when-saved").show(),h.find("#togetherjs-avatar-when-unsaved").hide()},onPending:function(){h.find("#togetherjs-avatar-when-saved").hide(),h.find("#togetherjs-avatar-when-unsaved").show()}}),a.Self.update({}),s.emit("new-element",h)}l("boolean"==typeof e,"You must provide a firstTime boolean parameter"),e?(h.find(".togetherjs-walkthrough-firsttime").show(),h.find(".togetherjs-walkthrough-not-firsttime").hide()):(h.find(".togetherjs-walkthrough-firsttime").hide(),h.find(".togetherjs-walkthrough-not-firsttime").show()),u=c,f(0),o.show(h)},c.stop=function(){o.hide(h),u&&(u(),u=null)},s.on("hide-window",function(){u&&(u(),u=null)}),c}),t("webrtc",["require","jquery","util","session","ui","peers","storage","windowing"],function(e,t,n,o,r,i,s,a){var l=n.Module("webrtc"),c=n.assert;if(o.RTCSupported=!!(window.mozRTCPeerConnection||window.webkitRTCPeerConnection||window.RTCPeerConnection),o.RTCSupported&&t.browser.mozilla&&parseInt(t.browser.version,10)<=19)try{new window.mozRTCPeerConnection}catch(e){o.RTCSupported=!1}var u={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!1}};window.mozRTCPeerConnection&&(u.mandatory.MozDontOfferDataChannel=!0);var h=window.webkitURL||window.URL,d=window.mozRTCSessionDescription||window.webkitRTCSessionDescription||window.RTCSessionDescription,f=window.mozRTCIceCandidate||window.webkitRTCIceCandidate||window.RTCIceCandidate;function p(e){if(!window.mozRTCPeerConnection)return e;for(var t=e.split("\r\n"),n=[],o=0;o<t.length;o++)n.push(t[o]),-1!==t[o].search("m=")&&n.push("a=crypto:1 AES_CM_128_HMAC_SHA1_80 inline:AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA");return e=n.join("\r\n")}function g(e,t,n){n=n||function(e){console.error("Error in getUserMedia:",e)},(navigator.getUserMedia||navigator.mozGetUserMedia||navigator.webkitGetUserMedia||navigator.msGetUserMedia).call(navigator,e,t,n)}function m(e){r.displayToggle(e),"#togetherjs-audio-incoming"==e?t("#togetherjs-audio-button").addClass("togetherjs-animated").addClass("togetherjs-color-alert"):t("#togetherjs-audio-button").removeClass("togetherjs-animated").removeClass("togetherjs-color-alert")}return o.on("ui-ready",function(){t("#togetherjs-self-avatar").click(function(){var e=i.Self.avatar;e&&s.attr("src",e),r.displayToggle("#togetherjs-avatar-edit")}),o.RTCSupported||t("#togetherjs-avatar-edit-rtc").hide();var e=null,s=t("#togetherjs-self-avatar-preview"),a=t("#togetherjs-self-avatar-accept"),l=t("#togetherjs-self-avatar-cancel"),u=t("#togetherjs-avatar-use-camera"),d=t("#togetherjs-avatar-video"),f=t("#togetherjs-avatar-upload");function p(t){e=t,s.attr("src",e),a.attr("disabled",null)}u.click(function(){m?function(){c(m);var e=d[0].videoHeight,n=d[0].videoWidth;n*=o.AVATAR_SIZE/e,e=o.AVATAR_SIZE;var r=t("<canvas>");r[0].height=o.AVATAR_SIZE,r[0].width=o.AVATAR_SIZE;var i=r[0].getContext("2d");i.arc(o.AVATAR_SIZE/2,o.AVATAR_SIZE/2,o.AVATAR_SIZE/2,0,2*Math.PI),i.closePath(),i.clip(),i.drawImage(d[0],(o.AVATAR_SIZE-n)/2,0,n,e),p(r[0].toDataURL("image/png"))}():g({video:!0,audio:!1},function(e){m=!0,d[0].src=h.createObjectURL(e),d[0].play()},function(e){console.error("getUserMedia error:",e)})}),a.click(function(){i.Self.update({avatar:e}),r.displayToggle("#togetherjs-no-avatar-edit"),t("#togetherjs-participants-other").show(),a.attr("disabled","1")}),l.click(function(){r.displayToggle("#togetherjs-no-avatar-edit"),t("#togetherjs-participants-other").show()});var m=!1;f.on("change",function(){var e=new FileReader;e.onload=function(){!function(e,n){var r=t("<canvas>");r[0].height=o.AVATAR_SIZE,r[0].width=o.AVATAR_SIZE;var i=r[0].getContext("2d"),s=new Image;s.src=e,setTimeout(function(){var e=s.naturalWidth||s.width,t=s.naturalHeight||s.height;e*=o.AVATAR_SIZE/t,t=o.AVATAR_SIZE,i.drawImage(s,0,0,e,t),n(r[0].toDataURL("image/png"))})}("data:image/jpeg;base64,"+n.blobToBase64(this.result),function(e){p(e)})},e.onerror=function(){console.error("Error reading file:",this.error)},e.readAsArrayBuffer(this.files[0])})}),o.on("ui-ready",function(){if(t("#togetherjs-audio-button").click(function(){t("#togetherjs-rtc-info").is(":visible")?a.hide():o.RTCSupported?function(){if(i=!0,s.settings.get("dontShowRtcInfo").then(function(e){e||a.show("#togetherjs-rtc-info")}),!e)return void E(_);l||_()}():a.show("#togetherjs-rtc-not-supported")}),o.RTCSupported){m("#togetherjs-audio-ready");var e=null,i=!1,l=!1,v=t("#togetherjs-audio-element"),y=null,b=null,w=!1,j=null,x=null,k=!1,T=null,C=null;r.container.find("#togetherjs-rtc-info .togetherjs-dont-show-again").change(function(){s.settings.set("dontShowRtcInfo",this.checked)}),o.hub.on("rtc-offer",function(t){function n(){I().setRemoteDescription(new d({type:"offer",sdp:b}),function(){w=!0,N(),_()},function(e){S("Error doing RTC setRemoteDescription:",e)})}(b||j||x||y)&&D(),b=t.offer,i?e?n():E(n):m("#togetherjs-audio-incoming")}),o.hub.on("rtc-answer",function(t){if(j||x||b||!y)return D(),void o.send({type:"rtc-abort"});x=t.answer,c(y),c(e),I().setRemoteDescription(new d({type:"answer",sdp:x}),function(){k=!0,_()},function(e){S("Error doing RTC setRemoteDescription:",e)})}),o.hub.on("rtc-ice-candidate",function(e){C=e.candidate,(w||k)&&N()}),o.hub.on("rtc-abort",function(t){D(),i&&(e?_():E(function(){_()}))}),o.hub.on("hello",function(e){m("#togetherjs-audio-ready"),i&&(y||j)&&(D(),_())})}else m("#togetherjs-audio-unavailable");function S(){console.warn.apply(console,arguments);for(var e="",n=0;n<arguments.length;n++){e&&(e+=" ");var o=arguments[n];if("string"==typeof o)e+=o;else{var r;try{r=JSON.stringify(o)}catch(e){}r||(r=""+o),e+=r}}m("#togetherjs-audio-error"),t("#togetherjs-audio-error").attr("title",e)}function E(t){g({video:!1,audio:!0},function(n){e=n,A("#togetherjs-local-audio",n),t&&t()},function(e){e&&1==e.code||S("getUserMedia error:",e)})}function A(e,n){e=t(e)[0],window.mozRTCPeerConnection?(e.mozSrcObject=n,e.play()):(e.autoplay=!0,e.src=h.createObjectURL(n))}function I(){if(c(e),T)return T;try{T=function(){if(window.webkitRTCPeerConnection)return new webkitRTCPeerConnection({iceServers:[{url:"stun:stun.l.google.com:19302"}]},{optional:[{DtlsSrtpKeyAgreement:!0}]});if(window.mozRTCPeerConnection)return new mozRTCPeerConnection({iceServers:[{url:"stun:23.21.150.121"}]},{optional:[]});throw new n.AssertionError("Called makePeerConnection() without supported connection")}()}catch(e){throw S("Error creating PeerConnection:",e),e}return T.onaddstream=function(e){A(v,e.stream),m("#togetherjs-audio-active")},T.onstatechange=function(){"closed"==T.readyState&&m("#togetherjs-audio-ready")},T.onicecandidate=function(e){e.candidate&&o.send({type:"rtc-ice-candidate",candidate:{sdpMLineIndex:e.candidate.sdpMLineIndex,sdpMid:e.candidate.sdpMid,candidate:e.candidate.candidate}})},T.addStream(e),T}function N(){C&&T.addIceCandidate(new f(C))}function _(){var e=I();if(!b||w)if(y||b){if(!j&&!x){var t=setTimeout(function(){j||S("createAnswer Timed out; reload or restart browser")},2e3);e.createAnswer(function(n){n.sdp=p(n.sdp),clearTimeout(t),e.setLocalDescription(n,function(){o.send({type:"rtc-answer",answer:n.sdp}),j=n},function(e){clearTimeout(t),S("Error doing RTC setLocalDescription:",e)},u)},function(e){S("Error doing RTC createAnswer:",e)})}}else e.createOffer(function(t){t.sdp=p(t.sdp),e.setLocalDescription(t,function(){o.send({type:"rtc-offer",offer:t.sdp}),y=t,m("#togetherjs-audio-outgoing")},function(e){S("Error doing RTC setLocalDescription:",e)},u)},function(e){S("Error doing RTC createOffer:",e)});else e.setRemoteDescription(new d({type:"offer",sdp:b}),function(){w=!0,N(),_()},function(e){S("Error doing RTC setRemoteDescription:",e)})}function D(){j=x=y=b=null,k=w=!1,T=null,v[0].removeAttribute("src")}}),l}),t("who",["util","channels","session","ui"],function(e,t,n,o){var r=e.assert,i=e.Module("who");return i.getList=function(n){return e.Deferred(function(e){var o,r,s=t.WebSocketChannel(n),a={},l=0;s.onmessage=function(t){"init-connection"==t.type&&(o=t.peerCount),"who"==t.type&&setTimeout(function(){u()},2e3),"hello-back"==t.type&&(a[t.clientId]||(a[t.clientId]=i.ExternalPeer(t.clientId,t),l++,o&&l>=o?u():e.notify(a)))},s.send({type:"who","server-echo":!0,clientId:null});var c=setTimeout(function(){u()},5e3);function u(){c&&clearTimeout(c),r&&clearTimeout(r),s.close(),e.resolve(a)}})},i.invite=function(o,r){return e.Deferred(function(i){var s=t.WebSocketChannel(o),a=e.generateId();s.onmessage=function(e){"invite"==e.type&&e.inviteId==a&&(s.close(),i.resolve())};var l=n.makeHelloMessage(!1);delete l.type,l.clientId=n.clientId,s.send({type:"invite",inviteId:a,url:n.shareUrl(),userInfo:l,forClientId:r,clientId:null,"server-echo":!0})})},i.ExternalPeer=e.Class({isSelf:!1,isExternal:!0,constructor:function(e,t){t=t||{},r(e),this.id=e,this.identityId=t.identityId||null,this.status=t.status||"live",this.idle=t.status||"active",this.name=t.name||null,this.avatar=t.avatar||null,this.color=t.color||"#00FF00",this.lastMessageDate=0,this.view=o.PeerView(this)},className:function(t){return(t=t||"")+e.safeClassName(this.id)}}),i}),t("youtubeVideos",["jquery","util","session","elementFinder"],function(e,t,n,o){var r=3e3,i=[];function s(){if(e("iframe").each(function(t,n){-1==(e(n).attr("src")||"").indexOf("youtube")||e(n).attr("id")||(e(n).attr("id","youtube-player"+t),e(n).attr("enablejsapi",1),i[t]=n)}),window.onYouTubeIframeAPIReady=function(){e(i).each(function(e,t){new YT.Player(t.id,{events:{onReady:o,onStateChange:a}})})},void 0===window.YT){var t=document.createElement("script");t.src="https://www.youtube.com/iframe_api";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n)}else onYouTubeIframeAPIReady();function o(t){var n=t.target,o=n.a;if(!e(o).data("togetherjs-player")){e(o).data("togetherjs-player",n),e(o).data("dontPublish",!1);var r=c(n.getVideoUrl());e(o).data("currentVideoId",r)}}}function a(t){var r=t.target,i=r.a,s=e(i).data("togetherjs-player"),a=r.k.currentTime,l=o.elementLocation(i);if(e(s).data("seek"))e(s).removeData("seek");else if(e(i).data("dontPublish"))e(i).data("dontPublish",!1);else if(t.data==YT.PlayerState.PLAYING){var u=function(t){var n=e(t).data("currentVideoId"),o=c(e(t).data("togetherjs-player").getVideoUrl());return o!=n&&o}(i);u?(!function(e,t){n.send({type:"differentVideoLoaded",videoId:t,element:e})}(l,u),e(i).data("currentVideoId",u)):n.send({type:"playerStateChange",element:l,playerState:1,playerTime:a})}else{if(t.data!=YT.PlayerState.PAUSED)return;n.send({type:"playerStateChange",element:l,playerState:2,playerTime:a})}}function l(){i.forEach(function(t){var r=e(t).data("togetherjs-player"),i=c(r.getVideoUrl()),s=r.getPlayerState(),a=r.getCurrentTime(),l=o.elementLocation(t);n.send({type:"synchronizeVideosOfLateGuest",element:l,videoId:i,playerState:s,playerTime:a})})}function c(e){var t=e.split("v=")[1],n=t.indexOf("&");return-1!=n&&(t=t.substring(0,n)),t}function u(e,t){return 1e3*Math.abs(e-t)>r}n.on("reinitialize",function(){TogetherJS.config.get("youtube")&&s()}),n.on("close",function(){e(i).each(function(t,n){e(n).removeData("togetherjs-player"),e(n).removeData("dontPublish"),e(n).removeData("currentVideoId"),e(n).removeAttr("enablejsapi"),0===(e(n).attr("id")||"").indexOf("youtube-player")&&e(n).removeAttr("id"),i=[]})}),TogetherJS.config.track("youtube",function(e,t){e&&!t&&(s(),TogetherJS.config.close("youtube"))}),n.hub.on("playerStateChange",function(t){var n=o.findElement(t.element),r=e(n).data("togetherjs-player"),i=r.getCurrentTime();r.getPlayerState()!=t.playerState&&e(n).data("dontPublish",!0),1==t.playerState?(r.playVideo(),u(i,t.playerTime)&&r.seekTo(t.playerTime,!0)):2==t.playerState&&(r.pauseVideo(),u(i,t.playerTime)&&(e(r).data("seek",!0),r.seekTo(t.playerTime,!0)))}),n.hub.on("hello",function(){setTimeout(l,2e3)}),n.hub.on("synchronizeVideosOfLateGuest",function(t){var n=o.findElement(t.element),r=e(n).data("togetherjs-player"),i=e(n).data("currentVideoId");t.videoId!=i?(e(n).data("currentVideoId",t.videoId),r.loadVideoById(t.videoId,t.playerTime,"default")):5!=t.playerState&&r.seekTo(t.playerTime,!0)}),n.hub.on("differentVideoLoaded",function(t){var n=o.findElement(t.element);e(n).data("togetherjs-player").loadVideoById(t.videoId,0,"default"),e(n).data("currentVideoId",t.videoId)})}),TogetherJS.require=TogetherJS._requireObject=e,TogetherJS._loaded=!0,e(["session"])}();